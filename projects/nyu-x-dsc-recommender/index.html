<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NYU x DSC Datathon Olist Recommender System | Sunny's Digital</title><meta name=keywords content="cosine-similarity,shopping-recommender,recommender-system,joining-tables"><meta name=description content="1 | Initial Setup 1.1 | Package Installation
numpy and pandas for basic data-manipulation sklearn and associated modules to run our machine learning algorithms scipy associated modules (norm) to compute the cosime similarity later on seaborn to output graphs Miscellaneous packages for flow of the notebook 1 2 ! pip install utils ! pip install scikit-learn 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import pandas as pd import numpy as np from numpy."><meta name=author content="Sunny Son"><link rel=canonical href=https://sunnyson.dev/projects/nyu-x-dsc-recommender/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.08f38febdde379994981340a0d46cdb7267a245120dc57269145d8524031b393.css integrity="sha256-CPOP693jeZlJgTQKDUbNtyZ6JFEg3FcmkUXYUkAxs5M=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://sunnyson.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sunnyson.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sunnyson.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://sunnyson.dev/apple-touch-icon.png><link rel=mask-icon href=https://sunnyson.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=apple-touch-icon sizes=152x152 href=/path-to-your-icon/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=120x120 href=/path-to-your-icon/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=76x76 href=/path-to-your-icon/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=60x60 href=/path-to-your-icon/apple-touch-icon-60x60.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css integrity=sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js integrity=sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><style>@media screen and (min-width:769px){.post-content input[type=checkbox]:checked~label>img{transform:scale(1.6);cursor:zoom-out;position:relative;z-index:999}.post-content img.zoomCheck{transition:transform .15s ease;z-index:999;cursor:zoom-in}}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-QT6QEKVLDM"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QT6QEKVLDM",{anonymize_ip:!1})}</script><meta property="og:title" content="NYU x DSC Datathon Olist Recommender System"><meta property="og:description" content="1 | Initial Setup 1.1 | Package Installation
numpy and pandas for basic data-manipulation sklearn and associated modules to run our machine learning algorithms scipy associated modules (norm) to compute the cosime similarity later on seaborn to output graphs Miscellaneous packages for flow of the notebook 1 2 ! pip install utils ! pip install scikit-learn 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import pandas as pd import numpy as np from numpy."><meta property="og:type" content="article"><meta property="og:url" content="https://sunnyson.dev/projects/nyu-x-dsc-recommender/"><meta property="og:image" content="https://sunnyson.dev/projects/nyu-x-dsc-recommender/images/peak-presentation-overview.png"><meta property="article:section" content="projects"><meta property="article:published_time" content="2023-07-29T07:00:00-04:00"><meta property="article:modified_time" content="2023-07-29T07:00:00-04:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sunnyson.dev/projects/nyu-x-dsc-recommender/images/peak-presentation-overview.png"><meta name=twitter:title content="NYU x DSC Datathon Olist Recommender System"><meta name=twitter:description content="1 | Initial Setup 1.1 | Package Installation
numpy and pandas for basic data-manipulation sklearn and associated modules to run our machine learning algorithms scipy associated modules (norm) to compute the cosime similarity later on seaborn to output graphs Miscellaneous packages for flow of the notebook 1 2 ! pip install utils ! pip install scikit-learn 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import pandas as pd import numpy as np from numpy."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"https://sunnyson.dev/projects/"},{"@type":"ListItem","position":2,"name":"NYU x DSC Datathon Olist Recommender System","item":"https://sunnyson.dev/projects/nyu-x-dsc-recommender/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NYU x DSC Datathon Olist Recommender System","name":"NYU x DSC Datathon Olist Recommender System","description":"1 | Initial Setup 1.1 | Package Installation\nnumpy and pandas for basic data-manipulation sklearn and associated modules to run our machine learning algorithms scipy associated modules (norm) to compute the cosime similarity later on seaborn to output graphs Miscellaneous packages for flow of the notebook 1 2 ! pip install utils ! pip install scikit-learn 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import pandas as pd import numpy as np from numpy.","keywords":["cosine-similarity","shopping-recommender","recommender-system","joining-tables"],"articleBody":" 1 | Initial Setup 1.1 | Package Installation\nnumpy and pandas for basic data-manipulation sklearn and associated modules to run our machine learning algorithms scipy associated modules (norm) to compute the cosime similarity later on seaborn to output graphs Miscellaneous packages for flow of the notebook 1 2 ! pip install utils ! pip install scikit-learn 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import pandas as pd import numpy as np from numpy.linalg import norm import scipy as sc from sklearn.neighbors import KNeighborsClassifier from sklearn.impute import KNNImputer from sklearn import preprocessing from scipy.linalg import norm import seaborn as sns from typing import List from utils import * import re from collections import Counter import sys 1.2 | Connecting to Github and Google Drive\nThis notebook is connected to the associated Github repository for easy access and version contol Optionally, it is also tested and connected to Google Drive if possible 1 2 3 4 5 if 'google.colab' in sys.modules: %cd /content !rm -rf Datathon_F22 !git clone https://github.com/sunnydigital/Datathon_F22 %cd Datathon_F22 1 2 3 if 'google.colab' in sys.modules: from google.colab import drive drive.mount('/content/drive') 1.3 | Preprocessing Product Category Names\nAfter initally reading in the product_category_name_translation.csv we need to transform the data into a useable format An initial inspection of the number of products uder each category is displayed The english translations for product names are given (from the associated column in the product_category_name_translation.csv) For each category, the individual words making up the category is split using re.split 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 trans_df = pd.read_csv('datasets/product_category_name_translation.csv') og_cat_name = trans_df['product_category_name'].to_numpy() og_cat_name = np.append(og_cat_name, ['portateis_cozinha_e_preparadores_de_alimentos', 'pc_gamer', 'pcs', 'other']) og_name_to_idx = {} for i, name in enumerate(og_cat_name): og_name_to_idx[name] = i display(og_name_to_idx) product_categories = trans_df['product_category_name_english'].to_numpy() product_categories = np.append(product_categories, ['portateis_cozinha_e_preparadores_de_alimentos', 'pc_gamer', 'pcs', 'other']) display(product_categories) product_categories_list = [] for category in product_categories: product_categories_list.append(re.split('_| ', category)) product_categories_list {'beleza_saude': 0, 'informatica_acessorios': 1, 'automotivo': 2, 'cama_mesa_banho': 3, 'moveis_decoracao': 4, 'esporte_lazer': 5, 'perfumaria': 6, 'utilidades_domesticas': 7, 'telefonia': 8, 'relogios_presentes': 9, 'alimentos_bebidas': 10, 'bebes': 11, 'papelaria': 12, 'tablets_impressao_imagem': 13, 'brinquedos': 14, 'telefonia_fixa': 15, 'ferramentas_jardim': 16, 'fashion_bolsas_e_acessorios': 17, 'eletroportateis': 18, 'consoles_games': 19, 'audio': 20, 'fashion_calcados': 21, 'cool_stuff': 22, 'malas_acessorios': 23, 'climatizacao': 24, 'construcao_ferramentas_construcao': 25, 'moveis_cozinha_area_de_servico_jantar_e_jardim': 26, 'construcao_ferramentas_jardim': 27, 'fashion_roupa_masculina': 28, 'pet_shop': 29, 'moveis_escritorio': 30, 'market_place': 31, 'eletronicos': 32, 'eletrodomesticos': 33, 'artigos_de_festas': 34, 'casa_conforto': 35, 'construcao_ferramentas_ferramentas': 36, 'agro_industria_e_comercio': 37, 'moveis_colchao_e_estofado': 38, 'livros_tecnicos': 39, 'casa_construcao': 40, 'instrumentos_musicais': 41, 'moveis_sala': 42, 'construcao_ferramentas_iluminacao': 43, 'industria_comercio_e_negocios': 44, 'alimentos': 45, 'artes': 46, 'moveis_quarto': 47, 'livros_interesse_geral': 48, 'construcao_ferramentas_seguranca': 49, 'fashion_underwear_e_moda_praia': 50, 'fashion_esporte': 51, 'sinalizacao_e_seguranca': 52, 'pcs': 73, 'artigos_de_natal': 54, 'fashion_roupa_feminina': 55, 'eletrodomesticos_2': 56, 'livros_importados': 57, 'bebidas': 58, 'cine_foto': 59, 'la_cuisine': 60, 'musica': 61, 'casa_conforto_2': 62, 'portateis_casa_forno_e_cafe': 63, 'cds_dvds_musicais': 64, 'dvds_blu_ray': 65, 'flores': 66, 'artes_e_artesanato': 67, 'fraldas_higiene': 68, 'fashion_roupa_infanto_juvenil': 69, 'seguros_e_servicos': 70, 'portateis_cozinha_e_preparadores_de_alimentos': 71, 'pc_gamer': 72, 'other': 74} array(['health_beauty', 'computers_accessories', 'auto', 'bed_bath_table', 'furniture_decor', 'sports_leisure', 'perfumery', 'housewares', 'telephony', 'watches_gifts', 'food_drink', 'baby', 'stationery', 'tablets_printing_image', 'toys', 'fixed_telephony', 'garden_tools', 'fashion_bags_accessories', 'small_appliances', 'consoles_games', 'audio', 'fashion_shoes', 'cool_stuff', 'luggage_accessories', 'air_conditioning', 'construction_tools_construction', 'kitchen_dining_laundry_garden_furniture', 'costruction_tools_garden', 'fashion_male_clothing', 'pet_shop', 'office_furniture', 'market_place', 'electronics', 'home_appliances', 'party_supplies', 'home_confort', 'costruction_tools_tools', 'agro_industry_and_commerce', 'furniture_mattress_and_upholstery', 'books_technical', 'home_construction', 'musical_instruments', 'furniture_living_room', 'construction_tools_lights', 'industry_commerce_and_business', 'food', 'art', 'furniture_bedroom', 'books_general_interest', 'construction_tools_safety', 'fashion_underwear_beach', 'fashion_sport', 'signaling_and_security', 'computers', 'christmas_supplies', 'fashio_female_clothing', 'home_appliances_2', 'books_imported', 'drinks', 'cine_photo', 'la_cuisine', 'music', 'home_comfort_2', 'small_appliances_home_oven_and_coffee', 'cds_dvds_musicals', 'dvds_blu_ray', 'flowers', 'arts_and_craftmanship', 'diapers_and_hygiene', 'fashion_childrens_clothes', 'security_and_services', 'portateis_cozinha_e_preparadores_de_alimentos', 'pc_gamer', 'pcs', 'other'], dtype=object) [['health', 'beauty'], ['computers', 'accessories'], ['auto'], ['bed', 'bath', 'table'], ['furniture', 'decor'], ['sports', 'leisure'], ['perfumery'], ['housewares'], ['telephony'], ['watches', 'gifts'], ['food', 'drink'], ['baby'], ['stationery'], ['tablets', 'printing', 'image'], ['toys'], ['fixed', 'telephony'], ['garden', 'tools'], ['fashion', 'bags', 'accessories'], ['small', 'appliances'], ['consoles', 'games'], ['audio'], ['fashion', 'shoes'], ['cool', 'stuff'], ['luggage', 'accessories'], ['air', 'conditioning'], ['construction', 'tools', 'construction'], ['kitchen', 'dining', 'laundry', 'garden', 'furniture'], ['costruction', 'tools', 'garden'], ['fashion', 'male', 'clothing'], ['pet', 'shop'], ['office', 'furniture'], ['market', 'place'], ['electronics'], ['home', 'appliances'], ['party', 'supplies'], ['home', 'confort'], ['costruction', 'tools', 'tools'], ['agro', 'industry', 'and', 'commerce'], ['furniture', 'mattress', 'and', 'upholstery'], ['books', 'technical'], ['home', 'construction'], ['musical', 'instruments'], ['furniture', 'living', 'room'], ['construction', 'tools', 'lights'], ['industry', 'commerce', 'and', 'business'], ['food'], ['art'], ['furniture', 'bedroom'], ['books', 'general', 'interest'], ['construction', 'tools', 'safety'], ['fashion', 'underwear', 'beach'], ['fashion', 'sport'], ['signaling', 'and', 'security'], ['computers'], ['christmas', 'supplies'], ['fashio', 'female', 'clothing'], ['home', 'appliances', '2'], ['books', 'imported'], ['drinks'], ['cine', 'photo'], ['la', 'cuisine'], ['music'], ['home', 'comfort', '2'], ['small', 'appliances', 'home', 'oven', 'and', 'coffee'], ['cds', 'dvds', 'musicals'], ['dvds', 'blu', 'ray'], ['flowers'], ['arts', 'and', 'craftmanship'], ['diapers', 'and', 'hygiene'], ['fashion', 'childrens', 'clothes'], ['security', 'and', 'services'], ['portateis', 'cozinha', 'e', 'preparadores', 'de', 'alimentos'], ['pc', 'gamer'], ['pcs'], ['other']] 2 | GloVe Embeddings 2.1 | Indexer Object and Embedding initialization\nAn Indexer Object is created to map words to a dictionary read_wrod_embeddings is used to interface between the stored GloVe-50d embeddings in the file glove.6B.50d-relativized.txt and the dictionary protocal defined previously in the Indexer Object Finally an indexer object, word_indexer and the embedded dictionary embeddings object is returned 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 class Indexer(object): \"\"\" Bijection between objects and integers starting at 0. Useful for mapping labels, features, etc. into coordinates of a vector space. Attributes: @objs_to_ints @ints_to_objs \"\"\" def __init__(self): self.objs_to_ints = {} self.ints_to_objs = {} def __repr__(self): return str([str(self.get_object(i)) for i in range(0, len(self))]) def __str__(self): return self.__repr__() def __len__(self): return len(self.objs_to_ints) def get_object(self, index): \"\"\" @param index: integer index to look up @return: Returns the object corresponding to the particular index or None if not found \"\"\" if (index not in self.ints_to_objs): return None else: return self.ints_to_objs[index] def contains(self, object): \"\"\" @param object: object to look up @return: Returns True if it is in the Indexer, False otherwise \"\"\" return self.index_of(object) != -1 def index_of(self, object): \"\"\" @param object: object to look up @return: Returns -1 if the object isn't present, index otherwise \"\"\" if (object not in self.objs_to_ints): return -1 else: return self.objs_to_ints[object] def add_and_get_index(self, object, add=True): \"\"\" Adds the object to the index if it isn't present, always returns a nonnegative index @param object: object to look up or add @param add: True by default, False if we shouldn't add the object. If False, equivalent to index_of. @return: The index of the object \"\"\" if not add: return self.index_of(object) if (object not in self.objs_to_ints): new_idx = len(self.objs_to_ints) self.objs_to_ints[object] = new_idx self.ints_to_objs[new_idx] = object return self.objs_to_ints[object] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 def read_word_embeddings(embeddings_file: str): \"\"\" Loads the given embeddings (ASCII-formatted) into a WordEmbeddings object. Augments this with an UNK embedding that is the 0 vector. Reads in all embeddings with no filtering -- you should only use this for relativized word embedding files. @param embeddings_file: path to the file containing embeddings @return: WordEmbeddings object reflecting the words and their embeddings \"\"\" f = open(embeddings_file) word_indexer = Indexer() vectors = [] # Make position 0 a PAD token, which can be useful if you word_indexer.add_and_get_index(\"PAD\") # Make position 1 the UNK token word_indexer.add_and_get_index(\"UNK\") for line in f: if line.strip() != \"\": space_idx = line.find(' ') word = line[:space_idx] numbers = line[space_idx+1:] float_numbers = [float(number_str) for number_str in numbers.split()] vector = np.array(float_numbers) word_indexer.add_and_get_index(word) # Append the PAD and UNK vectors to start. Have to do this weirdly because we need to read the first line # of the file to see what the embedding dim is if len(vectors) == 0: vectors.append(np.zeros(vector.shape[0])) vectors.append(np.zeros(vector.shape[0])) vectors.append(vector) f.close() print(\"Read in \" + repr(len(word_indexer)) + \" vectors of size \" + repr(vectors[0].shape[0])) # Turn vectors into a 2-D numpy array return word_indexer, np.array(vectors) 1 word_indexer, embeddings = read_word_embeddings('glove/glove.6B.50d-relativized.txt') Read in 14923 vectors of size 50 2.2 | Embedding Concatenation\nget_embedding is a functon defined to obtain the embedding for any product category, meant to deal with multiple words describing any category Two ways of dealing with multi-word properties of product categories are included: mean where the mean of embedding values for each word in the the GloVe-50d dictionary is found, for each word across all 50 dimensions sum where the sum of embedding values for each word in the GloVe-50d dictionary is found, for each word, summed across all 50 dimensions The embedding for each product category is returned based on the previously determined methodology for word handling 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 def get_embedding(word_indexer, embeddings, product_categories, reduce='mean'): \"\"\" @param word_indexer returns the index of the word in the embedding @param embeddings the embeddings matrix of all words in GloVe-50d @param product_categories the categories of all products represented in a [N x 1] array \"\"\" category_embeddings = {} for category, category_list in zip(product_categories, product_categories_list): category_embed = [] for word in category_list: index_word = word_indexer.index_of(word) embed = embeddings[index_word] category_embed.append(embed) if reduce == 'mean': embed = np.mean(category_embed, axis=0) if reduce == 'sum': embed = np.sum(category_embed, axis=0) category_embeddings[category] = embed return category_embeddings 1 2 embeddings = get_embedding(word_indexer, embeddings, product_categories) embeddings {'perfumery': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'artes': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'sport_leisure': array([-6.5777500e-01, 2.3660000e-01, -5.2690000e-01, -1.0300000e-03, -3.7766500e-01, -2.4336400e-01, 1.1789000e-01, -2.6644000e-01, 1.3412000e-02, 2.1341800e-01, 5.8577000e-01, 6.4220000e-02, -8.8555000e-02, 1.7286500e-01, 2.5672500e-01, -3.4311500e-01, 2.7832000e-01, 1.2754050e+00, 1.1235000e-02, -8.0732000e-01, -6.4122500e-01, 1.1676450e-01, -2.9102100e-01, 4.8428000e-01, 1.5141000e-01, -1.3723500e-01, -6.3680000e-01, 3.7784500e-01, 1.5137115e-01, 3.4792000e-01, 5.6390000e-01, 6.3726550e-01, -2.4579550e-01, -9.4106500e-02, -2.6462000e-01, 4.5140000e-01, -4.5003500e-02, 1.4046500e-01, -5.2468500e-01, -2.7534950e-01, 1.5362100e-01, -5.9103000e-01, 6.8940000e-02, 4.5214500e-01, 2.8340550e-01, -3.7257450e-01, -1.5898500e-01, 2.5181000e-01, 5.0931500e-01, -1.2091640e-01]), 'babies': array([ 0.69898 , -0.056312, 0.34178 , -1.4674 , 0.54603 , 1.7752 , -0.57618 , -0.60623 , 0.83499 , 0.42334 , 0.50787 , -0.57778 , 1.0339 , 0.27791 , 1.4515 , 0.58806 , -0.96275 , 0.33018 , 0.45507 , -0.24377 , -0.15741 , 0.95016 , 0.71083 , 0.23539 , 0.66137 , -0.61362 , -0.50664 , -0.24646 , 0.32122 , -0.50601 , 1.5551 , 1.1833 , -0.19435 , 0.40841 , 0.50837 , 0.11851 , 0.82978 , -0.22482 , 0.84309 , -0.27989 , -1.2027 , -0.50551 , 0.49102 , 0.5024 , 1.5571 , -0.025314, -0.032675, -0.68783 , -0.072284, -0.22732 ]), 'domestic_utilities': array([-0.2169885 , -0.259665 , -0.089036 , -0.232085 , 0.02123 , 0.02266 , 0.303745 , -0.30865 , 0.304807 , 0.24873115, 0.27609 , 0.182715 , 0.44881 , 0.297305 , 0.20334 , -0.2240425 , 0.0246 , 0.3544 , 0.21105 , -0.38053 , 0.289055 , -0.3395355 , -0.114346 , -0.12142 , -0.0075 , -0.118635 , 0.00909 , 0.02115 , 0.324625 , 0.756815 , 1.0631 , 0.6046155 , 0.4585545 , -0.0684765 , -0.31949 , 0.4114665 , -0.3848335 , -0.1004675 , -0.565625 , -0.2515545 , -0.339595 , -0.245639 , 0.28604 , 0.173715 , 0.44828 , -0.3250159 , -0.2789 , 0.435085 , 0.45348 , 0.0225586 ]), 'musical instruments': array([-0.06468 , 0.322055 , -0.963365 , -0.114635 , -0.177675 , 0.54965 , -0.1838395 , -0.4549 , -0.64644 , 1.3871 , 0.57586 , 0.94313 , 0.151145 , 1.07977 , -0.49424 , -0.380291 , -0.17956 , 0.1215325 , -0.297625 , -0.85511 , 0.865405 , 0.562785 , -0.186045 , -0.499275 , 0.152454 , -0.0582182 , -1.35372 , -0.50429 , -0.154655 , -0.653355 , 2.9801 , -0.507645 , 0.638315 , -0.33097815, 0.5617 , 0.35252 , 0.186936 , 0.0288775 , -0.228075 , 0.122783 , 0.05871 , 0.03846 , 0.147365 , -0.122755 , -0.14569 , 0.339465 , 0.54428 , -0.093315 , -1.1327 , 0.159625 ]), 'cool_stuff': array([-4.932950e-01, 2.035540e-01, -8.313395e-02, -4.249600e-01, 9.794000e-02, -4.397210e-01, -3.272700e-01, -2.336160e-01, -3.763900e-01, 6.511450e-01, -5.402300e-01, 3.683300e-01, -1.061500e-02, 6.245650e-01, 5.724015e-01, 5.704455e-01, 3.654400e-01, 4.361400e-01, -1.085555e-01, -1.033350e+00, -5.114250e-02, 5.775950e-01, 8.279250e-01, 3.179500e-01, 4.330600e-01, -8.627450e-01, -8.960600e-01, 1.115915e+00, 1.720000e+00, -2.354450e-01, 2.476200e+00, 2.326425e-01, -7.899500e-03, 1.246350e-01, -1.432040e-01, 5.095900e-01, -3.377350e-01, 3.771100e-01, 3.613050e-01, -7.046750e-01, 1.961800e-01, 3.419200e-01, -9.439450e-02, 3.296600e-01, 4.638600e-01, 4.373350e-01, 4.684150e-01, -4.642925e-01, 2.028000e-03, 6.441700e-01]), 'furniture_decoration': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'home appliances': array([-0.11147 , 0.160835 , 0.01424 , -0.297908 , 0.231035 , -0.46969 , -0.473055 , 0.333195 , -0.0387957 , 0.258926 , -0.216425 , -0.15653 , 0.26442 , 0.047085 , 0.04186 , -0.221237 , 0.024125 , 0.23801655, 0.0201 , 0.02417 , -0.166215 , 0.2318245 , -0.276051 , 0.153675 , 0.016345 , -0.324785 , -0.048915 , 0.14006 , 0.401985 , -0.12704 , 1.02255 , 0.4103305 , 0.1114745 , 0.024657 , 0.09831 , 0.6256 , 0.1077315 , 0.135195 , 0.085595 , -0.2381195 , 0.013745 , -0.16949 , -0.228925 , 0.31469 , 0.319578 , -0.04022 , -0.16518 , -0.316485 , 0.24828 , -0.0955514 ]), 'toys': array([ 0.11738 , -0.78864 , 0.20307 , 0.40609 , 0.53572 , 0.66853 , -1.0303 , -2.0666 , 0.67746 , 0.41301 , -0.036541, 0.57572 , 0.2052 , -0.13067 , 1.1972 , 0.69488 , -0.7459 , 1.0515 , 0.22374 , -1.0436 , 1.1563 , 0.12272 , -0.091888, -0.070431, -0.35183 , -0.37046 , -1.4255 , -0.078561, 0.716 , -1.3362 , 1.3186 , 0.995 , 0.52411 , 0.38252 , 0.73561 , 1.1922 , 0.30399 , -0.19526 , -0.036646, -0.48951 , -0.36473 , 0.2109 , 0.16709 , 0.18673 , 1.3641 , 1.1111 , -0.17835 , -0.31437 , 0.12497 , -0.14976 ]), 'bed table bath': array([ 0.121282 , 1.07551 , -0.50220667, -0.33427333, 0.37935 , -0.153277 , -0.141247 , 0.02063833, -0.05749 , -0.60773667, -0.4423 , 0.2403 , -0.190591 , 0.27271 , 0.21277667, 0.86095667, 0.09901333, 0.06610467, -0.13987933, -0.73049667, 0.68601 , 0.55938333, 0.48579333, 0.25348 , -0.37527667, -0.423359 , -0.130161 , 0.77310667, 0.42638333, 0.09753433, 2.26126667, 0.27597467, -0.23237503, 0.67459667, 0.37090333, 0.82384333, 0.57042 , 0.48660667, 0.932469 , -0.33592333, 0.46510333, -0.20701167, -0.30365333, 0.71547 , 0.31835667, 0.42810333, 0.18425667, -1.03925233, 0.38622333, -0.54126 ]), 'construction_tools_security': array([ 0.50816667, -0.15552927, 0.61994 , 0.21229467, -0.02190367, -0.32106667, -0.30894 , -0.80907333, 0.16325333, -0.592376 , -0.16282 , -0.10930333, -0.347921 , -0.05749967, -0.32407333, 0.31827333, 0.13833333, 0.25797333, 0.58916667, -0.494492 , 0.94635 , -0.05304667, -0.88858 , -0.78261 , -0.048928 , -1.00035333, 0.02441667, -0.399411 , 0.35588333, 0.09051667, 3.3164 , -0.50588333, -0.39591667, -0.65001233, 0.01619 , 0.8768 , 0.254316 , 0.20291667, -0.09791267, 0.423946 , -0.13481333, -0.37350333, 0.4858 , 0.20931667, 0.53948267, -0.29450233, -0.04733667, 0.60774667, 0.18903 , -0.15894333]), 'informatica_accessories': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'beauty_health': array([ 0.149462 , 0.837515 , -0.658989 , 0.11762 , 0.156495 , 0.311425 , -0.2985085, -0.72018 , 1.114425 , 0.224965 , 0.18148 , -0.1437515, 0.36231 , -0.316605 , 0.29906 , 0.187535 , -0.318833 , 0.19092 , 0.534318 , -0.15734 , -0.095259 , 1.056855 , -0.295065 , -0.079285 , 0.14422 , -1.22806 , -1.06188 , -0.15872 , -0.05257 , 0.38244 , 2.6115 , 0.681295 , -0.01553 , -0.803845 , -0.079915 , 0.240563 , -0.286601 , 0.450905 , 0.700525 , -0.472489 , -0.326875 , 0.212085 , 0.4923 , 0.25222 , 0.270245 , 0.37235 , -0.448995 , -0.188735 , 0.56276 , 0.34234 ]), 'bags_accessories': array([-0.09753 , -0.21828 , 0.39673 , -0.541435 , 0.28565 , -0.250009 , 0.16389 , -0.432615 , 0.587842 , -0.11338 , 0.13238 , 0.034195 , 0.52179 , 0.371215 , 0.406465 , 0.015975 , -0.30545 , 0.43989 , 0.361695 , -1.02972 , 0.11384 , -0.02404 , 0.438889 , -0.109875 , -0.292865 , 0.148435 , -0.41799 , 0.785775 , 0.695215 , -0.208865 , 0.1957 , 0.6654155, -0.2863305, 0.4026785, 0.102555 , 1.22624 , 0.2838865, 0.30733 , 0.079865 , 0.0776355, 0.35376 , 0.099455 , 0.17175 , 0.439675 , 0.51477 , -0.338477 , -0.051525 , -0.07325 , 0.385935 , -0.5949414]), 'garden_tools': array([-0.13122 , -0.45077 , 0.20832 , -0.15525 , -0.0177905, -0.273765 , 0.207975 , -0.589265 , 0.100587 , 0.265581 , 0.0123335, 0.303705 , 0.4274135, 0.2284005, -0.441685 , -0.167755 , 0.30533 , 0.4014 , 0.67399 , -0.67052 , 0.135475 , -0.0920255, -0.201911 , -0.296385 , 0.375905 , 0.38115 , -0.546515 , -0.447175 , 0.41337 , -0.095075 , 0.8753 , -0.3589695, -0.2505255, -0.3293365, -0.10512 , 1.16314 , -0.0027195, 0.341125 , -0.140954 , -0.0208605, 0.459025 , -0.554825 , -0.05076 , 0.85532 , 1.007625 , -0.3457835, 0.583475 , 0.42408 , 0.202085 , -0.1239964]), 'furniture_office': array([-0.100575 , -0.0411355 , 0.043105 , -0.209865 , 0.18825 , -0.59084 , 0.02806 , -0.02936 , -0.0272195 , -0.39515 , -0.306055 , -0.054165 , 0.205645 , 0.2346751 , 0.092645 , -0.11909 , -0.277255 , 0.274721 , 0.58935 , -0.1465255 , 0.294605 , 0.0838895 , -0.231836 , -0.210795 , -0.24414 , -0.562935 , -0.1818305 , 0.36765 , -0.19358 , 0.27433 , 0.8427 , -0.0921145 , -0.2660805 , -0.5448265 , -0.340315 , 0.51402 , 0.2321565 , 0.036925 , 0.131865 , -0.1284995 , -0.039955 , 0.025175 , -0.247405 , 0.25581025, -0.044475 , -0.40652 , -0.442715 , 0.0650475 , 0.508945 , 0.2105486 ]), 'automotive': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'electronic': array([-6.6594e-01, -6.5510e-01, 9.2148e-01, 6.8301e-01, -4.7822e-01, -2.8030e-01, -5.3848e-01, -1.0404e+00, 8.6666e-01, 9.4106e-01, 6.8266e-01, 1.6785e-01, 2.7838e-01, 1.1826e+00, -4.1586e-01, -5.3318e-02, -1.2734e+00, -2.2728e-01, 8.7516e-02, -9.1505e-01, 1.7087e+00, -1.1551e-01, -7.6449e-01, 2.7068e-02, -2.9328e-02, -7.2308e-01, -7.4972e-01, -7.2909e-01, 4.0463e-01, -5.0634e-01, 2.9845e+00, -5.8706e-01, 3.0288e-01, -5.0952e-01, -3.2629e-01, 4.3184e-01, 2.9218e-01, -2.9649e-01, -1.7555e-03, 1.2518e-01, 1.0972e+00, 1.6128e-01, 2.2262e-01, 6.7454e-01, 1.5689e-01, 2.6961e-01, 7.8616e-01, 3.6450e-01, -4.2447e-01, -5.8735e-02]), 'fashion_shoes': array([-0.529271 , 0.187405 , -0.706595 , -0.150854 , 0.257785 , -0.062465 , -0.64265 , -1.31045 , 0.1302085 , 0.121555 , 0.15193675, -0.2591685 , -0.87015 , 0.13515 , 0.622815 , 0.30194 , -0.52321 , 0.184355 , 0.289615 , -1.27407 , 0.267221 , 0.79496 , -0.58884 , 0.123875 , -0.49169 , -0.965705 , -1.28342 , 0.82245 , 0.54177 , -0.765955 , 1.8377 , 0.77242 , 0.12483 , 0.23106 , -0.020515 , 0.487787 , -0.031645 , 0.97589 , -0.577765 , -0.24196 , 0.33837 , 0.358545 , 0.41685 , 0.10506 , 0.753915 , -0.498315 , 0.04316 , -0.85085 , 0.0436 , 0.16844 ]), 'telephony': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'stationary store': array([ 0.431825 , -0.159595 , 0.7213 , 0.0359543, 0.5905305, -0.276996 , -0.849492 , -0.3911 , 0.629875 , -0.1776875, 0.5078325, -0.59475 , -0.20207 , 0.137035 , 0.00635 , 0.40943 , -0.61595 , 0.677255 , -0.25467 , -1.192875 , 0.8558665, -0.411145 , -0.565025 , 0.826405 , -0.09058 , -0.349225 , -0.38166 , 0.59205 , 1.1161 , -0.07926 , 1.7939 , -0.210345 , 0.169255 , -0.096005 , 0.29153 , 0.1508485, 0.194135 , 0.55134 , 0.201635 , 0.543336 , 0.490335 , -0.2112085, -0.356055 , 0.361025 , -0.00265 , -0.22146 , 0.32249 , -0.780135 , 0.39682 , -0.009155 ]), 'fashion_bolsas_e_acessorios': array([-0.3612355 , -0.0531225 , -0.496455 , -0.4822595 , -0.00221 , -0.3775225 , 0.4505125 , -0.1233975 , -0.08142025, 0.5212425 , 0.06148088, 0.0285875 , 0.3185425 , 0.4761475 , -0.11933 , -0.41105 , 0.146635 , 0.276585 , 0.4649475 , -0.38809 , -0.2147625 , 0.12867925, -0.1729265 , 0.103575 , 0.078905 , 0.530345 , -0.7632925 , 0.3161625 , 0.29196 , 0.237145 , -0.360725 , 0.17938325, 0.11933925, -0.11785975, -0.3642725 , 0.566631 , -0.04145275, 0.16126 , -0.4949825 , -0.13645425, 0.2658775 , -0.3131925 , -0.1265925 , 0.33689 , 0.6194475 , -0.5635775 , 0.15796 , -0.0090975 , 0.30098 , 0.2050404 ]), 'pcs': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'house_construction': array([ 0.70555 , 0.293185 , 0.179376 , -0.08316 , 0.05319 , 0.189115 , -0.89585 , -0.2394795 , -0.44347 , -0.729345 , -0.9164635 , -0.29398 , -0.1271705 , -0.20140725, -0.0930295 , 0.31127 , 0.028011 , 0.237485 , 0.254165 , -0.539355 , 1.42785 , -0.197095 , -1.077485 , -0.758905 , -0.204447 , -1.257615 , -0.097675 , 0.124841 , -0.017775 , 0.153878 , 3.13085 , -0.98483 , -0.22145 , -0.2723735 , 0.171395 , 0.0940355 , 0.41796 , 0.220105 , 0.33042 , 0.07027 , -0.579885 , -0.345695 , -0.00575 , -0.055565 , 0.007649 , 0.01957 , -0.75081 , -0.545575 , 0.154991 , -0.043825 ]), 'watches_gifts': array([ 0.13938 , 0.490805 , -0.10947 , 0.016295 , 0.826165 , -0.07303 , -0.56479 , -0.260535 , 0.559345 , 0.360701 , -0.179925 , 0.609995 , 0.801685 , -0.12088 , 1.1018 , 0.113595 , -0.871335 , 0.008045 , 0.19502 , -0.88376 , 0.995565 , 0.2234605, -0.1203995, -0.45073 , 0.03505 , -0.87461 , -0.81466 , -0.01929 , 0.48275 , -0.923825 , 1.1388 , 1.145715 , 0.375925 , 0.1000245, 0.015275 , 0.761995 , -0.1934265, 0.38571 , -0.425525 , -0.185705 , 0.298155 , 0.665945 , 0.1537 , 0.508755 , 0.110155 , -0.35469 , -0.365415 , -0.245515 , -0.395905 , -0.26568 ]), 'construction_tools_construction': array([ 6.04326667e-01, -5.40133333e-02, 4.78586667e-01, 2.83800000e-01, -4.04690333e-01, 3.73033333e-02, -6.85740000e-01, -8.43093333e-01, -1.14010000e-01, -1.70072667e-01, -7.47566667e-03, -1.00790000e-01, -1.81647667e-01, -2.78849667e-01, -3.55140000e-01, 2.03773333e-01, 1.87083333e-01, 5.66763333e-01, 3.55830000e-01, -6.04233333e-01, 1.33764667e+00, -5.36506667e-01, -1.31845000e+00, -1.02777667e+00, 1.58164000e-01, -5.60030000e-01, -8.85000000e-02, -4.28098667e-01, 4.28930000e-01, 8.98000000e-03, 3.32730000e+00, -9.14663333e-01, -2.63333333e-04, -2.79684667e-01, 9.72200000e-02, 7.08906667e-01, 3.31869333e-01, 6.13723333e-01, 2.10327333e-01, 5.75602667e-01, -2.77223333e-01, -8.02490000e-01, 3.61586667e-01, 2.26533333e-01, 4.81825333e-01, -3.60482333e-01, -7.28600000e-02, 1.81796667e-01, 2.17276667e-01, -2.75956667e-01]), 'pet_shop': array([ 0.383305 , -0.22558 , -0.1947675 , -0.02225955, 0.552615 , 0.13605 , -1.42445 , -0.9175 , 0.82867 , 0.1530525 , -0.018925 , 0.265945 , 0.60104 , 0.45376 , 0.504435 , 0.33318 , -0.437065 , 0.640445 , 0.09386 , -0.64959 , 0.901288 , 0.2274495 , -0.5736005 , 0.627565 , -0.20507 , -1.05225 , -0.846905 , 0.1250828 , 0.569395 , -0.734295 , 1.6631 , 0.17512 , -0.3570085 , 0.62313 , 0.11078 , 0.520045 , 0.22995 , 0.216055 , 0.75598 , -0.06704 , 0.154995 , 0.1381225 , -0.166715 , 0.671815 , 1.207155 , 0.16389 , -0.39704 , -0.644335 , 0.89743 , 0.186325 ]), 'small appliances': array([ 3.4297000e-01, 3.9515000e-02, -8.8830000e-02, -4.2744500e-01, 3.0806500e-01, 6.3250000e-02, -6.7200000e-03, -1.9590000e-02, -5.8000000e-05, -2.2235000e-02, -4.0970000e-02, -8.0975000e-02, 8.6283000e-01, 3.9184500e-01, -4.4992500e-01, -2.5332900e-01, 4.1254000e-01, 5.3558000e-01, 4.9550000e-03, -6.7982000e-01, -1.7003000e-01, -3.7142050e-01, -4.6756000e-02, 1.7112500e-01, -8.8070000e-02, -7.2185000e-02, -4.1208000e-01, 4.2770500e-01, 3.4677500e-01, 4.9295000e-02, 1.3307000e+00, -1.2948950e-01, 2.0801950e-01, 4.3545000e-02, -9.2545000e-02, 6.1857500e-01, -1.7431850e-01, 8.0300000e-03, -1.1555500e-01, -6.6786000e-02, 1.0083015e-01, -1.8001000e-01, -1.2839150e-01, 4.0629500e-01, 5.5394500e-01, -3.2650805e-01, -1.0066500e-01, -2.3265000e-01, 1.1707450e-01, -2.2713140e-01]), 'agro_industry_and_trade': array([-3.6232000e-01, -1.6120825e-01, -3.0137925e-01, 2.7522175e-01, 3.0500000e-04, -1.9281200e-02, -4.3572750e-01, -5.8117250e-01, 1.4762350e-01, 1.8315050e-01, 2.2254500e-01, 3.1581500e-01, -2.4672750e-02, 2.6693750e-01, 1.0409750e-01, -8.1837500e-03, 2.3921475e-01, 2.3425000e-02, 3.2642500e-01, -4.5122400e-01, 6.0444750e-01, -1.7562525e-01, -1.8230300e-01, -3.1608150e-01, -1.7505000e-02, -7.9666750e-01, -2.9927500e-02, -6.0552500e-02, 2.2260000e-01, 1.8546000e-01, 2.4350500e+00, 1.0978275e-01, 2.2210275e-01, -6.2197750e-02, -4.0215250e-01, -5.1220000e-02, -5.3526675e-01, 1.9079650e-01, -7.6040000e-02, 2.1851750e-01, -4.5848575e-01, -3.6085000e-02, 3.8913000e-01, -5.1767000e-02, 4.7119500e-01, -4.3097500e-02, -4.2938000e-01, 2.7493000e-01, 1.1408500e-01, -5.4280700e-02]), 'in': array([ 0.33042 , 0.24995 , -0.60874 , 0.10923 , 0.036372 , 0.151 , -0.55083 , -0.074239 , -0.092307 , -0.32821 , 0.09598 , -0.82269 , -0.36717 , -0.67009 , 0.42909 , 0.016496 , -0.23573 , 0.12864 , -1.0953 , 0.43334 , 0.57067 , -0.1036 , 0.20422 , 0.078308 , -0.42795 , -1.7984 , -0.27865 , 0.11954 , -0.12689 , 0.031744 , 3.8631 , -0.17786 , -0.082434 , -0.62698 , 0.26497 , -0.057185 , -0.073521 , 0.46103 , 0.30862 , 0.12498 , -0.48609 , -0.0080272, 0.031184 , -0.36576 , -0.42699 , 0.42164 , -0.11666 , -0.50703 , -0.027273 , -0.53285 ]), 'living room furniture': array([ 1.67513333e-01, 4.02106667e-01, -7.22100000e-02, -7.26840000e-01, 7.17410000e-01, -2.41123333e-01, -2.67453333e-01, -2.62083333e-01, -1.82842000e-01, 8.89833333e-02, -1.13746667e-01, -2.46113333e-01, 6.51142667e-01, 3.34633333e-01, 4.22633333e-01, 1.46620000e-01, 1.24803333e-01, 3.68426667e-01, 2.28036667e-01, -2.87353333e-01, 3.40700000e-02, 7.51323000e-01, -1.59634000e-01, 8.91543333e-02, 2.33490000e-01, -2.35480000e-01, -3.49280000e-01, 2.41256667e-01, 4.24886667e-01, 3.46933333e-02, 1.59026667e+00, 2.18807000e-01, -4.28693333e-02, -3.34637667e-01, -3.76666667e-04, 6.62646667e-01, 2.05654333e-01, 3.62533333e-02, 3.48250000e-01, -2.08463000e-01, -1.81054000e-01, -8.17216667e-02, 1.29733333e-01, 6.26040000e-01, 1.02564667e-01, -1.90523333e-01, -1.45210000e-01, -6.81410000e-01, 9.24056667e-02, -1.19250933e-01]), 'signaling_and_security': array([ 1.11156667e-01, 9.64066667e-04, 9.95133333e-02, -1.89446333e-01, 1.71883333e-01, -2.29106667e-01, 2.11993333e-01, -2.31163333e-01, 3.70213333e-02, -3.91980000e-01, -3.18066667e-02, 5.87833333e-02, -1.59613333e-01, 1.03470000e-01, -1.95366667e-01, 2.85850000e-02, 1.07656333e-01, 1.13783333e-01, 3.79966667e-01, -2.66565333e-01, 1.08866667e-01, 3.58706333e-01, 3.67493333e-02, -2.50102000e-01, -1.60673333e-01, -8.17556667e-01, 2.05733333e-02, 3.56850000e-02, 1.54873000e-01, 1.41806667e-01, 2.04663333e+00, 2.11610333e-01, -2.49500333e-01, -5.60964333e-01, -7.81233333e-02, 6.12480000e-01, 1.91433333e-03, -1.82360000e-01, -3.06660000e-01, 2.23910333e-01, -6.81943333e-02, 6.15733333e-02, 2.96260000e-01, -1.25100000e-02, 3.70623333e-01, -2.83243333e-01, -2.56300000e-01, 2.52823333e-01, 7.58333333e-02, -1.04514267e-01]), 'air conditioning': array([ 0.08439 , 0.046005 , 0.26098 , -0.27408 , -0.793375 , -0.803605 , -0.1245665, 0.010855 , 0.4847655, -0.353585 , 0.91126 , 0.1183835, -0.063325 , 0.872935 , -0.636735 , 0.54369 , -0.73477 , 0.976155 , -0.937524 , -1.147215 , 0.059735 , 0.38916 , -0.273395 , -0.6447 , -0.405955 , -1.05922 , -0.005155 , 0.604635 , 1.055195 , 0.8969 , 2.568 , 0.68065 , -0.350425 , -0.405875 , 0.188045 , 0.6840155, 0.685145 , 0.197325 , 0.460865 , 0.616075 , 0.3456 , 0.371473 , 0.03534 , 0.30622 , -0.018955 , 0.251155 , 0.197905 , 0.02026 , -0.889225 , 0.85391 ]), 'consoles_games': array([-0.670455 , 0.318735 , -0.084189 , 0.50554 , -0.189155 , -0.334235 , -0.06092 , -0.120755 , -0.273838 , 0.441805 , 0.054707 , 0.018565 , -0.313205 , 0.294875 , 0.529165 , -0.654975 , 0.08529 , 0.45546 , -0.714095 , -0.091431 , -0.54849 , -0.1767905 , 0.284039 , 0.01622 , 0.148317 , 0.132665 , -0.079865 , -0.1243 , 0.354785 , -0.435235 , 1.04355 , 0.8325155 , 0.0698745 , -0.1962215 , -0.136555 , 0.71047 , 0.4870315 , 0.3173 , -0.665315 , -0.1829195 , -0.135135 , -0.66811 , -0.17432 , 0.580815 , 0.115815 , 0.16498 , 0.0049695 , 0.1625 , 0.14231545, -0.0138379 ]), 'general_interest_books': array([-0.13378667, 0.40633 , -0.180478 , -0.32258 , 0.57698667, -0.15125333, -0.81235333, -0.78724667, -0.17347333, -0.18801 , -0.10828667, 0.84404333, -0.32388033, -0.50571 , 0.66861067, -0.10638333, -0.25498667, -0.40634 , 0.00961433, -0.27365133, 0.75540633, -0.20779667, 0.14485397, -0.28896333, -0.15458667, -1.32330667, -0.607391 , -0.59106667, -0.26451667, 0.41909667, 2.96093333, -0.07119 , 0.06087667, -0.59353333, -0.0925 , -0.23531667, -0.59946833, 0.08378333, 0.00778733, -0.10507333, 0.04876 , 0.14108 , 0.00764667, 0.14884 , -0.19461133, 0.05654733, -0.11801333, 0.47503367, -0.10037333, 0.214126 ]), 'construction_tools_tools': array([ 0.39892333, -0.40918667, 0.56638333, 0.30366 , -0.16770067, -0.04139333, -0.55339 , -1.12864667, 0.08304 , -0.06945533, -0.03272433, 0.13751 , -0.05340533, -0.14626933, -0.45627 , 0.19054667, 0.24414667, 0.44537667, 0.575 , -0.84766667, 1.04299333, -0.32336333, -0.8973 , -0.75705333, 0.328612 , -0.38793 , -0.39672 , -0.81054933, 0.48087 , -0.2697 , 3.1354 , -0.85226667, -0.26795667, -0.48275233, 0.1343 , 1.15210333, 0.13191867, 0.72079667, 0.15491467, 0.30319533, 0.21638333, -0.68201 , 0.23959333, 0.71031667, 0.92521267, -0.19621467, 0.49402 , 0.42694333, 0.16449333, -0.26408333]), 'fashion_underwear_e_moda_praia': array([-0.4035864 , -0.074576 , -0.418086 , -0.3687174 , 0.05163 , -0.194718 , 0.3565326 , -0.331838 , 0.0718638 , 0.35747 , 0.1141707 , -0.073368 , 0.101738 , 0.3884804 , 0.048456 , -0.15035 , -0.142352 , 0.329326 , 0.495374 , -0.508146 , -0.11091 , 0.2938714 , -0.0429112 , 0.08110864, -0.133962 , 0.190236 , -0.884034 , 0.48503 , 0.476228 , 0.004268 , -0.240858 , 0.2754786 , -0.0439746 , -0.0122178 , -0.208024 , 0.6074088 , -0.04877 , 0.298082 , -0.523692 , -0.1423354 , 0.27784 , -0.189706 , -0.001552 , 0.313756 , 0.645318 , -0.640938 , 0.166912 , -0.243998 , 0.271598 , 0.07568232]), 'fashion_clothes_men': array([-0.20766067, 0.18115 , -0.58055 , -0.36946267, 0.71611 , -0.06227667, -0.480974 , -0.56409 , -0.18878433, -0.17501 , 0.1055745 , -0.55299 , -0.601128 , -0.04001 , 0.75262667, 0.03583333, -0.38519333, 0.06401 , 0.00884333, -1.02360333, 0.10532333, 1.05513667, -0.07654333, 0.40878733, -0.4867 , -1.12438667, -1.28289333, 0.28985667, 0.52306667, -0.48607333, 2.29503333, 0.7971 , -0.01128033, -0.1677 , 0.21522667, 0.67615133, -0.14004467, 0.78054667, -0.49585867, -0.15393933, 0.16505333, 0.25155667, 0.61591 , 0.17914333, 0.84348333, -0.51744 , -0.09429 , -0.87343 , 0.09008 , -0.10341667]), 'furniture_cozinha_area_de_servico_jantar_e_jardim': array([-0.12591 , 0.05804125, -0.3714275 , -0.45058238, -0.17667313, -0.6250375 , 0.4318925 , 0.2268 , -0.097417 , 0.32719125, 0.15450375, 0.0841875 , 0.55648 , 0.065975 , -0.3158175 , -0.53394125, 0.372565 , 0.294245 , 0.2417575 , -0.24151 , -0.4950775 , -0.04474862, 0.01052183, 0.04897125, 0.0280925 , 0.58375375, -0.39934212, 0.327625 , 0.249945 , 0.282065 , -0.1091875 , -0.13682175, -0.11248325, -0.11242225, -0.23426225, 0.45630125, 0.04041513, -0.06066375, -0.14173625, 0.15078825, 0.22956875, -0.37743613, 0.01378625, 0.17155463, 0.274235 , -0.62712375, -0.06439375, -0.1451625 , 0.444225 , 0.0523804 ]), 'industry_comercio_e_nocios': array([-0.4742575 , -0.2723675 , -0.17437425, -0.232995 , -0.17193 , -0.3223387 , 0.3587175 , -0.0484675 , 0.1350155 , 0.4752125 , 0.1572025 , 0.245885 , 0.56979725, 0.47852 , -0.156155 , -0.3005925 , 0.3090825 , 0.508665 , 0.55089 , -0.430885 , 0.0197325 , -0.15864075, -0.1362815 , -0.1735025 , 0.1958575 , 0.3657475 , -0.5008075 , 0.1346775 , 0.21376025, 0.449445 , -0.014425 , 0.00752575, 0.19361925, 0.00729575, -0.4523525 , 0.47392 , -0.19727275, 0.0138125 , -0.153285 , -0.0763395 , -0.05682 , -0.3689725 , -0.0889 , 0.383123 , 0.659645 , -0.4358525 , -0.1451525 , 0.265465 , 0.2715725 , 0.0709879 ]), 'fixed_telephony': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'construction_tools_lighting': array([ 0.30365733, 0.00852667, 0.36363 , 0.37041 , -0.29092033, -0.04499667, -0.4140118 , -0.97149 , -0.06964 , 0.04465067, 0.05495333, 0.05082 , -0.008051 , 0.047657 , -0.418 , 0.39159333, 0.00890667, 0.47169667, 0.20268333, -1.24886667, 1.15448 , -0.11887333, -1.19068333, -0.97411 , 0.31914867, -0.21629 , -0.15260933, -0.24001267, 0.53057333, -0.04279667, 2.76066667, -0.49853 , -0.02294667, -0.74371233, 0.14017333, 0.99637 , 0.548296 , 0.54722667, 0.100202 , 0.48748933, 0.07836 , -0.18947333, 0.11410333, 0.17226 , 0.608706 , 0.02270767, 0.18668 , -0.13145333, 0.158199 , -0.04822 ]), 'technical books': array([-2.20985000e-01, 4.93455000e-01, -3.43250000e-01, -1.47600000e-01, -7.72650000e-02, -9.70300000e-02, -8.05691500e-01, -1.00974850e+00, 3.13295000e-01, -1.28325000e-01, -2.65610000e-01, 6.45660000e-01, -4.74145000e-01, -3.70350000e-01, 5.73275000e-01, -5.05310000e-01, -1.77599000e-01, 1.46670000e-01, 4.35085000e-02, -3.87222000e-01, 9.94990000e-01, 3.77935000e-01, 7.48250000e-02, 1.97150000e-02, 3.08385000e-01, -8.35975000e-01, -8.93880000e-01, -6.85165000e-01, -4.81370000e-01, -3.36228500e-01, 2.91340000e+00, -2.76622000e-01, 1.77985000e-01, -7.18230000e-01, 1.30545000e-01, 6.03460000e-01, -2.49035000e-01, 5.51365000e-01, -1.67550000e-02, -9.80000000e-04, 5.29630000e-01, -2.27780000e-01, 3.84375000e-01, 5.08770000e-01, -3.15765000e-01, 3.01746115e-01, 5.93825000e-01, 9.88415500e-01, -2.95853500e-01, -1.96015000e-01]), 'party_articles': array([-0.50433 , -0.16026 , 0.08696 , -0.22346 , 0.109395 , 0.193285 , 0.289325 , 0.0988395 , -0.684108 , -0.096955 , -0.1763 , -0.306285 , 0.168245 , 0.644075 , -0.37435 , -0.38551 , 0.26593 , 0.116915 , 0.65119 , -0.21915 , -0.342685 , -0.0917405 , 0.251419 , 0.121205 , 0.12872515, -0.447035 , -0.42251 , -0.14577 , -0.392985 , 0.62462 , 1.04885 , 0.3406255 , -0.9024005 , 0.012877 , -0.79521 , 0.09429 , -0.0706935 , -0.078135 , -0.42978 , -0.2156945 , -0.113035 , -0.219345 , -0.87891 , 0.20523 , 0.17079 , -0.3291111 , -0.913575 , -0.126415 , 0.65498 , -0.2975464 ]), 'drinks': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'market_place': array([ 1.5284535e-01, -8.0640000e-02, -6.7710000e-02, 2.7467000e-01, 6.2887500e-01, -6.9731500e-01, -6.2464500e-01, -2.7357500e-01, -9.7784500e-02, 6.8520000e-02, 2.2050000e-03, -2.6884350e-01, -5.6717500e-01, -1.5944500e-01, 3.6962000e-01, 7.0226000e-01, 1.6200000e-01, -2.4915500e-01, -5.9524500e-01, -4.6763500e-01, 8.5653000e-01, -4.3951000e-01, -3.1289300e-01, 3.6497100e-01, -1.9862000e-01, -1.2867500e+00, -2.6297500e-01, 2.3820000e-01, 5.7564500e-01, 2.6461500e-01, 3.5481000e+00, 3.1361000e-01, 2.8795500e-01, -7.6710000e-02, 1.5154500e-02, -4.8535000e-01, -3.5167500e-01, 5.5790500e-01, 1.2007150e-01, -4.4555500e-01, -3.7528550e-01, -2.2686600e-01, 1.4548800e-01, -4.8349500e-02, 3.1328500e-01, 4.8606000e-01, 9.6989500e-02, -1.3875000e-01, 6.7078000e-01, 3.5310000e-02]), 'the kitchen': array([ 0.27307 , 0.246495 , -0.400945 , -0.135805 , 0.58728 , -0.1657535 , -0.57513 , -0.295725 , -0.04462861, -0.68539 , -0.274225 , 0.03947 , -0.123745 , 0.54466 , 0.22761025, 0.166529 , -0.14848 , 0.341135 , -0.01943 , -0.556735 , 0.6389495 , 0.1451 , -0.31323 , 0.10856 , -0.060562 , -1.11357 , -0.6186 , 0.2788255 , 0.319625 , -0.21072 , 3.0315 , -0.15982 , -0.341905 , 0.0733 , 0.01488257, 0.87522245, 0.19482 , 0.460465 , 0.7712205 , -0.076811 , 0.08112 , 0.06233 , -0.23312 , 0.1889415 , 0.22492 , 0.655975 , 0.09658745, -0.726805 , -0.007195 , -0.299525 ]), 'construction_tools_garden': array([ 0.18243 , -0.20012667, 0.26914333, -0.01552 , -0.22575367, -0.14384333, -0.13404667, -0.57869 , -0.03662867, 0.086824 , 0.01414667, 0.08944 , 0.18164567, 0.01512367, -0.37912667, -0.03950333, 0.24689333, 0.49698333, 0.49488 , -0.56728 , 0.63441667, -0.31123367, -0.714474 , -0.63042333, 0.24650867, 0.01005667, -0.29110333, -0.31333267, 0.40124333, 0.03250333, 1.7566 , -0.56499967, -0.07787367, -0.24509667, -0.05003333, 0.86399667, 0.17546033, 0.3963 , -0.00538933, 0.268763 , 0.04907333, -0.67754 , 0.12735333, 0.48446333, 0.68456267, -0.405439 , 0.17573667, 0.26160333, 0.22474333, -0.1786076 ]), \"fashion_women's clothes\": array([-0.22060067, -0.01955333, -0.70562667, -0.516526 , 0.34408667, -0.25464333, -0.19523333, -0.60999667, -0.09070633, 0.28833 , 0.0828445 , -0.16442 , -0.07932467, 0.23266333, 0.36181 , 0.01922333, -0.32360667, 0.11756333, 0.54914667, -0.87356 , 0.17646667, 0.68122633, -0.318074 , 0.190164 , -0.26547 , -0.20931 , -1.21053 , 0.58811667, 0.68706 , -0.19505667, 1.00763333, 0.55689033, 0.12575933, -0.06539433, -0.06026 , 0.823288 , -0.14054567, 0.6144 , -0.41369867, -0.147481 , 0.31987 , 0.15638667, 0.19810333, 0.1517 , 0.71653333, -0.50135 , 0.07344333, -0.50007667, 0.28248667, 0.15063907]), 'home_comfort': array([ 0.345755 , 0.687385 , -0.00641 , -0.318793 , 0.80272 , -0.322165 , -0.8930336 , 0.3639 , 0.1460923 , 0.082116 , -0.2519375 , -0.088095 , 0.220135 , -0.497 , 0.15241 , 0.237783 , -0.38234 , -0.01023895, -0.01225 , -0.41226 , -0.015355 , 0.77824 , -0.715435 , 0.12335 , 0.179905 , -1.17656 , -0.166625 , -0.01410195, 0.79957 , -0.125265 , 2.59845 , 0.971865 , 0.113664 , -0.0476665 , 0.528735 , 0.331815 , 0.051644 , 0.065665 , 0.2696835 , -0.50006 , 0.09236 , 0.1312875 , 0.0487 , 0.22047 , 0.186458 , 0.40967 , -0.269445 , -0.51695 , 0.22382 , 0.1359 ]), 'audio': array([-2.7164e-01, -1.0620e-01, 1.1639e+00, 8.3055e-01, -6.4055e-01, -3.8543e-01, -3.8031e-01, -1.0309e+00, 7.1602e-01, 1.5211e+00, 3.7758e-01, 3.3499e-01, 2.7958e-01, 5.2931e-01, -1.3379e-01, 4.2163e-02, -1.1169e+00, 4.0426e-01, 2.4580e-01, -4.5887e-01, 1.1611e+00, 6.7204e-01, 7.6799e-01, 4.1851e-01, 2.4399e-01, 5.2901e-04, -5.9963e-01, -2.3333e-01, -1.0900e-01, -3.2255e-01, 2.7442e+00, -9.7334e-01, 1.9286e-01, -7.1449e-01, 7.5143e-01, 1.0963e+00, 6.5071e-01, -4.2206e-01, -5.9653e-01, -4.3164e-01, 1.7057e+00, 6.6735e-01, -1.0194e+00, -5.6485e-02, -3.5755e-01, 3.1120e-01, 1.0823e+00, 5.9796e-01, -7.2269e-01, -2.1982e-02]), 'food_drinks': array([ 0.00813 , -0.291315 , -0.377935 , -0.4511 , 0.1697 , -0.33926 , -0.077915 , -0.333155 , 0.896992 , 0.2695405, 0.11274 , 0.153239 , 0.917145 , 0.075095 , 0.373115 , -0.0348 , 0.1596992, 0.318175 , 0.5339 , -0.51331 , 0.223305 , -0.0314365, 0.330239 , 0.06217 , -0.04503 , 0.046845 , -0.351505 , 0.21263 , 0.719215 , 0.48299 , 1.12075 , 0.3537705, -0.0518605, 0.1537985, -0.271715 , 0.753195 , -0.2181435, 0.15729 , 0.26829 , 0.1087805, 0.13845 , 0.02583 , 0.160275 , 0.227394 , 0.972075 , 0.131805 , -0.3517 , 0.262695 , 0.3159 , 0.1296036]), 'musica': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'foods': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'tablets_impression_image': array([-0.077384 , 0.13992667, -0.08127333, -0.24457667, 0.52161 , 0.0268 , 0.3012193 , -0.13138667, -0.154263 , 0.57826667, 0.146602 , 0.145905 , 0.19682467, 0.18164667, -0.227789 , 0.03761 , -0.04343 , -0.05507267, 0.34711833, -0.46857667, -0.36486 , 0.25493967, -0.13454067, -0.28168667, 0.48092667, -0.47859 , -0.93668333, 0.50939 , 0.46803667, 0.03142333, 1.06486667, 0.17615833, 0.07237967, -0.821551 , -0.53859667, 0.411347 , -0.13504233, 0.09343 , -0.61583667, -0.72796967, 0.31461667, -0.12306167, -0.34256333, 0.02995 , 0.17674467, -0.19554367, 0.07130667, 0.06865333, 0.40138667, -0.1278366 ]), 'imported_books': array([-0.244705 , 0.335795 , -0.222065 , -0.78122 , 0.08473 , -0.125975 , -0.356555 , -0.847265 , 0.175237 , 0.32992 , -0.42183 , 0.66945 , 0.312405 , 0.037295 , 0.552515 , -0.62933 , -0.01369 , 0.133375 , 0.353835 , -0.136222 , 0.324805 , 0.1226795, 0.455654 , 0.19045 , 0.274675 , 0.079355 , -0.969995 , -0.238115 , 0.005605 , -0.1791 , 0.73675 , -0.2492695, 0.0702045, -0.0370065, -0.43412 , 0.6826 , -0.2712735, 0.02613 , -0.31941 , -0.1399095, 0.58172 , -0.325435 , 0.09677 , 0.62292 , 0.174805 , -0.02849 , 0.20121 , 0.0775005, -0.17929 , -0.2912714]), 'portateis_house_furnace_and_cafe': array([-0.099666 , 0.003426 , -0.2046856 , -0.4632126 , 0.109458 , -0.064172 , 0.204808 , 0.0623822 , -0.2286756 , 0.034732 , -0.266516 , 0.151062 , 0.3890798 , 0.2014771 , -0.2018558 , -0.218973 , 0.1768202 , 0.264802 , 0.356504 , -0.397182 , 0.027362 , 0.1166374 , 0.0579048 , -0.1238992 , 0.052086 , -0.045282 , -0.3376 , 0.191854 , 0.0964178 , 0.1259412 , 0.60202 , -0.0926374 , -0.0940206 , -0.1818258 , -0.106402 , 0.4904742 , 0.0271738 , -0.035798 , -0.125744 , -0.1147594 , 0.0332394 , -0.208786 , -0.180152 , 0.290114 , 0.434124 , -0.255654 , -0.171102 , -0.226338 , 0.1334044 , -0.03362768]), 'fashion_sport': array([-0.468326 , 0.404715 , -1.04473 , 0.302491 , -0.172345 , -0.143529 , -0.655065 , -0.984575 , 0.0084035 , 0.255903 , 0.54345175, -0.341805 , -1.01145 , 0.18418 , 0.670005 , -0.139555 , -0.04731 , 0.870955 , -0.16649 , -1.08362 , -0.11597 , 0.521785 , -0.78153 , 0.90431 , -0.19628 , -1.032805 , -1.387205 , 0.41287 , 0.14743115, 0.10575 , 2.22825 , 0.85217 , -0.076315 , -0.38412 , -0.229925 , 0.122702 , -0.253095 , 0.754225 , -0.75183 , -0.40324 , 0.269256 , -0.121175 , 0.253995 , 0.092845 , 0.2290005 , -0.1804895 , -0.055165 , -0.118525 , 0.526355 , 0.28073 ]), 'Christmas articles': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'fashion_clothing_child_juvenile': array([-0.1697005 , 0.0846225 , -0.7907775 , -0.4484795 , 0.4509025 , 0.621975 , -0.3533375 , -0.8179925 , 0.67582675, 0.147415 , 0.01591088, -0.243015 , 0.0388425 , -0.08315852, 0.804845 , -0.151865 , -0.4756445 , -0.043465 , 0.37923 , -0.3736475 , 0.16074 , 0.524215 , -0.3643075 , 0.427535 , -0.64324 , -1.110075 , -0.7682625 , -0.10014 , 0.3830925 , -0.25006 , 2.06795 , 0.1736875 , 0.1705775 , -0.4934725 , 0.209775 , 0.558596 , 0.02229 , 0.23991 , -0.010885 , -0.6099635 , -0.264945 , 0.144368 , 0.53343 , 0.44280175, 0.7556875 , -0.43805 , 0.10335 , -0.811935 , 0.24922 , 0.41137 ]), 'dvds_blu_ray': array([-0.39314667, 0.23061333, 0.14749667, -0.25329667, -0.13175667, -0.36274333, 0.33394 , -0.02583333, 0.12817933, 0.54910333, 0.20746667, 0.5596 , 0.29848 , 0.42703 , -0.17808667, -0.16627 , 0.14480667, 0.17625333, 0.11319333, -0.39455 , -0.57405667, 0.128786 , 0.33444533, -0.27324333, 0.05667667, 0.34940333, -0.34053667, 0.22059967, 0.168559 , 0.14592 , -0.39446667, -0.05937933, -0.00499733, -0.33766867, 0.10468667, 0.56092333, 0.37097533, -0.04510667, -0.03376667, 0.00296733, 0.19969667, 0.20785333, -0.44646 , 0.24233333, 0.47532667, -0.39343 , 0.08812667, -0.32198667, 0.0627 , 0.34477813]), 'arts_and_crafts': array([-0.49332 , 0.52681667, -1.10482333, -0.02062333, 0.0057 , -0.18179667, -0.61973333, -0.95736 , -0.26367767, 0.16554 , 0.11252254, -0.06041 , 0.29226 , -0.16823067, -0.35258 , -0.24899167, 0.298813 , 0.61835 , -0.240977 , -0.36598 , 1.23992667, 0.55204333, -0.40991667, 0.066313 , -0.20028933, -0.56011667, -0.65885 , -0.65188667, -0.29332033, -0.57256 , 2.65833333, 0.16821933, -0.04925 , -0.691857 , 0.02931667, 0.62099333, -0.3367 , 0.52606333, 0.11731667, 0.47442423, 0.141009 , -0.03214667, 0.213229 , -0.115837 , 0.27594 , 0.18471467, -0.09605433, -0.61017 , -0.23260733, -0.0574 ]), 'pc_gamer': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'furniture_bedroom': array([ 0.30487 , 0.294645 , 0.00895 , -0.69152 , 0.473915 , -0.14226 , 0.08369 , 0.017115 , -0.307513 , 0.219474 , -0.54438 , -0.22494 , 0.465365 , 0.490195 , 0.163165 , 0.01455 , -0.174765 , 0.368275 , 0.583415 , -0.33221 , 0.150465 , 0.7285345, -0.538586 , 0.173255 , -0.15098 , 0.341725 , -0.33548 , 0.592765 , 0.496655 , -0.037535 , 0.1988 , -0.1238095, 0.1784445, 0.1923785, 0.213045 , 0.92709 , 0.2747815, -0.007905 , 0.326995 , -0.4153545, 0.169175 , -0.10017 , -0.0981945, 0.649535 , 0.15375 , -0.448295 , 0.189645 , -1.025065 , 0.174305 , -0.0934664]), 'cinema_photo': array([-0.2630185, 0.69991 , 0.125545 , 0.25244 , 0.194055 , -0.69504 , -0.559845 , -1.09955 , 0.111025 , 0.549665 , -0.102665 , -0.39955 , -0.06765 , 0.816255 , 0.51171 , -0.182385 , -0.511395 , 0.22274 , -0.357578 , -0.08566 , 1.154225 , 0.72874 , -0.4275679, 0.6007 , -0.038558 , -0.669535 , -1.46215 , -0.00609 , -0.24865 , -0.269616 , 1.77855 , -0.170537 , -0.009405 , -0.742215 , -0.402225 , 0.568995 , 0.27262 , 0.0691885, -0.61864 , -0.433645 , 0.962525 , 0.431915 , -0.03867 , -0.49001 , -0.074865 , 0.02116 , 0.27405 , -0.57604 , 0.28907 , 0.0622715]), 'diapers_hygiene': array([-0.59861 , -0.123945 , 0.109115 , -0.644945 , -0.135375 , 0.41613 , 0.167965 , -0.681365 , 0.395462 , 0.0864 , 0.446075 , 0.22311 , 0.63748 , 0.05853 , 0.1684 , 0.429185 , -0.701975 , 0.637835 , 0.57862 , -0.76477 , -0.038235 , 0.3163095 , 0.560914 , -0.374225 , -0.022415 , 0.417105 , -0.65033 , 0.56355 , 0.934065 , 0.1461375 , -0.646965 , 0.9586655 , -0.4055955 , 0.1694585 , -0.1692205 , 0.70821 , 0.02711195, 0.225575 , 0.1838 , -0.0665475 , 0.00714 , -0.3096115 , -0.0689485 , 0.61335 , 0.56992 , -0.3076395 , -0.007655 , -0.22928 , 0.362775 , -0.0895764 ]), 'flores': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172]), 'kitchen_and_food_preparadores_portables': array([-0.008676 , -0.066608 , -0.33233 , -0.3826546 , 0.235532 , -0.138756 , -0.097108 , -0.26343 , 0.2591442 , 0.0373122 , -0.049712 , 0.2148136 , 0.494688 , 0.230144 , 0.157134 , -0.044589 , 0.05191948, 0.405222 , 0.435294 , -0.55728 , 0.3219 , 0.1871012 , 0.1498912 , 0.0770928 , 0.0264332 , -0.130144 , -0.3339 , 0.1901 , 0.5611398 , 0.12659 , 1.39016 , 0.1918784 , -0.0187264 , 0.0551428 , -0.1131354 , 0.863488 , -0.1035688 , 0.314634 , 0.361196 , 0.0793706 , 0.1753734 , 0.030908 , 0.04689 , 0.2299356 , 0.747392 , 0.172958 , -0.143748 , -0.240028 , 0.154946 , 0.01384288]), 'insurance_and_services': array([ 3.55600000e-01, 1.31851667e-01, 1.30000000e-01, 8.22273333e-02, -1.94096667e-01, 5.71265333e-01, -8.71626667e-01, -3.83083333e-01, 5.28243333e-01, -5.23333333e-01, 2.66864667e-01, 4.18070000e-01, -7.99466667e-03, -3.73093333e-01, -2.11763333e-01, 5.95653000e-02, -4.29207000e-01, 4.53833333e-02, 3.11830000e-01, -3.08379000e-01, 9.91393333e-01, 5.60000000e-03, -5.25376667e-01, -1.30253333e-02, -5.31946667e-01, -1.31250000e+00, 7.14000000e-03, -7.02380000e-01, -4.83710000e-02, -2.24033333e-03, 3.44356667e+00, 5.46543333e-01, 4.10760000e-01, -2.78560000e-01, 2.34540000e-02, -4.12333333e-03, -1.32902667e-01, -7.62000000e-02, 6.74253333e-01, -2.20366667e-02, 5.31423333e-02, -1.58070000e-01, 4.86379667e-01, 4.46453333e-01, -1.05496667e-01, -2.26063333e-01, -5.88506667e-01, 2.20563333e-01, 2.69366667e-01, 5.35540000e-01]), 'furniture_colchao_and_upholstery': array([-0.274925 , -0.06702 , -0.2478475 , -0.47145075, -0.0501925 , -0.1457725 , 0.4994125 , 0.0583325 , -0.1418745 , 0.340415 , 0.12953 , 0.251045 , 0.4724625 , 0.2496925 , -0.2693075 , -0.37510125, 0.23952475, 0.3842975 , 0.3527125 , -0.317 , -0.2716475 , 0.05693175, 0.1762235 , -0.1000465 , 0.16426 , 0.3891725 , -0.3182325 , 0.165985 , 0.22365725, 0.1524025 , 0.0669 , 0.13235325, 0.06005675, -0.11024975, -0.203665 , 0.6325025 , -0.04205775, -0.0281375 , -0.255955 , 0.03341825, 0.13878425, -0.3188775 , -0.10142 , 0.3261125 , 0.54844 , -0.46054 , 0.0015925 , -0.0259725 , 0.156775 , -0.0920796 ]), 'cds_dvds_musicais': array([-0.45596 , -0.13718 , -0.23754 , -0.63402 , -0.10487 , -0.42744 , 0.83699 , 0.23567 , -0.078916 , 0.5 , 0.08264 , 0.2316 , 0.77999 , 0.47049 , -0.32597 , -0.51283 , 0.30945 , 0.47881 , 0.55381 , -0.24994 , -0.47739 , -0.073831 , 0.072328 , -0.10644 , 0.25275 , 0.97813 , -0.38809 , 0.29865 , 0.29393 , 0.35823 , -1.1929 , 0.071931 , 0.034599 , 0.027147 , -0.38162 , 0.73098 , 0.062593 , -0.14562 , -0.38141 , -0.072509 , 0.20806 , -0.54812 , -0.21912 , 0.51654 , 0.64665 , -0.65962 , 0.10605 , 0.17607 , 0.29246 , 0.0042172])} 2.3 | Cosine Similarity\nThe cosine similarity of any two product categories is the determined, given by the equation: $ \\frac{\\vec{a} \\cdot \\vec{b}}{|a||b|} $ where $\\vec{a}$ and $\\vec{b}$ are $N$ dimensional vectors The values are between $[-1,1]$, being similar in interpretation as a correlation Also returned is a dictionary mapping between the numerical name for a column in the embedding_dict and the categorical name 1 2 3 4 5 6 7 8 9 len_categories = len(embeddings) get_embeddings_lambda = lambda x: embeddings[x] similarities = np.zeros((len_categories, len_categories)) emb_dict = {} for i, (word1, emb1) in enumerate(embeddings.items()): for j, (word2, emb2) in enumerate(embeddings.items()): cosine_similarity = np.dot(emb1, emb2) / (norm(emb1) * norm(emb2)) similarities[i,j] = cosine_similarity 1 2 3 4 5 6 keys = enumerate(embeddings.keys()) embedding_dict = {} for i, key in keys: embedding_dict[i] = key embedding_dict {0: 'perfumery', 1: 'artes', 2: 'sport_leisure', 3: 'babies', 4: 'domestic_utilities', 5: 'musical instruments', 6: 'cool_stuff', 7: 'furniture_decoration', 8: 'home appliances', 9: 'toys', 10: 'bed table bath', 11: 'construction_tools_security', 12: 'informatica_accessories', 13: 'beauty_health', 14: 'bags_accessories', 15: 'garden_tools', 16: 'furniture_office', 17: 'automotive', 18: 'electronic', 19: 'fashion_shoes', 20: 'telephony', 21: 'stationary store', 22: 'fashion_bolsas_e_acessorios', 23: 'pcs', 24: 'house_construction', 25: 'watches_gifts', 26: 'construction_tools_construction', 27: 'pet_shop', 28: 'small appliances', 29: 'agro_industry_and_trade', 30: 'in', 31: 'living room furniture', 32: 'signaling_and_security', 33: 'air conditioning', 34: 'consoles_games', 35: 'general_interest_books', 36: 'construction_tools_tools', 37: 'fashion_underwear_e_moda_praia', 38: 'fashion_clothes_men', 39: 'furniture_cozinha_area_de_servico_jantar_e_jardim', 40: 'industry_comercio_e_nocios', 41: 'fixed_telephony', 42: 'construction_tools_lighting', 43: 'technical books', 44: 'party_articles', 45: 'drinks', 46: 'market_place', 47: 'the kitchen', 48: 'construction_tools_garden', 49: \"fashion_women's clothes\", 50: 'home_comfort', 51: 'audio', 52: 'food_drinks', 53: 'musica', 54: 'foods', 55: 'tablets_impression_image', 56: 'imported_books', 57: 'portateis_house_furnace_and_cafe', 58: 'fashion_sport', 59: 'Christmas articles', 60: 'fashion_clothing_child_juvenile', 61: 'dvds_blu_ray', 62: 'arts_and_crafts', 63: 'pc_gamer', 64: 'furniture_bedroom', 65: 'cinema_photo', 66: 'diapers_hygiene', 67: 'flores', 68: 'kitchen_and_food_preparadores_portables', 69: 'insurance_and_services', 70: 'furniture_colchao_and_upholstery', 71: 'cds_dvds_musicais'} 2.4 | Similarity Matrix \u0026 Heatmap\nA dataframe is created with similarity values for every product category Also made is a heatmap featuring all product categories, on a cool-warm scale from blue (loswest similarity) to red (highest similarity) Finally, the function get_similarity is created to obtain the similarity scores for any entered product category 1 2 3 4 similarities_df = pd.DataFrame(similarities) similarities_df = similarities_df.rename(columns=embedding_dict, index=embedding_dict) similarities_df perfumery artes sport_leisure babies domestic_utilities musical instruments cool_stuff furniture_decoration home appliances toys ... arts_and_crafts pc_gamer furniture_bedroom cinema_photo diapers_hygiene flores kitchen_and_food_preparadores_portables insurance_and_services furniture_colchao_and_upholstery cds_dvds_musicais perfumery 1.000000 1.000000 0.407878 -0.118951 0.257968 -0.177004 -0.087149 1.000000 0.033297 -0.198021 ... -0.314922 1.000000 0.358496 -0.242668 0.526981 1.000000 0.100799 -0.543074 0.864288 1.000000 artes 1.000000 1.000000 0.407878 -0.118951 0.257968 -0.177004 -0.087149 1.000000 0.033297 -0.198021 ... -0.314922 1.000000 0.358496 -0.242668 0.526981 1.000000 0.100799 -0.543074 0.864288 1.000000 sport_leisure 0.407878 0.407878 1.000000 0.122967 0.551266 0.179462 0.375641 0.407878 0.403078 0.212963 ... 0.295148 0.407878 0.196918 0.275566 0.428169 0.407878 0.419741 0.122980 0.587471 0.407878 babies -0.118951 -0.118951 0.122967 1.000000 0.277467 0.229472 0.357714 -0.118951 0.371962 0.569182 ... 0.221768 -0.118951 0.330407 0.146192 0.436191 -0.118951 0.489054 0.362452 0.094993 -0.118951 domestic_utilities 0.257968 0.257968 0.551266 0.277467 1.000000 0.268597 0.335793 0.257968 0.376892 0.332161 ... 0.308662 0.257968 0.104937 0.207909 0.324601 0.257968 0.579326 0.447626 0.506631 0.257968 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... flores 1.000000 1.000000 0.407878 -0.118951 0.257968 -0.177004 -0.087149 1.000000 0.033297 -0.198021 ... -0.314922 1.000000 0.358496 -0.242668 0.526981 1.000000 0.100799 -0.543074 0.864288 1.000000 kitchen_and_food_preparadores_portables 0.100799 0.100799 0.419741 0.489054 0.579326 0.462568 0.719475 0.100799 0.669633 0.576797 ... 0.624020 0.100799 0.500249 0.424094 0.423335 0.100799 1.000000 0.519644 0.476721 0.100799 insurance_and_services -0.543074 -0.543074 0.122980 0.362452 0.447626 0.491411 0.366427 -0.543074 0.429522 0.405047 ... 0.663339 -0.543074 -0.004517 0.402155 -0.113448 -0.543074 0.519644 1.000000 -0.170836 -0.543074 furniture_colchao_and_upholstery 0.864288 0.864288 0.587471 0.094993 0.506631 0.181650 0.236841 0.864288 0.326945 0.020209 ... 0.094675 0.864288 0.446304 -0.008462 0.552552 0.864288 0.476721 -0.170836 1.000000 0.864288 cds_dvds_musicais 1.000000 1.000000 0.407878 -0.118951 0.257968 -0.177004 -0.087149 1.000000 0.033297 -0.198021 ... -0.314922 1.000000 0.358496 -0.242668 0.526981 1.000000 0.100799 -0.543074 0.864288 1.000000 72 rows × 72 columns\n1 sns.heatmap(similarities_df.corr(\"pearson\").round(2), cmap = 'coolwarm', annot = False, vmin=-1, vmax=1) 1 get_similarity = lambda x: similarities_df[x] 3 | Entity Relationship Diagrams \u0026 Preview 3.1 | Previewing Datasets\nAccording to the below Entity Relationship Diagram, we preview tables utilized for this analysis 3.2 | olist_orders_dataset\n1 2 orders = pd.read_csv(\"datasets/olist_orders_dataset.csv\") orders order_id customer_id order_status order_purchase_timestamp order_approved_at order_delivered_carrier_date order_delivered_customer_date order_estimated_delivery_date 0 e481f51cbdc54678b7cc49136f2d6af7 9ef432eb6251297304e76186b10a928d delivered 2017-10-02 10:56:33 2017-10-02 11:07:15 2017-10-04 19:55:00 2017-10-10 21:25:13 2017-10-18 00:00:00 1 53cdb2fc8bc7dce0b6741e2150273451 b0830fb4747a6c6d20dea0b8c802d7ef delivered 2018-07-24 20:41:37 2018-07-26 03:24:27 2018-07-26 14:31:00 2018-08-07 15:27:45 2018-08-13 00:00:00 2 47770eb9100c2d0c44946d9cf07ec65d 41ce2a54c0b03bf3443c3d931a367089 delivered 2018-08-08 08:38:49 2018-08-08 08:55:23 2018-08-08 13:50:00 2018-08-17 18:06:29 2018-09-04 00:00:00 3 949d5b44dbf5de918fe9c16f97b45f8a f88197465ea7920adcdbec7375364d82 delivered 2017-11-18 19:28:06 2017-11-18 19:45:59 2017-11-22 13:39:59 2017-12-02 00:28:42 2017-12-15 00:00:00 4 ad21c59c0840e6cb83a9ceb5573f8159 8ab97904e6daea8866dbdbc4fb7aad2c delivered 2018-02-13 21:18:39 2018-02-13 22:20:29 2018-02-14 19:46:34 2018-02-16 18:17:02 2018-02-26 00:00:00 ... ... ... ... ... ... ... ... ... 99436 9c5dedf39a927c1b2549525ed64a053c 39bd1228ee8140590ac3aca26f2dfe00 delivered 2017-03-09 09:54:05 2017-03-09 09:54:05 2017-03-10 11:18:03 2017-03-17 15:08:01 2017-03-28 00:00:00 99437 63943bddc261676b46f01ca7ac2f7bd8 1fca14ff2861355f6e5f14306ff977a7 delivered 2018-02-06 12:58:58 2018-02-06 13:10:37 2018-02-07 23:22:42 2018-02-28 17:37:56 2018-03-02 00:00:00 99438 83c1379a015df1e13d02aae0204711ab 1aa71eb042121263aafbe80c1b562c9c delivered 2017-08-27 14:46:43 2017-08-27 15:04:16 2017-08-28 20:52:26 2017-09-21 11:24:17 2017-09-27 00:00:00 99439 11c177c8e97725db2631073c19f07b62 b331b74b18dc79bcdf6532d51e1637c1 delivered 2018-01-08 21:28:27 2018-01-08 21:36:21 2018-01-12 15:35:03 2018-01-25 23:32:54 2018-02-15 00:00:00 99440 66dea50a8b16d9b4dee7af250b4be1a5 edb027a75a1449115f6b43211ae02a24 delivered 2018-03-08 20:57:30 2018-03-09 11:20:28 2018-03-09 22:11:59 2018-03-16 13:08:30 2018-04-03 00:00:00 99441 rows × 8 columns\n3.3 | olist_order_customer_dataset\n1 2 orderCustomers = pd.read_csv(\"datasets/olist_customers_dataset.csv\") orderCustomers customer_id customer_unique_id customer_zip_code_prefix customer_city customer_state 0 06b8999e2fba1a1fbc88172c00ba8bc7 861eff4711a542e4b93843c6dd7febb0 14409 franca SP 1 18955e83d337fd6b2def6b18a428ac77 290c77bc529b7ac935b93aa66c333dc3 9790 sao bernardo do campo SP 2 4e7b3e00288586ebd08712fdd0374a03 060e732b5b29e8181a18229c7b0b2b5e 1151 sao paulo SP 3 b2b6027bc5c5109e529d4dc6358b12c3 259dac757896d24d7702b9acbbff3f3c 8775 mogi das cruzes SP 4 4f2d8ab171c80ec8364f7c12e35b23ad 345ecd01c38d18a9036ed96c73b8d066 13056 campinas SP ... ... ... ... ... ... 99436 17ddf5dd5d51696bb3d7c6291687be6f 1a29b476fee25c95fbafc67c5ac95cf8 3937 sao paulo SP 99437 e7b71a9017aa05c9a7fd292d714858e8 d52a67c98be1cf6a5c84435bd38d095d 6764 taboao da serra SP 99438 5e28dfe12db7fb50a4b2f691faecea5e e9f50caf99f032f0bf3c55141f019d99 60115 fortaleza CE 99439 56b18e2166679b8a959d72dd06da27f9 73c2643a0a458b49f58cea58833b192e 92120 canoas RS 99440 274fa6071e5e17fe303b9748641082c8 84732c5050c01db9b23e19ba39899398 6703 cotia SP 99441 rows × 5 columns\n3.4 | olist_order_reviews_dataset\n1 2 orderReviews = pd.read_csv(\"datasets/olist_order_reviews_dataset.csv\") orderReviews review_id order_id review_score review_comment_title review_comment_message review_creation_date review_answer_timestamp 0 7bc2406110b926393aa56f80a40eba40 73fc7af87114b39712e6da79b0a377eb 4 NaN NaN 2018-01-18 00:00:00 2018-01-18 21:46:59 1 80e641a11e56f04c1ad469d5645fdfde a548910a1c6147796b98fdf73dbeba33 5 NaN NaN 2018-03-10 00:00:00 2018-03-11 03:05:13 2 228ce5500dc1d8e020d8d1322874b6f0 f9e4b658b201a9f2ecdecbb34bed034b 5 NaN NaN 2018-02-17 00:00:00 2018-02-18 14:36:24 3 e64fb393e7b32834bb789ff8bb30750e 658677c97b385a9be170737859d3511b 5 NaN Recebi bem antes do prazo estipulado. 2017-04-21 00:00:00 2017-04-21 22:02:06 4 f7c4243c7fe1938f181bec41a392bdeb 8e6bfb81e283fa7e4f11123a3fb894f1 5 NaN Parabéns lojas lannister adorei comprar pela I... 2018-03-01 00:00:00 2018-03-02 10:26:53 ... ... ... ... ... ... ... ... 99219 574ed12dd733e5fa530cfd4bbf39d7c9 2a8c23fee101d4d5662fa670396eb8da 5 NaN NaN 2018-07-07 00:00:00 2018-07-14 17:18:30 99220 f3897127253a9592a73be9bdfdf4ed7a 22ec9f0669f784db00fa86d035cf8602 5 NaN NaN 2017-12-09 00:00:00 2017-12-11 20:06:42 99221 b3de70c89b1510c4cd3d0649fd302472 55d4004744368f5571d1f590031933e4 5 NaN Excelente mochila, entrega super rápida. Super... 2018-03-22 00:00:00 2018-03-23 09:10:43 99222 1adeb9d84d72fe4e337617733eb85149 7725825d039fc1f0ceb7635e3f7d9206 4 NaN NaN 2018-07-01 00:00:00 2018-07-02 12:59:13 99223 efe49f1d6f951dd88b51e6ccd4cc548f 90531360ecb1eec2a1fbb265a0db0508 1 NaN meu produto chegou e ja tenho que devolver, po... 2017-07-03 00:00:00 2017-07-03 21:01:49 99224 rows × 7 columns\n3.5 | olist_order_payments_dataset\n1 2 orderPayments = pd.read_csv(\"datasets/olist_order_payments_dataset.csv\") orderPayments order_id payment_sequential payment_type payment_installments payment_value 0 b81ef226f3fe1789b1e8b2acac839d17 1 credit_card 8 99.33 1 a9810da82917af2d9aefd1278f1dcfa0 1 credit_card 1 24.39 2 25e8ea4e93396b6fa0d3dd708e76c1bd 1 credit_card 1 65.71 3 ba78997921bbcdc1373bb41e913ab953 1 credit_card 8 107.78 4 42fdf880ba16b47b59251dd489d4441a 1 credit_card 2 128.45 ... ... ... ... ... ... 103881 0406037ad97740d563a178ecc7a2075c 1 boleto 1 363.31 103882 7b905861d7c825891d6347454ea7863f 1 credit_card 2 96.80 103883 32609bbb3dd69b3c066a6860554a77bf 1 credit_card 1 47.77 103884 b8b61059626efa996a60be9bb9320e10 1 credit_card 5 369.54 103885 28bbae6599b09d39ca406b747b6632b1 1 boleto 1 191.58 103886 rows × 5 columns\n3.6 | olist_order_items_dataset\n1 2 orderItems = pd.read_csv(\"datasets/olist_order_items_dataset.csv\") orderItems order_id order_item_id product_id seller_id shipping_limit_date price freight_value 0 00010242fe8c5a6d1ba2dd792cb16214 1 4244733e06e7ecb4970a6e2683c13e61 48436dade18ac8b2bce089ec2a041202 2017-09-19 09:45:35 58.90 13.29 1 00018f77f2f0320c557190d7a144bdd3 1 e5f2d52b802189ee658865ca93d83a8f dd7ddc04e1b6c2c614352b383efe2d36 2017-05-03 11:05:13 239.90 19.93 2 000229ec398224ef6ca0657da4fc703e 1 c777355d18b72b67abbeef9df44fd0fd 5b51032eddd242adc84c38acab88f23d 2018-01-18 14:48:30 199.00 17.87 3 00024acbcdf0a6daa1e931b038114c75 1 7634da152a4610f1595efa32f14722fc 9d7a1d34a5052409006425275ba1c2b4 2018-08-15 10:10:18 12.99 12.79 4 00042b26cf59d7ce69dfabb4e55b4fd9 1 ac6c3623068f30de03045865e4e10089 df560393f3a51e74553ab94004ba5c87 2017-02-13 13:57:51 199.90 18.14 ... ... ... ... ... ... ... ... 112645 fffc94f6ce00a00581880bf54a75a037 1 4aa6014eceb682077f9dc4bffebc05b0 b8bc237ba3788b23da09c0f1f3a3288c 2018-05-02 04:11:01 299.99 43.41 112646 fffcd46ef2263f404302a634eb57f7eb 1 32e07fd915822b0765e448c4dd74c828 f3c38ab652836d21de61fb8314b69182 2018-07-20 04:31:48 350.00 36.53 112647 fffce4705a9662cd70adb13d4a31832d 1 72a30483855e2eafc67aee5dc2560482 c3cfdc648177fdbbbb35635a37472c53 2017-10-30 17:14:25 99.90 16.95 112648 fffe18544ffabc95dfada21779c9644f 1 9c422a519119dcad7575db5af1ba540e 2b3e4a2a3ea8e01938cabda2a3e5cc79 2017-08-21 00:04:32 55.99 8.72 112649 fffe41c64501cc87c801fd61db3f6244 1 350688d9dc1e75ff97be326363655e01 f7ccf836d21b2fb1de37564105216cc1 2018-06-12 17:10:13 43.00 12.79 112650 rows × 7 columns\n3.7 | olist_products_dataset\n1 2 products = pd.read_csv(\"datasets/olist_products_dataset.csv\") products product_id product_category_name product_name_lenght product_description_lenght product_photos_qty product_weight_g product_length_cm product_height_cm product_width_cm 0 1e9e8ef04dbcff4541ed26657ea517e5 perfumaria 40.0 287.0 1.0 225.0 16.0 10.0 14.0 1 3aa071139cb16b67ca9e5dea641aaa2f artes 44.0 276.0 1.0 1000.0 30.0 18.0 20.0 2 96bd76ec8810374ed1b65e291975717f esporte_lazer 46.0 250.0 1.0 154.0 18.0 9.0 15.0 3 cef67bcfe19066a932b7673e239eb23d bebes 27.0 261.0 1.0 371.0 26.0 4.0 26.0 4 9dc1a7de274444849c219cff195d0b71 utilidades_domesticas 37.0 402.0 4.0 625.0 20.0 17.0 13.0 ... ... ... ... ... ... ... ... ... ... 32946 a0b7d5a992ccda646f2d34e418fff5a0 moveis_decoracao 45.0 67.0 2.0 12300.0 40.0 40.0 40.0 32947 bf4538d88321d0fd4412a93c974510e6 construcao_ferramentas_iluminacao 41.0 971.0 1.0 1700.0 16.0 19.0 16.0 32948 9a7c6041fa9592d9d9ef6cfe62a71f8c cama_mesa_banho 50.0 799.0 1.0 1400.0 27.0 7.0 27.0 32949 83808703fc0706a22e264b9d75f04a2e informatica_acessorios 60.0 156.0 2.0 700.0 31.0 13.0 20.0 32950 106392145fca363410d287a815be6de4 cama_mesa_banho 58.0 309.0 1.0 2083.0 12.0 2.0 7.0 32951 rows × 9 columns\n3.8 | olist_sellers_dataset\n1 2 3 #TEAL_NUMBER_2 sellers = pd.read_csv(\"datasets/olist_sellers_dataset.csv\") sellers seller_id seller_zip_code_prefix seller_city seller_state 0 3442f8959a84dea7ee197c632cb2df15 13023 campinas SP 1 d1b65fc7debc3361ea86b5f14c68d2e2 13844 mogi guacu SP 2 ce3ad9de960102d0677a81f5d0bb7b2d 20031 rio de janeiro RJ 3 c0f3eea2e14555b6faeea3dd58c1b1c3 4195 sao paulo SP 4 51a04a8a6bdcb23deccc82b0b80742cf 12914 braganca paulista SP ... ... ... ... ... 3090 98dddbc4601dd4443ca174359b237166 87111 sarandi PR 3091 f8201cab383e484733266d1906e2fdfa 88137 palhoca SC 3092 74871d19219c7d518d0090283e03c137 4650 sao paulo SP 3093 e603cf3fec55f8697c9059638d6c8eb5 96080 pelotas RS 3094 9e25199f6ef7e7c347120ff175652c3b 12051 taubate SP 3095 rows × 4 columns\n3.9 | olist_geolocation_dataset\n1 2 geolocation = pd.read_csv(\"datasets/olist_geolocation_dataset.csv\") geolocation geolocation_zip_code_prefix geolocation_lat geolocation_lng geolocation_city geolocation_state 0 1037 -23.545621 -46.639292 sao paulo SP 1 1046 -23.546081 -46.644820 sao paulo SP 2 1046 -23.546129 -46.642951 sao paulo SP 3 1041 -23.544392 -46.639499 sao paulo SP 4 1035 -23.541578 -46.641607 sao paulo SP ... ... ... ... ... ... 1000158 99950 -28.068639 -52.010705 tapejara RS 1000159 99900 -27.877125 -52.224882 getulio vargas RS 1000160 99950 -28.071855 -52.014716 tapejara RS 1000161 99980 -28.388932 -51.846871 david canabarro RS 1000162 99950 -28.070104 -52.018658 tapejara RS 1000163 rows × 5 columns\n4 | Merging Datasets 4.1 | Merging Individual Tables\nFirst, the olist_order_reviews_dataset and olist_orders_dataset are merged using an outer merge on the shared key of order_id for both tables Next olist_order_payments_dataset is merged on the previously merged tables using an outer merge on the order_id shared key 1 2 3 purpleRedMerge = orders.merge(orderReviews, how = 'outer', left_on = 'order_id', right_on = 'order_id') purpleRedMerge['review_score'].fillna(3.5, inplace=True) purpleRedMerge order_id customer_id order_status order_purchase_timestamp order_approved_at order_delivered_carrier_date order_delivered_customer_date order_estimated_delivery_date review_id review_score review_comment_title review_comment_message review_creation_date review_answer_timestamp 0 e481f51cbdc54678b7cc49136f2d6af7 9ef432eb6251297304e76186b10a928d delivered 2017-10-02 10:56:33 2017-10-02 11:07:15 2017-10-04 19:55:00 2017-10-10 21:25:13 2017-10-18 00:00:00 a54f0611adc9ed256b57ede6b6eb5114 4.0 NaN Não testei o produto ainda, mas ele veio corre... 2017-10-11 00:00:00 2017-10-12 03:43:48 1 53cdb2fc8bc7dce0b6741e2150273451 b0830fb4747a6c6d20dea0b8c802d7ef delivered 2018-07-24 20:41:37 2018-07-26 03:24:27 2018-07-26 14:31:00 2018-08-07 15:27:45 2018-08-13 00:00:00 8d5266042046a06655c8db133d120ba5 4.0 Muito boa a loja Muito bom o produto. 2018-08-08 00:00:00 2018-08-08 18:37:50 2 47770eb9100c2d0c44946d9cf07ec65d 41ce2a54c0b03bf3443c3d931a367089 delivered 2018-08-08 08:38:49 2018-08-08 08:55:23 2018-08-08 13:50:00 2018-08-17 18:06:29 2018-09-04 00:00:00 e73b67b67587f7644d5bd1a52deb1b01 5.0 NaN NaN 2018-08-18 00:00:00 2018-08-22 19:07:58 3 949d5b44dbf5de918fe9c16f97b45f8a f88197465ea7920adcdbec7375364d82 delivered 2017-11-18 19:28:06 2017-11-18 19:45:59 2017-11-22 13:39:59 2017-12-02 00:28:42 2017-12-15 00:00:00 359d03e676b3c069f62cadba8dd3f6e8 5.0 NaN O produto foi exatamente o que eu esperava e e... 2017-12-03 00:00:00 2017-12-05 19:21:58 4 ad21c59c0840e6cb83a9ceb5573f8159 8ab97904e6daea8866dbdbc4fb7aad2c delivered 2018-02-13 21:18:39 2018-02-13 22:20:29 2018-02-14 19:46:34 2018-02-16 18:17:02 2018-02-26 00:00:00 e50934924e227544ba8246aeb3770dd4 5.0 NaN NaN 2018-02-17 00:00:00 2018-02-18 13:02:51 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 99987 9c5dedf39a927c1b2549525ed64a053c 39bd1228ee8140590ac3aca26f2dfe00 delivered 2017-03-09 09:54:05 2017-03-09 09:54:05 2017-03-10 11:18:03 2017-03-17 15:08:01 2017-03-28 00:00:00 e262b3f92d1ce917aa412a9406cf61a6 5.0 NaN NaN 2017-03-22 00:00:00 2017-03-23 11:02:08 99988 63943bddc261676b46f01ca7ac2f7bd8 1fca14ff2861355f6e5f14306ff977a7 delivered 2018-02-06 12:58:58 2018-02-06 13:10:37 2018-02-07 23:22:42 2018-02-28 17:37:56 2018-03-02 00:00:00 29bb71b2760d0f876dfa178a76bc4734 4.0 NaN So uma peça que veio rachado mas tudo bem rs 2018-03-01 00:00:00 2018-03-02 17:50:01 99989 83c1379a015df1e13d02aae0204711ab 1aa71eb042121263aafbe80c1b562c9c delivered 2017-08-27 14:46:43 2017-08-27 15:04:16 2017-08-28 20:52:26 2017-09-21 11:24:17 2017-09-27 00:00:00 371579771219f6db2d830d50805977bb 5.0 NaN Foi entregue antes do prazo. 2017-09-22 00:00:00 2017-09-22 23:10:57 99990 11c177c8e97725db2631073c19f07b62 b331b74b18dc79bcdf6532d51e1637c1 delivered 2018-01-08 21:28:27 2018-01-08 21:36:21 2018-01-12 15:35:03 2018-01-25 23:32:54 2018-02-15 00:00:00 8ab6855b9fe9b812cd03a480a25058a1 2.0 NaN Foi entregue somente 1. Quero saber do outro p... 2018-01-26 00:00:00 2018-01-27 09:16:56 99991 66dea50a8b16d9b4dee7af250b4be1a5 edb027a75a1449115f6b43211ae02a24 delivered 2018-03-08 20:57:30 2018-03-09 11:20:28 2018-03-09 22:11:59 2018-03-16 13:08:30 2018-04-03 00:00:00 dc9c59b4688062c25758c2be4cafc523 5.0 NaN NaN 2018-03-17 00:00:00 2018-03-17 16:33:31 99992 rows × 14 columns\n1 purpleRedGreyMerge = purpleRedMerge.merge(orderPayments, how = \"outer\", left_on = \"order_id\", right_on = \"order_id\") 4.2 | Further Merges \u0026 Drops\nolist_order_customer_dataset is merged on the previously combined tables through an outer merge on customer_id as the shared key with duplicates and null values then dropped The temporary table teal2BlueMerge is created by merging together olist_sellers_dataset and olist_geolocation_dataset through an outer merge, left on seller_zip_code_prefix and right on geolocation_zip_code_prefix with dulicates and null values then dropped As before, another temporary dataframe is created, merging olist_order_items_dataset and olist_products_dataset using an outer merge on the shared key order_id The two previously created temporary tables are merged together on an outer merge on the shared key seller_id 1 2 3 4 teal1PurpleRedGreyMerge = pd.merge(orderCustomers, purpleRedGreyMerge, how = \"outer\", left_on = 'customer_id', right_on = 'customer_id') teal1PurpleRedGreyMerge = teal1PurpleRedGreyMerge.drop_duplicates(subset=['customer_id']) teal1PurpleRedGreyMerge = teal1PurpleRedGreyMerge.dropna(subset=['customer_id']) teal1PurpleRedGreyMerge 1 2 3 4 teal2BlueMerge = pd.merge(sellers, geolocation, how='outer', left_on = 'seller_zip_code_prefix', right_on = 'geolocation_zip_code_prefix') teal2BlueMerge = teal2BlueMerge.drop_duplicates(subset=['seller_id']) teal2BlueMerge = teal2BlueMerge.dropna(subset=['seller_id']) teal2BlueMerge seller_id seller_zip_code_prefix seller_city seller_state geolocation_zip_code_prefix geolocation_lat geolocation_lng geolocation_city geolocation_state 0 3442f8959a84dea7ee197c632cb2df15 13023.0 campinas SP 13023.0 -22.898536 -47.063125 campinas SP 80 e0eabded302882513ced4ea3eb0c7059 13023.0 campinas SP 13023.0 -22.898536 -47.063125 campinas SP 160 d1b65fc7debc3361ea86b5f14c68d2e2 13844.0 mogi guacu SP 13844.0 -22.382941 -46.946641 mogi-guacu SP 263 ce3ad9de960102d0677a81f5d0bb7b2d 20031.0 rio de janeiro RJ 20031.0 -22.910641 -43.176510 rio de janeiro RJ 650 1d2732ef8321502ee8488e8bed1ab8cd 20031.0 rio de janeiro RJ 20031.0 -22.910641 -43.176510 rio de janeiro RJ ... ... ... ... ... ... ... ... ... ... 434730 f1fdf2d13186575751aa25876536d85c 5314.0 sao paulo SP 5314.0 -23.534949 -46.733916 sao paulo SP 434792 98dddbc4601dd4443ca174359b237166 87111.0 sarandi PR 87111.0 -23.456431 -51.866369 sarandi PR 434860 74871d19219c7d518d0090283e03c137 4650.0 sao paulo SP 4650.0 -23.659845 -46.677882 sao paulo SP 434928 e603cf3fec55f8697c9059638d6c8eb5 96080.0 pelotas RS 96080.0 -31.744231 -52.328761 pelotas RS 435024 9e25199f6ef7e7c347120ff175652c3b 12051.0 taubate SP 12051.0 -23.016003 -45.582021 taubate SP 3095 rows × 9 columns\n1 2 3 4 orangeYellowMerge = pd.merge(orderItems, products, how='outer', left_on = 'product_id', right_on = 'product_id') orangeYellowMerge['product_category_name'].fillna(value=\"\", inplace=True) orangeYellowMerge.fillna(value=0, inplace=True) orangeYellowMerge order_id order_item_id product_id seller_id shipping_limit_date price freight_value product_category_name product_name_lenght product_description_lenght product_photos_qty product_weight_g product_length_cm product_height_cm product_width_cm 0 00010242fe8c5a6d1ba2dd792cb16214 1 4244733e06e7ecb4970a6e2683c13e61 48436dade18ac8b2bce089ec2a041202 2017-09-19 09:45:35 58.9 13.29 cool_stuff 58.0 598.0 4.0 650.0 28.0 9.0 14.0 1 130898c0987d1801452a8ed92a670612 1 4244733e06e7ecb4970a6e2683c13e61 48436dade18ac8b2bce089ec2a041202 2017-07-05 02:44:11 55.9 17.96 cool_stuff 58.0 598.0 4.0 650.0 28.0 9.0 14.0 2 532ed5e14e24ae1f0d735b91524b98b9 1 4244733e06e7ecb4970a6e2683c13e61 48436dade18ac8b2bce089ec2a041202 2018-05-23 10:56:25 64.9 18.33 cool_stuff 58.0 598.0 4.0 650.0 28.0 9.0 14.0 3 6f8c31653edb8c83e1a739408b5ff750 1 4244733e06e7ecb4970a6e2683c13e61 48436dade18ac8b2bce089ec2a041202 2017-08-07 18:55:08 58.9 16.17 cool_stuff 58.0 598.0 4.0 650.0 28.0 9.0 14.0 4 7d19f4ef4d04461989632411b7e588b9 1 4244733e06e7ecb4970a6e2683c13e61 48436dade18ac8b2bce089ec2a041202 2017-08-16 22:05:11 58.9 13.29 cool_stuff 58.0 598.0 4.0 650.0 28.0 9.0 14.0 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 112645 ffebd80e3291e811c308365936897efd 1 4cc4d02efc8f249c13355147fb44e34d d1c7fa84e48cfa21a0e595167c1c500e 2018-07-18 20:23:55 129.9 51.20 ferramentas_jardim 37.0 653.0 1.0 6700.0 35.0 12.0 22.0 112646 ffee31fb4b5e35c9123608015637c495 1 b10ecf8e33aaaea419a9fa860ea80fb5 0241d4d5d36f10f80c644447315af0bd 2018-08-21 10:10:11 99.0 13.52 moveis_decoracao 30.0 308.0 1.0 2300.0 37.0 30.0 20.0 112647 fff7c4452f050315db1b3f24d9df5fcd 1 dd469c03ad67e201bc2179ef077dcd48 7e93a43ef30c4f03f38b393420bc753a 2017-06-07 17:05:23 736.0 20.91 relogios_presentes 33.0 658.0 3.0 400.0 19.0 9.0 15.0 112648 fffa82886406ccf10c7b4e35c4ff2788 1 bbe7651fef80287a816ead73f065fc4b 8f2ce03f928b567e3d56181ae20ae952 2017-12-22 17:31:42 229.9 44.02 esporte_lazer 32.0 280.0 2.0 2700.0 60.0 15.0 15.0 112649 fffe41c64501cc87c801fd61db3f6244 1 350688d9dc1e75ff97be326363655e01 f7ccf836d21b2fb1de37564105216cc1 2018-06-12 17:10:13 43.0 12.79 cama_mesa_banho 47.0 511.0 1.0 600.0 30.0 3.0 19.0 112650 rows × 15 columns\n1 2 teal2BlueOrangeYellowMerge = pd.merge(orangeYellowMerge, teal2BlueMerge, how='outer', left_on = 'seller_id', right_on = 'seller_id') teal2BlueOrangeYellowMerge = teal2BlueOrangeYellowMerge.drop(labels = [\"seller_state\", \"geolocation_state\", \"geolocation_zip_code_prefix\", \"geolocation_city\"], axis = 1) 4.3 | Final Merges \u0026 Drops\nFinally, the two created temporary tables are merged through an outer merge on the shared key order_id For this analysis, many columns of ths final table are not needed and thus dropped This final table is then exported as a .csv file 1 2 3 finalMerge = pd.merge(teal2BlueOrangeYellowMerge, teal1PurpleRedGreyMerge, how='outer', left_on = \"order_id\", right_on = \"order_id\") finalMerge.info() finalMerge ","wordCount":"11720","inLanguage":"en","image":"https://sunnyson.dev/projects/nyu-x-dsc-recommender/images/peak-presentation-overview.png","datePublished":"2023-07-29T07:00:00-04:00","dateModified":"2023-07-29T07:00:00-04:00","author":{"@type":"Person","name":"Sunny Son"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sunnyson.dev/projects/nyu-x-dsc-recommender/"},"publisher":{"@type":"Organization","name":"Sunny's Digital","logo":{"@type":"ImageObject","url":"https://sunnyson.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sunnyson.dev/ accesskey=h title="Sunny's Digital (Alt + H)"><img src=https://sunnyson.dev/sun-with-face-emoji.png alt="Site icon in header" aria-label=logo height=35>Sunny's Digital</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://sunnyson.dev/aboutme/ title="About Me"><span>About Me</span></a></li><li><a href=https://sunnyson.dev/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://sunnyson.dev/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://sunnyson.dev/reading/ title=Reading><span>Reading</span></a></li><li><a href=https://sunnyson.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://sunnyson.dev/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sunnyson.dev/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://web-sum.sunnyson.dev/ title="Web-Sum Plugin"><span>Web-Sum Plugin</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sunnyson.dev/>Home</a>&nbsp;»&nbsp;<a href=https://sunnyson.dev/projects/>Projects</a></div><h1 class=post-title>NYU x DSC Datathon Olist Recommender System</h1><div class=post-meta><span title='2023-07-29 07:00:00 -0400 -0400'>July 29, 2023</span>&nbsp;·&nbsp;56 min&nbsp;·&nbsp;11720 words&nbsp;·&nbsp;Sunny Son</div></header><figure class=entry-cover><a href=https://sunnyson.dev/projects/nyu-x-dsc-recommender/images/peak-presentation-overview.png target=_blank rel="noopener noreferrer"><img loading=lazy src=https://sunnyson.dev/projects/nyu-x-dsc-recommender/images/peak-presentation-overview.png alt></a></figure><div class="toc side left"><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#b1-span-stylecolorf1a424span-initial-setupb aria-label="1 | Initial Setup"><b>1 <span style=color:#f1a424>|</span> Initial Setup</b></a></li><li><a href=#b2-span-stylecolorf1a424span-glove-embeddingsb aria-label="2 | GloVe Embeddings"><b>2 <span style=color:#f1a424>|</span> GloVe Embeddings</b></a></li><li><a href=#b3-span-stylecolorf1a424span-entity-relationship-diagrams--previewb aria-label="3 | Entity Relationship Diagrams &amp;amp; Preview"><b>3 <span style=color:#f1a424>|</span> Entity Relationship Diagrams & Preview</b></a></li><li><a href=#b4-span-stylecolorf1a424span-merging-datasetsb aria-label="4 | Merging Datasets"><b>4 <span style=color:#f1a424>|</span> Merging Datasets</b></a></li><li><a href=#b5-span-stylecolorf1a424span-imputing-missing-values--train-test-splitb aria-label="5 | Imputing Missing Values &amp;amp; Train Test Split"><b>5 <span style=color:#f1a424>|</span> Imputing Missing Values & Train Test Split</b></a></li><li><a href=#b6-span-stylecolorf1a424span-knn-classifier-model--recommender-systemb aria-label="6 | KNN Classifier Model &amp;amp; Recommender System"><b>6 <span style=color:#f1a424>|</span> KNN Classifier Model & Recommender System</b></a></li></ul></div></details></div><div class=post-content><p align=center><img src=https://i.imgur.com/W4Qot5m.png alt="Olist Dataset Cover" width=1200px></p><h2 id=b1-span-stylecolorf1a424span-initial-setupb><b>1 <span style=color:#f1a424>|</span> Initial Setup</b><a hidden class=anchor aria-hidden=true href=#b1-span-stylecolorf1a424span-initial-setupb>#</a></h2><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>1.1 |</span></b> Package Installation</b></p></div><ul><li><code>numpy</code> and <code>pandas</code> for basic data-manipulation</li><li><code>sklearn</code> and associated modules to run our machine learning algorithms</li><li><code>scipy</code> associated modules (<code>norm</code>) to compute the cosime similarity later on</li><li><code>seaborn</code> to output graphs</li><li>Miscellaneous packages for flow of the notebook</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>utils</span>
</span></span><span class=line><span class=cl><span class=err>!</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>scikit</span><span class=o>-</span><span class=n>learn</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>numpy.linalg</span> <span class=kn>import</span> <span class=n>norm</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>scipy</span> <span class=k>as</span> <span class=nn>sc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.neighbors</span> <span class=kn>import</span> <span class=n>KNeighborsClassifier</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.impute</span> <span class=kn>import</span> <span class=n>KNNImputer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn</span> <span class=kn>import</span> <span class=n>preprocessing</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.linalg</span> <span class=kn>import</span> <span class=n>norm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>utils</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span></code></pre></td></tr></table></div></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>1.2 |</span></b> Connecting to Github and Google Drive</b></p></div><ul><li>This notebook is connected to the associated Github repository for easy access and version contol</li><li>Optionally, it is also tested and connected to Google Drive if possible</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=s1>&#39;google.colab&#39;</span> <span class=ow>in</span> <span class=n>sys</span><span class=o>.</span><span class=n>modules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=o>%</span><span class=n>cd</span> <span class=o>/</span><span class=n>content</span>
</span></span><span class=line><span class=cl>    <span class=err>!</span><span class=n>rm</span> <span class=o>-</span><span class=n>rf</span> <span class=n>Datathon_F22</span>
</span></span><span class=line><span class=cl>    <span class=err>!</span><span class=n>git</span> <span class=n>clone</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>sunnydigital</span><span class=o>/</span><span class=n>Datathon_F22</span>
</span></span><span class=line><span class=cl>    <span class=o>%</span><span class=n>cd</span> <span class=n>Datathon_F22</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=s1>&#39;google.colab&#39;</span> <span class=ow>in</span> <span class=n>sys</span><span class=o>.</span><span class=n>modules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=kn>from</span> <span class=nn>google.colab</span> <span class=kn>import</span> <span class=n>drive</span>
</span></span><span class=line><span class=cl>    <span class=n>drive</span><span class=o>.</span><span class=n>mount</span><span class=p>(</span><span class=s1>&#39;/content/drive&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>1.3 |</span></b> Preprocessing Product Category Names</b></p></div><ul><li>After initally reading in the <code>product_category_name_translation.csv</code> we need to transform the data into a useable format</li><li>An initial inspection of the number of products uder each category is displayed</li><li>The english translations for product names are given (from the associated column in the <code>product_category_name_translation.csv</code>)</li><li>For each category, the individual words making up the category is split using <code>re.split</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>trans_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;datasets/product_category_name_translation.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>og_cat_name</span> <span class=o>=</span> <span class=n>trans_df</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>og_cat_name</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>og_cat_name</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;portateis_cozinha_e_preparadores_de_alimentos&#39;</span><span class=p>,</span> <span class=s1>&#39;pc_gamer&#39;</span><span class=p>,</span> <span class=s1>&#39;pcs&#39;</span><span class=p>,</span> <span class=s1>&#39;other&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>og_name_to_idx</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>name</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>og_cat_name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>og_name_to_idx</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>og_name_to_idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>product_categories</span> <span class=o>=</span> <span class=n>trans_df</span><span class=p>[</span><span class=s1>&#39;product_category_name_english&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>product_categories</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>product_categories</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;portateis_cozinha_e_preparadores_de_alimentos&#39;</span><span class=p>,</span> <span class=s1>&#39;pc_gamer&#39;</span><span class=p>,</span> <span class=s1>&#39;pcs&#39;</span><span class=p>,</span> <span class=s1>&#39;other&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>product_categories</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>product_categories_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>category</span> <span class=ow>in</span> <span class=n>product_categories</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=n>product_categories_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;_| &#39;</span><span class=p>,</span> <span class=n>category</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>product_categories_list</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>{'beleza_saude': 0,
 'informatica_acessorios': 1,
 'automotivo': 2,
 'cama_mesa_banho': 3,
 'moveis_decoracao': 4,
 'esporte_lazer': 5,
 'perfumaria': 6,
 'utilidades_domesticas': 7,
 'telefonia': 8,
 'relogios_presentes': 9,
 'alimentos_bebidas': 10,
 'bebes': 11,
 'papelaria': 12,
 'tablets_impressao_imagem': 13,
 'brinquedos': 14,
 'telefonia_fixa': 15,
 'ferramentas_jardim': 16,
 'fashion_bolsas_e_acessorios': 17,
 'eletroportateis': 18,
 'consoles_games': 19,
 'audio': 20,
 'fashion_calcados': 21,
 'cool_stuff': 22,
 'malas_acessorios': 23,
 'climatizacao': 24,
 'construcao_ferramentas_construcao': 25,
 'moveis_cozinha_area_de_servico_jantar_e_jardim': 26,
 'construcao_ferramentas_jardim': 27,
 'fashion_roupa_masculina': 28,
 'pet_shop': 29,
 'moveis_escritorio': 30,
 'market_place': 31,
 'eletronicos': 32,
 'eletrodomesticos': 33,
 'artigos_de_festas': 34,
 'casa_conforto': 35,
 'construcao_ferramentas_ferramentas': 36,
 'agro_industria_e_comercio': 37,
 'moveis_colchao_e_estofado': 38,
 'livros_tecnicos': 39,
 'casa_construcao': 40,
 'instrumentos_musicais': 41,
 'moveis_sala': 42,
 'construcao_ferramentas_iluminacao': 43,
 'industria_comercio_e_negocios': 44,
 'alimentos': 45,
 'artes': 46,
 'moveis_quarto': 47,
 'livros_interesse_geral': 48,
 'construcao_ferramentas_seguranca': 49,
 'fashion_underwear_e_moda_praia': 50,
 'fashion_esporte': 51,
 'sinalizacao_e_seguranca': 52,
 'pcs': 73,
 'artigos_de_natal': 54,
 'fashion_roupa_feminina': 55,
 'eletrodomesticos_2': 56,
 'livros_importados': 57,
 'bebidas': 58,
 'cine_foto': 59,
 'la_cuisine': 60,
 'musica': 61,
 'casa_conforto_2': 62,
 'portateis_casa_forno_e_cafe': 63,
 'cds_dvds_musicais': 64,
 'dvds_blu_ray': 65,
 'flores': 66,
 'artes_e_artesanato': 67,
 'fraldas_higiene': 68,
 'fashion_roupa_infanto_juvenil': 69,
 'seguros_e_servicos': 70,
 'portateis_cozinha_e_preparadores_de_alimentos': 71,
 'pc_gamer': 72,
 'other': 74}



array(['health_beauty', 'computers_accessories', 'auto', 'bed_bath_table',
       'furniture_decor', 'sports_leisure', 'perfumery', 'housewares',
       'telephony', 'watches_gifts', 'food_drink', 'baby', 'stationery',
       'tablets_printing_image', 'toys', 'fixed_telephony',
       'garden_tools', 'fashion_bags_accessories', 'small_appliances',
       'consoles_games', 'audio', 'fashion_shoes', 'cool_stuff',
       'luggage_accessories', 'air_conditioning',
       'construction_tools_construction',
       'kitchen_dining_laundry_garden_furniture',
       'costruction_tools_garden', 'fashion_male_clothing', 'pet_shop',
       'office_furniture', 'market_place', 'electronics',
       'home_appliances', 'party_supplies', 'home_confort',
       'costruction_tools_tools', 'agro_industry_and_commerce',
       'furniture_mattress_and_upholstery', 'books_technical',
       'home_construction', 'musical_instruments',
       'furniture_living_room', 'construction_tools_lights',
       'industry_commerce_and_business', 'food', 'art',
       'furniture_bedroom', 'books_general_interest',
       'construction_tools_safety', 'fashion_underwear_beach',
       'fashion_sport', 'signaling_and_security', 'computers',
       'christmas_supplies', 'fashio_female_clothing',
       'home_appliances_2', 'books_imported', 'drinks', 'cine_photo',
       'la_cuisine', 'music', 'home_comfort_2',
       'small_appliances_home_oven_and_coffee', 'cds_dvds_musicals',
       'dvds_blu_ray', 'flowers', 'arts_and_craftmanship',
       'diapers_and_hygiene', 'fashion_childrens_clothes',
       'security_and_services',
       'portateis_cozinha_e_preparadores_de_alimentos', 'pc_gamer', 'pcs',
       'other'], dtype=object)





[['health', 'beauty'],
 ['computers', 'accessories'],
 ['auto'],
 ['bed', 'bath', 'table'],
 ['furniture', 'decor'],
 ['sports', 'leisure'],
 ['perfumery'],
 ['housewares'],
 ['telephony'],
 ['watches', 'gifts'],
 ['food', 'drink'],
 ['baby'],
 ['stationery'],
 ['tablets', 'printing', 'image'],
 ['toys'],
 ['fixed', 'telephony'],
 ['garden', 'tools'],
 ['fashion', 'bags', 'accessories'],
 ['small', 'appliances'],
 ['consoles', 'games'],
 ['audio'],
 ['fashion', 'shoes'],
 ['cool', 'stuff'],
 ['luggage', 'accessories'],
 ['air', 'conditioning'],
 ['construction', 'tools', 'construction'],
 ['kitchen', 'dining', 'laundry', 'garden', 'furniture'],
 ['costruction', 'tools', 'garden'],
 ['fashion', 'male', 'clothing'],
 ['pet', 'shop'],
 ['office', 'furniture'],
 ['market', 'place'],
 ['electronics'],
 ['home', 'appliances'],
 ['party', 'supplies'],
 ['home', 'confort'],
 ['costruction', 'tools', 'tools'],
 ['agro', 'industry', 'and', 'commerce'],
 ['furniture', 'mattress', 'and', 'upholstery'],
 ['books', 'technical'],
 ['home', 'construction'],
 ['musical', 'instruments'],
 ['furniture', 'living', 'room'],
 ['construction', 'tools', 'lights'],
 ['industry', 'commerce', 'and', 'business'],
 ['food'],
 ['art'],
 ['furniture', 'bedroom'],
 ['books', 'general', 'interest'],
 ['construction', 'tools', 'safety'],
 ['fashion', 'underwear', 'beach'],
 ['fashion', 'sport'],
 ['signaling', 'and', 'security'],
 ['computers'],
 ['christmas', 'supplies'],
 ['fashio', 'female', 'clothing'],
 ['home', 'appliances', '2'],
 ['books', 'imported'],
 ['drinks'],
 ['cine', 'photo'],
 ['la', 'cuisine'],
 ['music'],
 ['home', 'comfort', '2'],
 ['small', 'appliances', 'home', 'oven', 'and', 'coffee'],
 ['cds', 'dvds', 'musicals'],
 ['dvds', 'blu', 'ray'],
 ['flowers'],
 ['arts', 'and', 'craftmanship'],
 ['diapers', 'and', 'hygiene'],
 ['fashion', 'childrens', 'clothes'],
 ['security', 'and', 'services'],
 ['portateis', 'cozinha', 'e', 'preparadores', 'de', 'alimentos'],
 ['pc', 'gamer'],
 ['pcs'],
 ['other']]
</code></pre><h2 id=b2-span-stylecolorf1a424span-glove-embeddingsb><b>2 <span style=color:#f1a424>|</span> GloVe Embeddings</b><a hidden class=anchor aria-hidden=true href=#b2-span-stylecolorf1a424span-glove-embeddingsb>#</a></h2><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>2.1 |</span></b> Indexer Object and Embedding initialization</b></p></div><ul><li>An Indexer Object is created to map words to a dictionary</li><li><code>read_wrod_embeddings</code> is used to interface between the stored GloVe-50d embeddings in the file <code>glove.6B.50d-relativized.txt</code> and the dictionary protocal defined previously in the Indexer Object</li><li>Finally an indexer object, <code>word_indexer</code> and the embedded dictionary <code>embeddings</code> object is returned</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Indexer</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Bijection between objects and integers starting at 0. Useful for mapping
</span></span></span><span class=line><span class=cl><span class=s2>    labels, features, etc. into coordinates of a vector space.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Attributes:
</span></span></span><span class=line><span class=cl><span class=s2>        @objs_to_ints
</span></span></span><span class=line><span class=cl><span class=s2>        @ints_to_objs
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ints_to_objs</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>str</span><span class=p>([</span><span class=nb>str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>get_object</span><span class=p>(</span><span class=n>i</span><span class=p>))</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=p>))])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=fm>__repr__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__len__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_object</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>index</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            @param index: integer index to look up
</span></span></span><span class=line><span class=cl><span class=s2>            @return: Returns the object corresponding to the particular index or None if not found
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>index</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>ints_to_objs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>ints_to_objs</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>contains</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            @param object: object to look up
</span></span></span><span class=line><span class=cl><span class=s2>            @return: Returns True if it is in the Indexer, False otherwise
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>index_of</span><span class=p>(</span><span class=nb>object</span><span class=p>)</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>index_of</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            @param object: object to look up
</span></span></span><span class=line><span class=cl><span class=s2>            @return: Returns -1 if the object isn&#39;t present, index otherwise
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nb>object</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>[</span><span class=nb>object</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_and_get_index</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>object</span><span class=p>,</span> <span class=n>add</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Adds the object to the index if it isn&#39;t present, always returns a nonnegative index
</span></span></span><span class=line><span class=cl><span class=s2>            @param object: object to look up or add
</span></span></span><span class=line><span class=cl><span class=s2>            @param add: True by default, False if we shouldn&#39;t add the object. If False, equivalent to index_of.
</span></span></span><span class=line><span class=cl><span class=s2>            @return: The index of the object
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>add</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>index_of</span><span class=p>(</span><span class=nb>object</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nb>object</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>new_idx</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>[</span><span class=nb>object</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_idx</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>ints_to_objs</span><span class=p>[</span><span class=n>new_idx</span><span class=p>]</span> <span class=o>=</span> <span class=nb>object</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>objs_to_ints</span><span class=p>[</span><span class=nb>object</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_word_embeddings</span><span class=p>(</span><span class=n>embeddings_file</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Loads the given embeddings (ASCII-formatted) into a WordEmbeddings object. Augments this with an UNK embedding
</span></span></span><span class=line><span class=cl><span class=s2>    that is the 0 vector. Reads in all embeddings with no filtering -- you should only use this for relativized
</span></span></span><span class=line><span class=cl><span class=s2>    word embedding files.
</span></span></span><span class=line><span class=cl><span class=s2>        @param embeddings_file: path to the file containing embeddings
</span></span></span><span class=line><span class=cl><span class=s2>        @return: WordEmbeddings object reflecting the words and their embeddings
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>embeddings_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>word_indexer</span> <span class=o>=</span> <span class=n>Indexer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>vectors</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=c1># Make position 0 a PAD token, which can be useful if you</span>
</span></span><span class=line><span class=cl>    <span class=n>word_indexer</span><span class=o>.</span><span class=n>add_and_get_index</span><span class=p>(</span><span class=s2>&#34;PAD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Make position 1 the UNK token</span>
</span></span><span class=line><span class=cl>    <span class=n>word_indexer</span><span class=o>.</span><span class=n>add_and_get_index</span><span class=p>(</span><span class=s2>&#34;UNK&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=o>!=</span> <span class=s2>&#34;&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>space_idx</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>word</span> <span class=o>=</span> <span class=n>line</span><span class=p>[:</span><span class=n>space_idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>numbers</span> <span class=o>=</span> <span class=n>line</span><span class=p>[</span><span class=n>space_idx</span><span class=o>+</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=n>float_numbers</span> <span class=o>=</span> <span class=p>[</span><span class=nb>float</span><span class=p>(</span><span class=n>number_str</span><span class=p>)</span> <span class=k>for</span> <span class=n>number_str</span> <span class=ow>in</span> <span class=n>numbers</span><span class=o>.</span><span class=n>split</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>            <span class=n>vector</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>float_numbers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>word_indexer</span><span class=o>.</span><span class=n>add_and_get_index</span><span class=p>(</span><span class=n>word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># Append the PAD and UNK vectors to start. Have to do this weirdly because we need to read the first line</span>
</span></span><span class=line><span class=cl>            <span class=c1># of the file to see what the embedding dim is</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>vectors</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>vectors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>vector</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>vectors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>vector</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=n>vectors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>vector</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Read in &#34;</span> <span class=o>+</span> <span class=nb>repr</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>word_indexer</span><span class=p>))</span> <span class=o>+</span> <span class=s2>&#34; vectors of size &#34;</span> <span class=o>+</span> <span class=nb>repr</span><span class=p>(</span><span class=n>vectors</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=c1># Turn vectors into a 2-D numpy array</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>word_indexer</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>vectors</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>word_indexer</span><span class=p>,</span> <span class=n>embeddings</span> <span class=o>=</span> <span class=n>read_word_embeddings</span><span class=p>(</span><span class=s1>&#39;glove/glove.6B.50d-relativized.txt&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Read in 14923 vectors of size 50
</code></pre><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>2.2 |</span></b> Embedding Concatenation</b></p></div><ul><li><code>get_embedding</code> is a functon defined to obtain the embedding for any product category, meant to deal with multiple words describing any category</li><li>Two ways of dealing with multi-word properties of product categories are included:<ul><li><code>mean</code> where the mean of embedding values for each word in the the GloVe-50d dictionary is found, for each word across all 50 dimensions</li><li><code>sum</code> where the sum of embedding values for each word in the GloVe-50d dictionary is found, for each word, summed across all 50 dimensions</li></ul></li><li>The embedding for each product category is returned based on the previously determined methodology for word handling</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_embedding</span><span class=p>(</span><span class=n>word_indexer</span><span class=p>,</span> <span class=n>embeddings</span><span class=p>,</span> <span class=n>product_categories</span><span class=p>,</span> <span class=n>reduce</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        @param word_indexer returns the index of the word in the embedding
</span></span></span><span class=line><span class=cl><span class=s2>        @param embeddings the embeddings matrix of all words in GloVe-50d
</span></span></span><span class=line><span class=cl><span class=s2>        @param product_categories the categories of all products represented in a [N x 1] array
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>category_embeddings</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>category_list</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>product_categories</span><span class=p>,</span> <span class=n>product_categories_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>category_embed</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>category_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>index_word</span> <span class=o>=</span> <span class=n>word_indexer</span><span class=o>.</span><span class=n>index_of</span><span class=p>(</span><span class=n>word</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>embed</span> <span class=o>=</span> <span class=n>embeddings</span><span class=p>[</span><span class=n>index_word</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>category_embed</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>embed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>reduce</span> <span class=o>==</span> <span class=s1>&#39;mean&#39;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>            <span class=n>embed</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>category_embed</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>reduce</span> <span class=o>==</span> <span class=s1>&#39;sum&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>embed</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>category_embed</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>category_embeddings</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=o>=</span> <span class=n>embed</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>category_embeddings</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>embeddings</span> <span class=o>=</span> <span class=n>get_embedding</span><span class=p>(</span><span class=n>word_indexer</span><span class=p>,</span> <span class=n>embeddings</span><span class=p>,</span> <span class=n>product_categories</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>embeddings</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>{'perfumery': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'artes': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'sport_leisure': array([-6.5777500e-01,  2.3660000e-01, -5.2690000e-01, -1.0300000e-03,
        -3.7766500e-01, -2.4336400e-01,  1.1789000e-01, -2.6644000e-01,
         1.3412000e-02,  2.1341800e-01,  5.8577000e-01,  6.4220000e-02,
        -8.8555000e-02,  1.7286500e-01,  2.5672500e-01, -3.4311500e-01,
         2.7832000e-01,  1.2754050e+00,  1.1235000e-02, -8.0732000e-01,
        -6.4122500e-01,  1.1676450e-01, -2.9102100e-01,  4.8428000e-01,
         1.5141000e-01, -1.3723500e-01, -6.3680000e-01,  3.7784500e-01,
         1.5137115e-01,  3.4792000e-01,  5.6390000e-01,  6.3726550e-01,
        -2.4579550e-01, -9.4106500e-02, -2.6462000e-01,  4.5140000e-01,
        -4.5003500e-02,  1.4046500e-01, -5.2468500e-01, -2.7534950e-01,
         1.5362100e-01, -5.9103000e-01,  6.8940000e-02,  4.5214500e-01,
         2.8340550e-01, -3.7257450e-01, -1.5898500e-01,  2.5181000e-01,
         5.0931500e-01, -1.2091640e-01]),
 'babies': array([ 0.69898 , -0.056312,  0.34178 , -1.4674  ,  0.54603 ,  1.7752  ,
        -0.57618 , -0.60623 ,  0.83499 ,  0.42334 ,  0.50787 , -0.57778 ,
         1.0339  ,  0.27791 ,  1.4515  ,  0.58806 , -0.96275 ,  0.33018 ,
         0.45507 , -0.24377 , -0.15741 ,  0.95016 ,  0.71083 ,  0.23539 ,
         0.66137 , -0.61362 , -0.50664 , -0.24646 ,  0.32122 , -0.50601 ,
         1.5551  ,  1.1833  , -0.19435 ,  0.40841 ,  0.50837 ,  0.11851 ,
         0.82978 , -0.22482 ,  0.84309 , -0.27989 , -1.2027  , -0.50551 ,
         0.49102 ,  0.5024  ,  1.5571  , -0.025314, -0.032675, -0.68783 ,
        -0.072284, -0.22732 ]),
 'domestic_utilities': array([-0.2169885 , -0.259665  , -0.089036  , -0.232085  ,  0.02123   ,
         0.02266   ,  0.303745  , -0.30865   ,  0.304807  ,  0.24873115,
         0.27609   ,  0.182715  ,  0.44881   ,  0.297305  ,  0.20334   ,
        -0.2240425 ,  0.0246    ,  0.3544    ,  0.21105   , -0.38053   ,
         0.289055  , -0.3395355 , -0.114346  , -0.12142   , -0.0075    ,
        -0.118635  ,  0.00909   ,  0.02115   ,  0.324625  ,  0.756815  ,
         1.0631    ,  0.6046155 ,  0.4585545 , -0.0684765 , -0.31949   ,
         0.4114665 , -0.3848335 , -0.1004675 , -0.565625  , -0.2515545 ,
        -0.339595  , -0.245639  ,  0.28604   ,  0.173715  ,  0.44828   ,
        -0.3250159 , -0.2789    ,  0.435085  ,  0.45348   ,  0.0225586 ]),
 'musical instruments': array([-0.06468   ,  0.322055  , -0.963365  , -0.114635  , -0.177675  ,
         0.54965   , -0.1838395 , -0.4549    , -0.64644   ,  1.3871    ,
         0.57586   ,  0.94313   ,  0.151145  ,  1.07977   , -0.49424   ,
        -0.380291  , -0.17956   ,  0.1215325 , -0.297625  , -0.85511   ,
         0.865405  ,  0.562785  , -0.186045  , -0.499275  ,  0.152454  ,
        -0.0582182 , -1.35372   , -0.50429   , -0.154655  , -0.653355  ,
         2.9801    , -0.507645  ,  0.638315  , -0.33097815,  0.5617    ,
         0.35252   ,  0.186936  ,  0.0288775 , -0.228075  ,  0.122783  ,
         0.05871   ,  0.03846   ,  0.147365  , -0.122755  , -0.14569   ,
         0.339465  ,  0.54428   , -0.093315  , -1.1327    ,  0.159625  ]),
 'cool_stuff': array([-4.932950e-01,  2.035540e-01, -8.313395e-02, -4.249600e-01,
         9.794000e-02, -4.397210e-01, -3.272700e-01, -2.336160e-01,
        -3.763900e-01,  6.511450e-01, -5.402300e-01,  3.683300e-01,
        -1.061500e-02,  6.245650e-01,  5.724015e-01,  5.704455e-01,
         3.654400e-01,  4.361400e-01, -1.085555e-01, -1.033350e+00,
        -5.114250e-02,  5.775950e-01,  8.279250e-01,  3.179500e-01,
         4.330600e-01, -8.627450e-01, -8.960600e-01,  1.115915e+00,
         1.720000e+00, -2.354450e-01,  2.476200e+00,  2.326425e-01,
        -7.899500e-03,  1.246350e-01, -1.432040e-01,  5.095900e-01,
        -3.377350e-01,  3.771100e-01,  3.613050e-01, -7.046750e-01,
         1.961800e-01,  3.419200e-01, -9.439450e-02,  3.296600e-01,
         4.638600e-01,  4.373350e-01,  4.684150e-01, -4.642925e-01,
         2.028000e-03,  6.441700e-01]),
 'furniture_decoration': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'home appliances': array([-0.11147   ,  0.160835  ,  0.01424   , -0.297908  ,  0.231035  ,
        -0.46969   , -0.473055  ,  0.333195  , -0.0387957 ,  0.258926  ,
        -0.216425  , -0.15653   ,  0.26442   ,  0.047085  ,  0.04186   ,
        -0.221237  ,  0.024125  ,  0.23801655,  0.0201    ,  0.02417   ,
        -0.166215  ,  0.2318245 , -0.276051  ,  0.153675  ,  0.016345  ,
        -0.324785  , -0.048915  ,  0.14006   ,  0.401985  , -0.12704   ,
         1.02255   ,  0.4103305 ,  0.1114745 ,  0.024657  ,  0.09831   ,
         0.6256    ,  0.1077315 ,  0.135195  ,  0.085595  , -0.2381195 ,
         0.013745  , -0.16949   , -0.228925  ,  0.31469   ,  0.319578  ,
        -0.04022   , -0.16518   , -0.316485  ,  0.24828   , -0.0955514 ]),
 'toys': array([ 0.11738 , -0.78864 ,  0.20307 ,  0.40609 ,  0.53572 ,  0.66853 ,
        -1.0303  , -2.0666  ,  0.67746 ,  0.41301 , -0.036541,  0.57572 ,
         0.2052  , -0.13067 ,  1.1972  ,  0.69488 , -0.7459  ,  1.0515  ,
         0.22374 , -1.0436  ,  1.1563  ,  0.12272 , -0.091888, -0.070431,
        -0.35183 , -0.37046 , -1.4255  , -0.078561,  0.716   , -1.3362  ,
         1.3186  ,  0.995   ,  0.52411 ,  0.38252 ,  0.73561 ,  1.1922  ,
         0.30399 , -0.19526 , -0.036646, -0.48951 , -0.36473 ,  0.2109  ,
         0.16709 ,  0.18673 ,  1.3641  ,  1.1111  , -0.17835 , -0.31437 ,
         0.12497 , -0.14976 ]),
 'bed table bath': array([ 0.121282  ,  1.07551   , -0.50220667, -0.33427333,  0.37935   ,
        -0.153277  , -0.141247  ,  0.02063833, -0.05749   , -0.60773667,
        -0.4423    ,  0.2403    , -0.190591  ,  0.27271   ,  0.21277667,
         0.86095667,  0.09901333,  0.06610467, -0.13987933, -0.73049667,
         0.68601   ,  0.55938333,  0.48579333,  0.25348   , -0.37527667,
        -0.423359  , -0.130161  ,  0.77310667,  0.42638333,  0.09753433,
         2.26126667,  0.27597467, -0.23237503,  0.67459667,  0.37090333,
         0.82384333,  0.57042   ,  0.48660667,  0.932469  , -0.33592333,
         0.46510333, -0.20701167, -0.30365333,  0.71547   ,  0.31835667,
         0.42810333,  0.18425667, -1.03925233,  0.38622333, -0.54126   ]),
 'construction_tools_security': array([ 0.50816667, -0.15552927,  0.61994   ,  0.21229467, -0.02190367,
        -0.32106667, -0.30894   , -0.80907333,  0.16325333, -0.592376  ,
        -0.16282   , -0.10930333, -0.347921  , -0.05749967, -0.32407333,
         0.31827333,  0.13833333,  0.25797333,  0.58916667, -0.494492  ,
         0.94635   , -0.05304667, -0.88858   , -0.78261   , -0.048928  ,
        -1.00035333,  0.02441667, -0.399411  ,  0.35588333,  0.09051667,
         3.3164    , -0.50588333, -0.39591667, -0.65001233,  0.01619   ,
         0.8768    ,  0.254316  ,  0.20291667, -0.09791267,  0.423946  ,
        -0.13481333, -0.37350333,  0.4858    ,  0.20931667,  0.53948267,
        -0.29450233, -0.04733667,  0.60774667,  0.18903   , -0.15894333]),
 'informatica_accessories': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'beauty_health': array([ 0.149462 ,  0.837515 , -0.658989 ,  0.11762  ,  0.156495 ,
         0.311425 , -0.2985085, -0.72018  ,  1.114425 ,  0.224965 ,
         0.18148  , -0.1437515,  0.36231  , -0.316605 ,  0.29906  ,
         0.187535 , -0.318833 ,  0.19092  ,  0.534318 , -0.15734  ,
        -0.095259 ,  1.056855 , -0.295065 , -0.079285 ,  0.14422  ,
        -1.22806  , -1.06188  , -0.15872  , -0.05257  ,  0.38244  ,
         2.6115   ,  0.681295 , -0.01553  , -0.803845 , -0.079915 ,
         0.240563 , -0.286601 ,  0.450905 ,  0.700525 , -0.472489 ,
        -0.326875 ,  0.212085 ,  0.4923   ,  0.25222  ,  0.270245 ,
         0.37235  , -0.448995 , -0.188735 ,  0.56276  ,  0.34234  ]),
 'bags_accessories': array([-0.09753  , -0.21828  ,  0.39673  , -0.541435 ,  0.28565  ,
        -0.250009 ,  0.16389  , -0.432615 ,  0.587842 , -0.11338  ,
         0.13238  ,  0.034195 ,  0.52179  ,  0.371215 ,  0.406465 ,
         0.015975 , -0.30545  ,  0.43989  ,  0.361695 , -1.02972  ,
         0.11384  , -0.02404  ,  0.438889 , -0.109875 , -0.292865 ,
         0.148435 , -0.41799  ,  0.785775 ,  0.695215 , -0.208865 ,
         0.1957   ,  0.6654155, -0.2863305,  0.4026785,  0.102555 ,
         1.22624  ,  0.2838865,  0.30733  ,  0.079865 ,  0.0776355,
         0.35376  ,  0.099455 ,  0.17175  ,  0.439675 ,  0.51477  ,
        -0.338477 , -0.051525 , -0.07325  ,  0.385935 , -0.5949414]),
 'garden_tools': array([-0.13122  , -0.45077  ,  0.20832  , -0.15525  , -0.0177905,
        -0.273765 ,  0.207975 , -0.589265 ,  0.100587 ,  0.265581 ,
         0.0123335,  0.303705 ,  0.4274135,  0.2284005, -0.441685 ,
        -0.167755 ,  0.30533  ,  0.4014   ,  0.67399  , -0.67052  ,
         0.135475 , -0.0920255, -0.201911 , -0.296385 ,  0.375905 ,
         0.38115  , -0.546515 , -0.447175 ,  0.41337  , -0.095075 ,
         0.8753   , -0.3589695, -0.2505255, -0.3293365, -0.10512  ,
         1.16314  , -0.0027195,  0.341125 , -0.140954 , -0.0208605,
         0.459025 , -0.554825 , -0.05076  ,  0.85532  ,  1.007625 ,
        -0.3457835,  0.583475 ,  0.42408  ,  0.202085 , -0.1239964]),
 'furniture_office': array([-0.100575  , -0.0411355 ,  0.043105  , -0.209865  ,  0.18825   ,
        -0.59084   ,  0.02806   , -0.02936   , -0.0272195 , -0.39515   ,
        -0.306055  , -0.054165  ,  0.205645  ,  0.2346751 ,  0.092645  ,
        -0.11909   , -0.277255  ,  0.274721  ,  0.58935   , -0.1465255 ,
         0.294605  ,  0.0838895 , -0.231836  , -0.210795  , -0.24414   ,
        -0.562935  , -0.1818305 ,  0.36765   , -0.19358   ,  0.27433   ,
         0.8427    , -0.0921145 , -0.2660805 , -0.5448265 , -0.340315  ,
         0.51402   ,  0.2321565 ,  0.036925  ,  0.131865  , -0.1284995 ,
        -0.039955  ,  0.025175  , -0.247405  ,  0.25581025, -0.044475  ,
        -0.40652   , -0.442715  ,  0.0650475 ,  0.508945  ,  0.2105486 ]),
 'automotive': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'electronic': array([-6.6594e-01, -6.5510e-01,  9.2148e-01,  6.8301e-01, -4.7822e-01,
        -2.8030e-01, -5.3848e-01, -1.0404e+00,  8.6666e-01,  9.4106e-01,
         6.8266e-01,  1.6785e-01,  2.7838e-01,  1.1826e+00, -4.1586e-01,
        -5.3318e-02, -1.2734e+00, -2.2728e-01,  8.7516e-02, -9.1505e-01,
         1.7087e+00, -1.1551e-01, -7.6449e-01,  2.7068e-02, -2.9328e-02,
        -7.2308e-01, -7.4972e-01, -7.2909e-01,  4.0463e-01, -5.0634e-01,
         2.9845e+00, -5.8706e-01,  3.0288e-01, -5.0952e-01, -3.2629e-01,
         4.3184e-01,  2.9218e-01, -2.9649e-01, -1.7555e-03,  1.2518e-01,
         1.0972e+00,  1.6128e-01,  2.2262e-01,  6.7454e-01,  1.5689e-01,
         2.6961e-01,  7.8616e-01,  3.6450e-01, -4.2447e-01, -5.8735e-02]),
 'fashion_shoes': array([-0.529271  ,  0.187405  , -0.706595  , -0.150854  ,  0.257785  ,
        -0.062465  , -0.64265   , -1.31045   ,  0.1302085 ,  0.121555  ,
         0.15193675, -0.2591685 , -0.87015   ,  0.13515   ,  0.622815  ,
         0.30194   , -0.52321   ,  0.184355  ,  0.289615  , -1.27407   ,
         0.267221  ,  0.79496   , -0.58884   ,  0.123875  , -0.49169   ,
        -0.965705  , -1.28342   ,  0.82245   ,  0.54177   , -0.765955  ,
         1.8377    ,  0.77242   ,  0.12483   ,  0.23106   , -0.020515  ,
         0.487787  , -0.031645  ,  0.97589   , -0.577765  , -0.24196   ,
         0.33837   ,  0.358545  ,  0.41685   ,  0.10506   ,  0.753915  ,
        -0.498315  ,  0.04316   , -0.85085   ,  0.0436    ,  0.16844   ]),
 'telephony': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'stationary store': array([ 0.431825 , -0.159595 ,  0.7213   ,  0.0359543,  0.5905305,
        -0.276996 , -0.849492 , -0.3911   ,  0.629875 , -0.1776875,
         0.5078325, -0.59475  , -0.20207  ,  0.137035 ,  0.00635  ,
         0.40943  , -0.61595  ,  0.677255 , -0.25467  , -1.192875 ,
         0.8558665, -0.411145 , -0.565025 ,  0.826405 , -0.09058  ,
        -0.349225 , -0.38166  ,  0.59205  ,  1.1161   , -0.07926  ,
         1.7939   , -0.210345 ,  0.169255 , -0.096005 ,  0.29153  ,
         0.1508485,  0.194135 ,  0.55134  ,  0.201635 ,  0.543336 ,
         0.490335 , -0.2112085, -0.356055 ,  0.361025 , -0.00265  ,
        -0.22146  ,  0.32249  , -0.780135 ,  0.39682  , -0.009155 ]),
 'fashion_bolsas_e_acessorios': array([-0.3612355 , -0.0531225 , -0.496455  , -0.4822595 , -0.00221   ,
        -0.3775225 ,  0.4505125 , -0.1233975 , -0.08142025,  0.5212425 ,
         0.06148088,  0.0285875 ,  0.3185425 ,  0.4761475 , -0.11933   ,
        -0.41105   ,  0.146635  ,  0.276585  ,  0.4649475 , -0.38809   ,
        -0.2147625 ,  0.12867925, -0.1729265 ,  0.103575  ,  0.078905  ,
         0.530345  , -0.7632925 ,  0.3161625 ,  0.29196   ,  0.237145  ,
        -0.360725  ,  0.17938325,  0.11933925, -0.11785975, -0.3642725 ,
         0.566631  , -0.04145275,  0.16126   , -0.4949825 , -0.13645425,
         0.2658775 , -0.3131925 , -0.1265925 ,  0.33689   ,  0.6194475 ,
        -0.5635775 ,  0.15796   , -0.0090975 ,  0.30098   ,  0.2050404 ]),
 'pcs': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'house_construction': array([ 0.70555   ,  0.293185  ,  0.179376  , -0.08316   ,  0.05319   ,
         0.189115  , -0.89585   , -0.2394795 , -0.44347   , -0.729345  ,
        -0.9164635 , -0.29398   , -0.1271705 , -0.20140725, -0.0930295 ,
         0.31127   ,  0.028011  ,  0.237485  ,  0.254165  , -0.539355  ,
         1.42785   , -0.197095  , -1.077485  , -0.758905  , -0.204447  ,
        -1.257615  , -0.097675  ,  0.124841  , -0.017775  ,  0.153878  ,
         3.13085   , -0.98483   , -0.22145   , -0.2723735 ,  0.171395  ,
         0.0940355 ,  0.41796   ,  0.220105  ,  0.33042   ,  0.07027   ,
        -0.579885  , -0.345695  , -0.00575   , -0.055565  ,  0.007649  ,
         0.01957   , -0.75081   , -0.545575  ,  0.154991  , -0.043825  ]),
 'watches_gifts': array([ 0.13938  ,  0.490805 , -0.10947  ,  0.016295 ,  0.826165 ,
        -0.07303  , -0.56479  , -0.260535 ,  0.559345 ,  0.360701 ,
        -0.179925 ,  0.609995 ,  0.801685 , -0.12088  ,  1.1018   ,
         0.113595 , -0.871335 ,  0.008045 ,  0.19502  , -0.88376  ,
         0.995565 ,  0.2234605, -0.1203995, -0.45073  ,  0.03505  ,
        -0.87461  , -0.81466  , -0.01929  ,  0.48275  , -0.923825 ,
         1.1388   ,  1.145715 ,  0.375925 ,  0.1000245,  0.015275 ,
         0.761995 , -0.1934265,  0.38571  , -0.425525 , -0.185705 ,
         0.298155 ,  0.665945 ,  0.1537   ,  0.508755 ,  0.110155 ,
        -0.35469  , -0.365415 , -0.245515 , -0.395905 , -0.26568  ]),
 'construction_tools_construction': array([ 6.04326667e-01, -5.40133333e-02,  4.78586667e-01,  2.83800000e-01,
        -4.04690333e-01,  3.73033333e-02, -6.85740000e-01, -8.43093333e-01,
        -1.14010000e-01, -1.70072667e-01, -7.47566667e-03, -1.00790000e-01,
        -1.81647667e-01, -2.78849667e-01, -3.55140000e-01,  2.03773333e-01,
         1.87083333e-01,  5.66763333e-01,  3.55830000e-01, -6.04233333e-01,
         1.33764667e+00, -5.36506667e-01, -1.31845000e+00, -1.02777667e+00,
         1.58164000e-01, -5.60030000e-01, -8.85000000e-02, -4.28098667e-01,
         4.28930000e-01,  8.98000000e-03,  3.32730000e+00, -9.14663333e-01,
        -2.63333333e-04, -2.79684667e-01,  9.72200000e-02,  7.08906667e-01,
         3.31869333e-01,  6.13723333e-01,  2.10327333e-01,  5.75602667e-01,
        -2.77223333e-01, -8.02490000e-01,  3.61586667e-01,  2.26533333e-01,
         4.81825333e-01, -3.60482333e-01, -7.28600000e-02,  1.81796667e-01,
         2.17276667e-01, -2.75956667e-01]),
 'pet_shop': array([ 0.383305  , -0.22558   , -0.1947675 , -0.02225955,  0.552615  ,
         0.13605   , -1.42445   , -0.9175    ,  0.82867   ,  0.1530525 ,
        -0.018925  ,  0.265945  ,  0.60104   ,  0.45376   ,  0.504435  ,
         0.33318   , -0.437065  ,  0.640445  ,  0.09386   , -0.64959   ,
         0.901288  ,  0.2274495 , -0.5736005 ,  0.627565  , -0.20507   ,
        -1.05225   , -0.846905  ,  0.1250828 ,  0.569395  , -0.734295  ,
         1.6631    ,  0.17512   , -0.3570085 ,  0.62313   ,  0.11078   ,
         0.520045  ,  0.22995   ,  0.216055  ,  0.75598   , -0.06704   ,
         0.154995  ,  0.1381225 , -0.166715  ,  0.671815  ,  1.207155  ,
         0.16389   , -0.39704   , -0.644335  ,  0.89743   ,  0.186325  ]),
 'small appliances': array([ 3.4297000e-01,  3.9515000e-02, -8.8830000e-02, -4.2744500e-01,
         3.0806500e-01,  6.3250000e-02, -6.7200000e-03, -1.9590000e-02,
        -5.8000000e-05, -2.2235000e-02, -4.0970000e-02, -8.0975000e-02,
         8.6283000e-01,  3.9184500e-01, -4.4992500e-01, -2.5332900e-01,
         4.1254000e-01,  5.3558000e-01,  4.9550000e-03, -6.7982000e-01,
        -1.7003000e-01, -3.7142050e-01, -4.6756000e-02,  1.7112500e-01,
        -8.8070000e-02, -7.2185000e-02, -4.1208000e-01,  4.2770500e-01,
         3.4677500e-01,  4.9295000e-02,  1.3307000e+00, -1.2948950e-01,
         2.0801950e-01,  4.3545000e-02, -9.2545000e-02,  6.1857500e-01,
        -1.7431850e-01,  8.0300000e-03, -1.1555500e-01, -6.6786000e-02,
         1.0083015e-01, -1.8001000e-01, -1.2839150e-01,  4.0629500e-01,
         5.5394500e-01, -3.2650805e-01, -1.0066500e-01, -2.3265000e-01,
         1.1707450e-01, -2.2713140e-01]),
 'agro_industry_and_trade': array([-3.6232000e-01, -1.6120825e-01, -3.0137925e-01,  2.7522175e-01,
         3.0500000e-04, -1.9281200e-02, -4.3572750e-01, -5.8117250e-01,
         1.4762350e-01,  1.8315050e-01,  2.2254500e-01,  3.1581500e-01,
        -2.4672750e-02,  2.6693750e-01,  1.0409750e-01, -8.1837500e-03,
         2.3921475e-01,  2.3425000e-02,  3.2642500e-01, -4.5122400e-01,
         6.0444750e-01, -1.7562525e-01, -1.8230300e-01, -3.1608150e-01,
        -1.7505000e-02, -7.9666750e-01, -2.9927500e-02, -6.0552500e-02,
         2.2260000e-01,  1.8546000e-01,  2.4350500e+00,  1.0978275e-01,
         2.2210275e-01, -6.2197750e-02, -4.0215250e-01, -5.1220000e-02,
        -5.3526675e-01,  1.9079650e-01, -7.6040000e-02,  2.1851750e-01,
        -4.5848575e-01, -3.6085000e-02,  3.8913000e-01, -5.1767000e-02,
         4.7119500e-01, -4.3097500e-02, -4.2938000e-01,  2.7493000e-01,
         1.1408500e-01, -5.4280700e-02]),
 'in': array([ 0.33042  ,  0.24995  , -0.60874  ,  0.10923  ,  0.036372 ,
         0.151    , -0.55083  , -0.074239 , -0.092307 , -0.32821  ,
         0.09598  , -0.82269  , -0.36717  , -0.67009  ,  0.42909  ,
         0.016496 , -0.23573  ,  0.12864  , -1.0953   ,  0.43334  ,
         0.57067  , -0.1036   ,  0.20422  ,  0.078308 , -0.42795  ,
        -1.7984   , -0.27865  ,  0.11954  , -0.12689  ,  0.031744 ,
         3.8631   , -0.17786  , -0.082434 , -0.62698  ,  0.26497  ,
        -0.057185 , -0.073521 ,  0.46103  ,  0.30862  ,  0.12498  ,
        -0.48609  , -0.0080272,  0.031184 , -0.36576  , -0.42699  ,
         0.42164  , -0.11666  , -0.50703  , -0.027273 , -0.53285  ]),
 'living room furniture': array([ 1.67513333e-01,  4.02106667e-01, -7.22100000e-02, -7.26840000e-01,
         7.17410000e-01, -2.41123333e-01, -2.67453333e-01, -2.62083333e-01,
        -1.82842000e-01,  8.89833333e-02, -1.13746667e-01, -2.46113333e-01,
         6.51142667e-01,  3.34633333e-01,  4.22633333e-01,  1.46620000e-01,
         1.24803333e-01,  3.68426667e-01,  2.28036667e-01, -2.87353333e-01,
         3.40700000e-02,  7.51323000e-01, -1.59634000e-01,  8.91543333e-02,
         2.33490000e-01, -2.35480000e-01, -3.49280000e-01,  2.41256667e-01,
         4.24886667e-01,  3.46933333e-02,  1.59026667e+00,  2.18807000e-01,
        -4.28693333e-02, -3.34637667e-01, -3.76666667e-04,  6.62646667e-01,
         2.05654333e-01,  3.62533333e-02,  3.48250000e-01, -2.08463000e-01,
        -1.81054000e-01, -8.17216667e-02,  1.29733333e-01,  6.26040000e-01,
         1.02564667e-01, -1.90523333e-01, -1.45210000e-01, -6.81410000e-01,
         9.24056667e-02, -1.19250933e-01]),
 'signaling_and_security': array([ 1.11156667e-01,  9.64066667e-04,  9.95133333e-02, -1.89446333e-01,
         1.71883333e-01, -2.29106667e-01,  2.11993333e-01, -2.31163333e-01,
         3.70213333e-02, -3.91980000e-01, -3.18066667e-02,  5.87833333e-02,
        -1.59613333e-01,  1.03470000e-01, -1.95366667e-01,  2.85850000e-02,
         1.07656333e-01,  1.13783333e-01,  3.79966667e-01, -2.66565333e-01,
         1.08866667e-01,  3.58706333e-01,  3.67493333e-02, -2.50102000e-01,
        -1.60673333e-01, -8.17556667e-01,  2.05733333e-02,  3.56850000e-02,
         1.54873000e-01,  1.41806667e-01,  2.04663333e+00,  2.11610333e-01,
        -2.49500333e-01, -5.60964333e-01, -7.81233333e-02,  6.12480000e-01,
         1.91433333e-03, -1.82360000e-01, -3.06660000e-01,  2.23910333e-01,
        -6.81943333e-02,  6.15733333e-02,  2.96260000e-01, -1.25100000e-02,
         3.70623333e-01, -2.83243333e-01, -2.56300000e-01,  2.52823333e-01,
         7.58333333e-02, -1.04514267e-01]),
 'air conditioning': array([ 0.08439  ,  0.046005 ,  0.26098  , -0.27408  , -0.793375 ,
        -0.803605 , -0.1245665,  0.010855 ,  0.4847655, -0.353585 ,
         0.91126  ,  0.1183835, -0.063325 ,  0.872935 , -0.636735 ,
         0.54369  , -0.73477  ,  0.976155 , -0.937524 , -1.147215 ,
         0.059735 ,  0.38916  , -0.273395 , -0.6447   , -0.405955 ,
        -1.05922  , -0.005155 ,  0.604635 ,  1.055195 ,  0.8969   ,
         2.568    ,  0.68065  , -0.350425 , -0.405875 ,  0.188045 ,
         0.6840155,  0.685145 ,  0.197325 ,  0.460865 ,  0.616075 ,
         0.3456   ,  0.371473 ,  0.03534  ,  0.30622  , -0.018955 ,
         0.251155 ,  0.197905 ,  0.02026  , -0.889225 ,  0.85391  ]),
 'consoles_games': array([-0.670455  ,  0.318735  , -0.084189  ,  0.50554   , -0.189155  ,
        -0.334235  , -0.06092   , -0.120755  , -0.273838  ,  0.441805  ,
         0.054707  ,  0.018565  , -0.313205  ,  0.294875  ,  0.529165  ,
        -0.654975  ,  0.08529   ,  0.45546   , -0.714095  , -0.091431  ,
        -0.54849   , -0.1767905 ,  0.284039  ,  0.01622   ,  0.148317  ,
         0.132665  , -0.079865  , -0.1243    ,  0.354785  , -0.435235  ,
         1.04355   ,  0.8325155 ,  0.0698745 , -0.1962215 , -0.136555  ,
         0.71047   ,  0.4870315 ,  0.3173    , -0.665315  , -0.1829195 ,
        -0.135135  , -0.66811   , -0.17432   ,  0.580815  ,  0.115815  ,
         0.16498   ,  0.0049695 ,  0.1625    ,  0.14231545, -0.0138379 ]),
 'general_interest_books': array([-0.13378667,  0.40633   , -0.180478  , -0.32258   ,  0.57698667,
        -0.15125333, -0.81235333, -0.78724667, -0.17347333, -0.18801   ,
        -0.10828667,  0.84404333, -0.32388033, -0.50571   ,  0.66861067,
        -0.10638333, -0.25498667, -0.40634   ,  0.00961433, -0.27365133,
         0.75540633, -0.20779667,  0.14485397, -0.28896333, -0.15458667,
        -1.32330667, -0.607391  , -0.59106667, -0.26451667,  0.41909667,
         2.96093333, -0.07119   ,  0.06087667, -0.59353333, -0.0925    ,
        -0.23531667, -0.59946833,  0.08378333,  0.00778733, -0.10507333,
         0.04876   ,  0.14108   ,  0.00764667,  0.14884   , -0.19461133,
         0.05654733, -0.11801333,  0.47503367, -0.10037333,  0.214126  ]),
 'construction_tools_tools': array([ 0.39892333, -0.40918667,  0.56638333,  0.30366   , -0.16770067,
        -0.04139333, -0.55339   , -1.12864667,  0.08304   , -0.06945533,
        -0.03272433,  0.13751   , -0.05340533, -0.14626933, -0.45627   ,
         0.19054667,  0.24414667,  0.44537667,  0.575     , -0.84766667,
         1.04299333, -0.32336333, -0.8973    , -0.75705333,  0.328612  ,
        -0.38793   , -0.39672   , -0.81054933,  0.48087   , -0.2697    ,
         3.1354    , -0.85226667, -0.26795667, -0.48275233,  0.1343    ,
         1.15210333,  0.13191867,  0.72079667,  0.15491467,  0.30319533,
         0.21638333, -0.68201   ,  0.23959333,  0.71031667,  0.92521267,
        -0.19621467,  0.49402   ,  0.42694333,  0.16449333, -0.26408333]),
 'fashion_underwear_e_moda_praia': array([-0.4035864 , -0.074576  , -0.418086  , -0.3687174 ,  0.05163   ,
        -0.194718  ,  0.3565326 , -0.331838  ,  0.0718638 ,  0.35747   ,
         0.1141707 , -0.073368  ,  0.101738  ,  0.3884804 ,  0.048456  ,
        -0.15035   , -0.142352  ,  0.329326  ,  0.495374  , -0.508146  ,
        -0.11091   ,  0.2938714 , -0.0429112 ,  0.08110864, -0.133962  ,
         0.190236  , -0.884034  ,  0.48503   ,  0.476228  ,  0.004268  ,
        -0.240858  ,  0.2754786 , -0.0439746 , -0.0122178 , -0.208024  ,
         0.6074088 , -0.04877   ,  0.298082  , -0.523692  , -0.1423354 ,
         0.27784   , -0.189706  , -0.001552  ,  0.313756  ,  0.645318  ,
        -0.640938  ,  0.166912  , -0.243998  ,  0.271598  ,  0.07568232]),
 'fashion_clothes_men': array([-0.20766067,  0.18115   , -0.58055   , -0.36946267,  0.71611   ,
        -0.06227667, -0.480974  , -0.56409   , -0.18878433, -0.17501   ,
         0.1055745 , -0.55299   , -0.601128  , -0.04001   ,  0.75262667,
         0.03583333, -0.38519333,  0.06401   ,  0.00884333, -1.02360333,
         0.10532333,  1.05513667, -0.07654333,  0.40878733, -0.4867    ,
        -1.12438667, -1.28289333,  0.28985667,  0.52306667, -0.48607333,
         2.29503333,  0.7971    , -0.01128033, -0.1677    ,  0.21522667,
         0.67615133, -0.14004467,  0.78054667, -0.49585867, -0.15393933,
         0.16505333,  0.25155667,  0.61591   ,  0.17914333,  0.84348333,
        -0.51744   , -0.09429   , -0.87343   ,  0.09008   , -0.10341667]),
 'furniture_cozinha_area_de_servico_jantar_e_jardim': array([-0.12591   ,  0.05804125, -0.3714275 , -0.45058238, -0.17667313,
        -0.6250375 ,  0.4318925 ,  0.2268    , -0.097417  ,  0.32719125,
         0.15450375,  0.0841875 ,  0.55648   ,  0.065975  , -0.3158175 ,
        -0.53394125,  0.372565  ,  0.294245  ,  0.2417575 , -0.24151   ,
        -0.4950775 , -0.04474862,  0.01052183,  0.04897125,  0.0280925 ,
         0.58375375, -0.39934212,  0.327625  ,  0.249945  ,  0.282065  ,
        -0.1091875 , -0.13682175, -0.11248325, -0.11242225, -0.23426225,
         0.45630125,  0.04041513, -0.06066375, -0.14173625,  0.15078825,
         0.22956875, -0.37743613,  0.01378625,  0.17155463,  0.274235  ,
        -0.62712375, -0.06439375, -0.1451625 ,  0.444225  ,  0.0523804 ]),
 'industry_comercio_e_nocios': array([-0.4742575 , -0.2723675 , -0.17437425, -0.232995  , -0.17193   ,
        -0.3223387 ,  0.3587175 , -0.0484675 ,  0.1350155 ,  0.4752125 ,
         0.1572025 ,  0.245885  ,  0.56979725,  0.47852   , -0.156155  ,
        -0.3005925 ,  0.3090825 ,  0.508665  ,  0.55089   , -0.430885  ,
         0.0197325 , -0.15864075, -0.1362815 , -0.1735025 ,  0.1958575 ,
         0.3657475 , -0.5008075 ,  0.1346775 ,  0.21376025,  0.449445  ,
        -0.014425  ,  0.00752575,  0.19361925,  0.00729575, -0.4523525 ,
         0.47392   , -0.19727275,  0.0138125 , -0.153285  , -0.0763395 ,
        -0.05682   , -0.3689725 , -0.0889    ,  0.383123  ,  0.659645  ,
        -0.4358525 , -0.1451525 ,  0.265465  ,  0.2715725 ,  0.0709879 ]),
 'fixed_telephony': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'construction_tools_lighting': array([ 0.30365733,  0.00852667,  0.36363   ,  0.37041   , -0.29092033,
        -0.04499667, -0.4140118 , -0.97149   , -0.06964   ,  0.04465067,
         0.05495333,  0.05082   , -0.008051  ,  0.047657  , -0.418     ,
         0.39159333,  0.00890667,  0.47169667,  0.20268333, -1.24886667,
         1.15448   , -0.11887333, -1.19068333, -0.97411   ,  0.31914867,
        -0.21629   , -0.15260933, -0.24001267,  0.53057333, -0.04279667,
         2.76066667, -0.49853   , -0.02294667, -0.74371233,  0.14017333,
         0.99637   ,  0.548296  ,  0.54722667,  0.100202  ,  0.48748933,
         0.07836   , -0.18947333,  0.11410333,  0.17226   ,  0.608706  ,
         0.02270767,  0.18668   , -0.13145333,  0.158199  , -0.04822   ]),
 'technical books': array([-2.20985000e-01,  4.93455000e-01, -3.43250000e-01, -1.47600000e-01,
        -7.72650000e-02, -9.70300000e-02, -8.05691500e-01, -1.00974850e+00,
         3.13295000e-01, -1.28325000e-01, -2.65610000e-01,  6.45660000e-01,
        -4.74145000e-01, -3.70350000e-01,  5.73275000e-01, -5.05310000e-01,
        -1.77599000e-01,  1.46670000e-01,  4.35085000e-02, -3.87222000e-01,
         9.94990000e-01,  3.77935000e-01,  7.48250000e-02,  1.97150000e-02,
         3.08385000e-01, -8.35975000e-01, -8.93880000e-01, -6.85165000e-01,
        -4.81370000e-01, -3.36228500e-01,  2.91340000e+00, -2.76622000e-01,
         1.77985000e-01, -7.18230000e-01,  1.30545000e-01,  6.03460000e-01,
        -2.49035000e-01,  5.51365000e-01, -1.67550000e-02, -9.80000000e-04,
         5.29630000e-01, -2.27780000e-01,  3.84375000e-01,  5.08770000e-01,
        -3.15765000e-01,  3.01746115e-01,  5.93825000e-01,  9.88415500e-01,
        -2.95853500e-01, -1.96015000e-01]),
 'party_articles': array([-0.50433   , -0.16026   ,  0.08696   , -0.22346   ,  0.109395  ,
         0.193285  ,  0.289325  ,  0.0988395 , -0.684108  , -0.096955  ,
        -0.1763    , -0.306285  ,  0.168245  ,  0.644075  , -0.37435   ,
        -0.38551   ,  0.26593   ,  0.116915  ,  0.65119   , -0.21915   ,
        -0.342685  , -0.0917405 ,  0.251419  ,  0.121205  ,  0.12872515,
        -0.447035  , -0.42251   , -0.14577   , -0.392985  ,  0.62462   ,
         1.04885   ,  0.3406255 , -0.9024005 ,  0.012877  , -0.79521   ,
         0.09429   , -0.0706935 , -0.078135  , -0.42978   , -0.2156945 ,
        -0.113035  , -0.219345  , -0.87891   ,  0.20523   ,  0.17079   ,
        -0.3291111 , -0.913575  , -0.126415  ,  0.65498   , -0.2975464 ]),
 'drinks': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'market_place': array([ 1.5284535e-01, -8.0640000e-02, -6.7710000e-02,  2.7467000e-01,
         6.2887500e-01, -6.9731500e-01, -6.2464500e-01, -2.7357500e-01,
        -9.7784500e-02,  6.8520000e-02,  2.2050000e-03, -2.6884350e-01,
        -5.6717500e-01, -1.5944500e-01,  3.6962000e-01,  7.0226000e-01,
         1.6200000e-01, -2.4915500e-01, -5.9524500e-01, -4.6763500e-01,
         8.5653000e-01, -4.3951000e-01, -3.1289300e-01,  3.6497100e-01,
        -1.9862000e-01, -1.2867500e+00, -2.6297500e-01,  2.3820000e-01,
         5.7564500e-01,  2.6461500e-01,  3.5481000e+00,  3.1361000e-01,
         2.8795500e-01, -7.6710000e-02,  1.5154500e-02, -4.8535000e-01,
        -3.5167500e-01,  5.5790500e-01,  1.2007150e-01, -4.4555500e-01,
        -3.7528550e-01, -2.2686600e-01,  1.4548800e-01, -4.8349500e-02,
         3.1328500e-01,  4.8606000e-01,  9.6989500e-02, -1.3875000e-01,
         6.7078000e-01,  3.5310000e-02]),
 'the kitchen': array([ 0.27307   ,  0.246495  , -0.400945  , -0.135805  ,  0.58728   ,
        -0.1657535 , -0.57513   , -0.295725  , -0.04462861, -0.68539   ,
        -0.274225  ,  0.03947   , -0.123745  ,  0.54466   ,  0.22761025,
         0.166529  , -0.14848   ,  0.341135  , -0.01943   , -0.556735  ,
         0.6389495 ,  0.1451    , -0.31323   ,  0.10856   , -0.060562  ,
        -1.11357   , -0.6186    ,  0.2788255 ,  0.319625  , -0.21072   ,
         3.0315    , -0.15982   , -0.341905  ,  0.0733    ,  0.01488257,
         0.87522245,  0.19482   ,  0.460465  ,  0.7712205 , -0.076811  ,
         0.08112   ,  0.06233   , -0.23312   ,  0.1889415 ,  0.22492   ,
         0.655975  ,  0.09658745, -0.726805  , -0.007195  , -0.299525  ]),
 'construction_tools_garden': array([ 0.18243   , -0.20012667,  0.26914333, -0.01552   , -0.22575367,
        -0.14384333, -0.13404667, -0.57869   , -0.03662867,  0.086824  ,
         0.01414667,  0.08944   ,  0.18164567,  0.01512367, -0.37912667,
        -0.03950333,  0.24689333,  0.49698333,  0.49488   , -0.56728   ,
         0.63441667, -0.31123367, -0.714474  , -0.63042333,  0.24650867,
         0.01005667, -0.29110333, -0.31333267,  0.40124333,  0.03250333,
         1.7566    , -0.56499967, -0.07787367, -0.24509667, -0.05003333,
         0.86399667,  0.17546033,  0.3963    , -0.00538933,  0.268763  ,
         0.04907333, -0.67754   ,  0.12735333,  0.48446333,  0.68456267,
        -0.405439  ,  0.17573667,  0.26160333,  0.22474333, -0.1786076 ]),
 &quot;fashion_women's clothes&quot;: array([-0.22060067, -0.01955333, -0.70562667, -0.516526  ,  0.34408667,
        -0.25464333, -0.19523333, -0.60999667, -0.09070633,  0.28833   ,
         0.0828445 , -0.16442   , -0.07932467,  0.23266333,  0.36181   ,
         0.01922333, -0.32360667,  0.11756333,  0.54914667, -0.87356   ,
         0.17646667,  0.68122633, -0.318074  ,  0.190164  , -0.26547   ,
        -0.20931   , -1.21053   ,  0.58811667,  0.68706   , -0.19505667,
         1.00763333,  0.55689033,  0.12575933, -0.06539433, -0.06026   ,
         0.823288  , -0.14054567,  0.6144    , -0.41369867, -0.147481  ,
         0.31987   ,  0.15638667,  0.19810333,  0.1517    ,  0.71653333,
        -0.50135   ,  0.07344333, -0.50007667,  0.28248667,  0.15063907]),
 'home_comfort': array([ 0.345755  ,  0.687385  , -0.00641   , -0.318793  ,  0.80272   ,
        -0.322165  , -0.8930336 ,  0.3639    ,  0.1460923 ,  0.082116  ,
        -0.2519375 , -0.088095  ,  0.220135  , -0.497     ,  0.15241   ,
         0.237783  , -0.38234   , -0.01023895, -0.01225   , -0.41226   ,
        -0.015355  ,  0.77824   , -0.715435  ,  0.12335   ,  0.179905  ,
        -1.17656   , -0.166625  , -0.01410195,  0.79957   , -0.125265  ,
         2.59845   ,  0.971865  ,  0.113664  , -0.0476665 ,  0.528735  ,
         0.331815  ,  0.051644  ,  0.065665  ,  0.2696835 , -0.50006   ,
         0.09236   ,  0.1312875 ,  0.0487    ,  0.22047   ,  0.186458  ,
         0.40967   , -0.269445  , -0.51695   ,  0.22382   ,  0.1359    ]),
 'audio': array([-2.7164e-01, -1.0620e-01,  1.1639e+00,  8.3055e-01, -6.4055e-01,
        -3.8543e-01, -3.8031e-01, -1.0309e+00,  7.1602e-01,  1.5211e+00,
         3.7758e-01,  3.3499e-01,  2.7958e-01,  5.2931e-01, -1.3379e-01,
         4.2163e-02, -1.1169e+00,  4.0426e-01,  2.4580e-01, -4.5887e-01,
         1.1611e+00,  6.7204e-01,  7.6799e-01,  4.1851e-01,  2.4399e-01,
         5.2901e-04, -5.9963e-01, -2.3333e-01, -1.0900e-01, -3.2255e-01,
         2.7442e+00, -9.7334e-01,  1.9286e-01, -7.1449e-01,  7.5143e-01,
         1.0963e+00,  6.5071e-01, -4.2206e-01, -5.9653e-01, -4.3164e-01,
         1.7057e+00,  6.6735e-01, -1.0194e+00, -5.6485e-02, -3.5755e-01,
         3.1120e-01,  1.0823e+00,  5.9796e-01, -7.2269e-01, -2.1982e-02]),
 'food_drinks': array([ 0.00813  , -0.291315 , -0.377935 , -0.4511   ,  0.1697   ,
        -0.33926  , -0.077915 , -0.333155 ,  0.896992 ,  0.2695405,
         0.11274  ,  0.153239 ,  0.917145 ,  0.075095 ,  0.373115 ,
        -0.0348   ,  0.1596992,  0.318175 ,  0.5339   , -0.51331  ,
         0.223305 , -0.0314365,  0.330239 ,  0.06217  , -0.04503  ,
         0.046845 , -0.351505 ,  0.21263  ,  0.719215 ,  0.48299  ,
         1.12075  ,  0.3537705, -0.0518605,  0.1537985, -0.271715 ,
         0.753195 , -0.2181435,  0.15729  ,  0.26829  ,  0.1087805,
         0.13845  ,  0.02583  ,  0.160275 ,  0.227394 ,  0.972075 ,
         0.131805 , -0.3517   ,  0.262695 ,  0.3159   ,  0.1296036]),
 'musica': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'foods': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'tablets_impression_image': array([-0.077384  ,  0.13992667, -0.08127333, -0.24457667,  0.52161   ,
         0.0268    ,  0.3012193 , -0.13138667, -0.154263  ,  0.57826667,
         0.146602  ,  0.145905  ,  0.19682467,  0.18164667, -0.227789  ,
         0.03761   , -0.04343   , -0.05507267,  0.34711833, -0.46857667,
        -0.36486   ,  0.25493967, -0.13454067, -0.28168667,  0.48092667,
        -0.47859   , -0.93668333,  0.50939   ,  0.46803667,  0.03142333,
         1.06486667,  0.17615833,  0.07237967, -0.821551  , -0.53859667,
         0.411347  , -0.13504233,  0.09343   , -0.61583667, -0.72796967,
         0.31461667, -0.12306167, -0.34256333,  0.02995   ,  0.17674467,
        -0.19554367,  0.07130667,  0.06865333,  0.40138667, -0.1278366 ]),
 'imported_books': array([-0.244705 ,  0.335795 , -0.222065 , -0.78122  ,  0.08473  ,
        -0.125975 , -0.356555 , -0.847265 ,  0.175237 ,  0.32992  ,
        -0.42183  ,  0.66945  ,  0.312405 ,  0.037295 ,  0.552515 ,
        -0.62933  , -0.01369  ,  0.133375 ,  0.353835 , -0.136222 ,
         0.324805 ,  0.1226795,  0.455654 ,  0.19045  ,  0.274675 ,
         0.079355 , -0.969995 , -0.238115 ,  0.005605 , -0.1791   ,
         0.73675  , -0.2492695,  0.0702045, -0.0370065, -0.43412  ,
         0.6826   , -0.2712735,  0.02613  , -0.31941  , -0.1399095,
         0.58172  , -0.325435 ,  0.09677  ,  0.62292  ,  0.174805 ,
        -0.02849  ,  0.20121  ,  0.0775005, -0.17929  , -0.2912714]),
 'portateis_house_furnace_and_cafe': array([-0.099666  ,  0.003426  , -0.2046856 , -0.4632126 ,  0.109458  ,
        -0.064172  ,  0.204808  ,  0.0623822 , -0.2286756 ,  0.034732  ,
        -0.266516  ,  0.151062  ,  0.3890798 ,  0.2014771 , -0.2018558 ,
        -0.218973  ,  0.1768202 ,  0.264802  ,  0.356504  , -0.397182  ,
         0.027362  ,  0.1166374 ,  0.0579048 , -0.1238992 ,  0.052086  ,
        -0.045282  , -0.3376    ,  0.191854  ,  0.0964178 ,  0.1259412 ,
         0.60202   , -0.0926374 , -0.0940206 , -0.1818258 , -0.106402  ,
         0.4904742 ,  0.0271738 , -0.035798  , -0.125744  , -0.1147594 ,
         0.0332394 , -0.208786  , -0.180152  ,  0.290114  ,  0.434124  ,
        -0.255654  , -0.171102  , -0.226338  ,  0.1334044 , -0.03362768]),
 'fashion_sport': array([-0.468326  ,  0.404715  , -1.04473   ,  0.302491  , -0.172345  ,
        -0.143529  , -0.655065  , -0.984575  ,  0.0084035 ,  0.255903  ,
         0.54345175, -0.341805  , -1.01145   ,  0.18418   ,  0.670005  ,
        -0.139555  , -0.04731   ,  0.870955  , -0.16649   , -1.08362   ,
        -0.11597   ,  0.521785  , -0.78153   ,  0.90431   , -0.19628   ,
        -1.032805  , -1.387205  ,  0.41287   ,  0.14743115,  0.10575   ,
         2.22825   ,  0.85217   , -0.076315  , -0.38412   , -0.229925  ,
         0.122702  , -0.253095  ,  0.754225  , -0.75183   , -0.40324   ,
         0.269256  , -0.121175  ,  0.253995  ,  0.092845  ,  0.2290005 ,
        -0.1804895 , -0.055165  , -0.118525  ,  0.526355  ,  0.28073   ]),
 'Christmas articles': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'fashion_clothing_child_juvenile': array([-0.1697005 ,  0.0846225 , -0.7907775 , -0.4484795 ,  0.4509025 ,
         0.621975  , -0.3533375 , -0.8179925 ,  0.67582675,  0.147415  ,
         0.01591088, -0.243015  ,  0.0388425 , -0.08315852,  0.804845  ,
        -0.151865  , -0.4756445 , -0.043465  ,  0.37923   , -0.3736475 ,
         0.16074   ,  0.524215  , -0.3643075 ,  0.427535  , -0.64324   ,
        -1.110075  , -0.7682625 , -0.10014   ,  0.3830925 , -0.25006   ,
         2.06795   ,  0.1736875 ,  0.1705775 , -0.4934725 ,  0.209775  ,
         0.558596  ,  0.02229   ,  0.23991   , -0.010885  , -0.6099635 ,
        -0.264945  ,  0.144368  ,  0.53343   ,  0.44280175,  0.7556875 ,
        -0.43805   ,  0.10335   , -0.811935  ,  0.24922   ,  0.41137   ]),
 'dvds_blu_ray': array([-0.39314667,  0.23061333,  0.14749667, -0.25329667, -0.13175667,
        -0.36274333,  0.33394   , -0.02583333,  0.12817933,  0.54910333,
         0.20746667,  0.5596    ,  0.29848   ,  0.42703   , -0.17808667,
        -0.16627   ,  0.14480667,  0.17625333,  0.11319333, -0.39455   ,
        -0.57405667,  0.128786  ,  0.33444533, -0.27324333,  0.05667667,
         0.34940333, -0.34053667,  0.22059967,  0.168559  ,  0.14592   ,
        -0.39446667, -0.05937933, -0.00499733, -0.33766867,  0.10468667,
         0.56092333,  0.37097533, -0.04510667, -0.03376667,  0.00296733,
         0.19969667,  0.20785333, -0.44646   ,  0.24233333,  0.47532667,
        -0.39343   ,  0.08812667, -0.32198667,  0.0627    ,  0.34477813]),
 'arts_and_crafts': array([-0.49332   ,  0.52681667, -1.10482333, -0.02062333,  0.0057    ,
        -0.18179667, -0.61973333, -0.95736   , -0.26367767,  0.16554   ,
         0.11252254, -0.06041   ,  0.29226   , -0.16823067, -0.35258   ,
        -0.24899167,  0.298813  ,  0.61835   , -0.240977  , -0.36598   ,
         1.23992667,  0.55204333, -0.40991667,  0.066313  , -0.20028933,
        -0.56011667, -0.65885   , -0.65188667, -0.29332033, -0.57256   ,
         2.65833333,  0.16821933, -0.04925   , -0.691857  ,  0.02931667,
         0.62099333, -0.3367    ,  0.52606333,  0.11731667,  0.47442423,
         0.141009  , -0.03214667,  0.213229  , -0.115837  ,  0.27594   ,
         0.18471467, -0.09605433, -0.61017   , -0.23260733, -0.0574    ]),
 'pc_gamer': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'furniture_bedroom': array([ 0.30487  ,  0.294645 ,  0.00895  , -0.69152  ,  0.473915 ,
        -0.14226  ,  0.08369  ,  0.017115 , -0.307513 ,  0.219474 ,
        -0.54438  , -0.22494  ,  0.465365 ,  0.490195 ,  0.163165 ,
         0.01455  , -0.174765 ,  0.368275 ,  0.583415 , -0.33221  ,
         0.150465 ,  0.7285345, -0.538586 ,  0.173255 , -0.15098  ,
         0.341725 , -0.33548  ,  0.592765 ,  0.496655 , -0.037535 ,
         0.1988   , -0.1238095,  0.1784445,  0.1923785,  0.213045 ,
         0.92709  ,  0.2747815, -0.007905 ,  0.326995 , -0.4153545,
         0.169175 , -0.10017  , -0.0981945,  0.649535 ,  0.15375  ,
        -0.448295 ,  0.189645 , -1.025065 ,  0.174305 , -0.0934664]),
 'cinema_photo': array([-0.2630185,  0.69991  ,  0.125545 ,  0.25244  ,  0.194055 ,
        -0.69504  , -0.559845 , -1.09955  ,  0.111025 ,  0.549665 ,
        -0.102665 , -0.39955  , -0.06765  ,  0.816255 ,  0.51171  ,
        -0.182385 , -0.511395 ,  0.22274  , -0.357578 , -0.08566  ,
         1.154225 ,  0.72874  , -0.4275679,  0.6007   , -0.038558 ,
        -0.669535 , -1.46215  , -0.00609  , -0.24865  , -0.269616 ,
         1.77855  , -0.170537 , -0.009405 , -0.742215 , -0.402225 ,
         0.568995 ,  0.27262  ,  0.0691885, -0.61864  , -0.433645 ,
         0.962525 ,  0.431915 , -0.03867  , -0.49001  , -0.074865 ,
         0.02116  ,  0.27405  , -0.57604  ,  0.28907  ,  0.0622715]),
 'diapers_hygiene': array([-0.59861   , -0.123945  ,  0.109115  , -0.644945  , -0.135375  ,
         0.41613   ,  0.167965  , -0.681365  ,  0.395462  ,  0.0864    ,
         0.446075  ,  0.22311   ,  0.63748   ,  0.05853   ,  0.1684    ,
         0.429185  , -0.701975  ,  0.637835  ,  0.57862   , -0.76477   ,
        -0.038235  ,  0.3163095 ,  0.560914  , -0.374225  , -0.022415  ,
         0.417105  , -0.65033   ,  0.56355   ,  0.934065  ,  0.1461375 ,
        -0.646965  ,  0.9586655 , -0.4055955 ,  0.1694585 , -0.1692205 ,
         0.70821   ,  0.02711195,  0.225575  ,  0.1838    , -0.0665475 ,
         0.00714   , -0.3096115 , -0.0689485 ,  0.61335   ,  0.56992   ,
        -0.3076395 , -0.007655  , -0.22928   ,  0.362775  , -0.0895764 ]),
 'flores': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172]),
 'kitchen_and_food_preparadores_portables': array([-0.008676  , -0.066608  , -0.33233   , -0.3826546 ,  0.235532  ,
        -0.138756  , -0.097108  , -0.26343   ,  0.2591442 ,  0.0373122 ,
        -0.049712  ,  0.2148136 ,  0.494688  ,  0.230144  ,  0.157134  ,
        -0.044589  ,  0.05191948,  0.405222  ,  0.435294  , -0.55728   ,
         0.3219    ,  0.1871012 ,  0.1498912 ,  0.0770928 ,  0.0264332 ,
        -0.130144  , -0.3339    ,  0.1901    ,  0.5611398 ,  0.12659   ,
         1.39016   ,  0.1918784 , -0.0187264 ,  0.0551428 , -0.1131354 ,
         0.863488  , -0.1035688 ,  0.314634  ,  0.361196  ,  0.0793706 ,
         0.1753734 ,  0.030908  ,  0.04689   ,  0.2299356 ,  0.747392  ,
         0.172958  , -0.143748  , -0.240028  ,  0.154946  ,  0.01384288]),
 'insurance_and_services': array([ 3.55600000e-01,  1.31851667e-01,  1.30000000e-01,  8.22273333e-02,
        -1.94096667e-01,  5.71265333e-01, -8.71626667e-01, -3.83083333e-01,
         5.28243333e-01, -5.23333333e-01,  2.66864667e-01,  4.18070000e-01,
        -7.99466667e-03, -3.73093333e-01, -2.11763333e-01,  5.95653000e-02,
        -4.29207000e-01,  4.53833333e-02,  3.11830000e-01, -3.08379000e-01,
         9.91393333e-01,  5.60000000e-03, -5.25376667e-01, -1.30253333e-02,
        -5.31946667e-01, -1.31250000e+00,  7.14000000e-03, -7.02380000e-01,
        -4.83710000e-02, -2.24033333e-03,  3.44356667e+00,  5.46543333e-01,
         4.10760000e-01, -2.78560000e-01,  2.34540000e-02, -4.12333333e-03,
        -1.32902667e-01, -7.62000000e-02,  6.74253333e-01, -2.20366667e-02,
         5.31423333e-02, -1.58070000e-01,  4.86379667e-01,  4.46453333e-01,
        -1.05496667e-01, -2.26063333e-01, -5.88506667e-01,  2.20563333e-01,
         2.69366667e-01,  5.35540000e-01]),
 'furniture_colchao_and_upholstery': array([-0.274925  , -0.06702   , -0.2478475 , -0.47145075, -0.0501925 ,
        -0.1457725 ,  0.4994125 ,  0.0583325 , -0.1418745 ,  0.340415  ,
         0.12953   ,  0.251045  ,  0.4724625 ,  0.2496925 , -0.2693075 ,
        -0.37510125,  0.23952475,  0.3842975 ,  0.3527125 , -0.317     ,
        -0.2716475 ,  0.05693175,  0.1762235 , -0.1000465 ,  0.16426   ,
         0.3891725 , -0.3182325 ,  0.165985  ,  0.22365725,  0.1524025 ,
         0.0669    ,  0.13235325,  0.06005675, -0.11024975, -0.203665  ,
         0.6325025 , -0.04205775, -0.0281375 , -0.255955  ,  0.03341825,
         0.13878425, -0.3188775 , -0.10142   ,  0.3261125 ,  0.54844   ,
        -0.46054   ,  0.0015925 , -0.0259725 ,  0.156775  , -0.0920796 ]),
 'cds_dvds_musicais': array([-0.45596  , -0.13718  , -0.23754  , -0.63402  , -0.10487  ,
        -0.42744  ,  0.83699  ,  0.23567  , -0.078916 ,  0.5      ,
         0.08264  ,  0.2316   ,  0.77999  ,  0.47049  , -0.32597  ,
        -0.51283  ,  0.30945  ,  0.47881  ,  0.55381  , -0.24994  ,
        -0.47739  , -0.073831 ,  0.072328 , -0.10644  ,  0.25275  ,
         0.97813  , -0.38809  ,  0.29865  ,  0.29393  ,  0.35823  ,
        -1.1929   ,  0.071931 ,  0.034599 ,  0.027147 , -0.38162  ,
         0.73098  ,  0.062593 , -0.14562  , -0.38141  , -0.072509 ,
         0.20806  , -0.54812  , -0.21912  ,  0.51654  ,  0.64665  ,
        -0.65962  ,  0.10605  ,  0.17607  ,  0.29246  ,  0.0042172])}
</code></pre><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>2.3 |</span></b> Cosine Similarity</b></p></div><ul><li>The cosine similarity of any two product categories is the determined, given by the equation: $ \frac{\vec{a} \cdot \vec{b}}{|a||b|} $ where $\vec{a}$ and $\vec{b}$ are $N$ dimensional vectors</li><li>The values are between $[-1,1]$, being similar in interpretation as a correlation</li><li>Also returned is a dictionary mapping between the numerical name for a column in the <code>embedding_dict</code> and the categorical name</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>len_categories</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>embeddings</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>get_embeddings_lambda</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>embeddings</span><span class=p>[</span><span class=n>x</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>similarities</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>len_categories</span><span class=p>,</span> <span class=n>len_categories</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>emb_dict</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>word1</span><span class=p>,</span> <span class=n>emb1</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>embeddings</span><span class=o>.</span><span class=n>items</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span><span class=p>,</span> <span class=p>(</span><span class=n>word2</span><span class=p>,</span> <span class=n>emb2</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>embeddings</span><span class=o>.</span><span class=n>items</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>        <span class=n>cosine_similarity</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>emb1</span><span class=p>,</span> <span class=n>emb2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>norm</span><span class=p>(</span><span class=n>emb1</span><span class=p>)</span> <span class=o>*</span> <span class=n>norm</span><span class=p>(</span><span class=n>emb2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>similarities</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>cosine_similarity</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>keys</span> <span class=o>=</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>embeddings</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>embedding_dict</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>embedding_dict</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>embedding_dict</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>{0: 'perfumery',
 1: 'artes',
 2: 'sport_leisure',
 3: 'babies',
 4: 'domestic_utilities',
 5: 'musical instruments',
 6: 'cool_stuff',
 7: 'furniture_decoration',
 8: 'home appliances',
 9: 'toys',
 10: 'bed table bath',
 11: 'construction_tools_security',
 12: 'informatica_accessories',
 13: 'beauty_health',
 14: 'bags_accessories',
 15: 'garden_tools',
 16: 'furniture_office',
 17: 'automotive',
 18: 'electronic',
 19: 'fashion_shoes',
 20: 'telephony',
 21: 'stationary store',
 22: 'fashion_bolsas_e_acessorios',
 23: 'pcs',
 24: 'house_construction',
 25: 'watches_gifts',
 26: 'construction_tools_construction',
 27: 'pet_shop',
 28: 'small appliances',
 29: 'agro_industry_and_trade',
 30: 'in',
 31: 'living room furniture',
 32: 'signaling_and_security',
 33: 'air conditioning',
 34: 'consoles_games',
 35: 'general_interest_books',
 36: 'construction_tools_tools',
 37: 'fashion_underwear_e_moda_praia',
 38: 'fashion_clothes_men',
 39: 'furniture_cozinha_area_de_servico_jantar_e_jardim',
 40: 'industry_comercio_e_nocios',
 41: 'fixed_telephony',
 42: 'construction_tools_lighting',
 43: 'technical books',
 44: 'party_articles',
 45: 'drinks',
 46: 'market_place',
 47: 'the kitchen',
 48: 'construction_tools_garden',
 49: &quot;fashion_women's clothes&quot;,
 50: 'home_comfort',
 51: 'audio',
 52: 'food_drinks',
 53: 'musica',
 54: 'foods',
 55: 'tablets_impression_image',
 56: 'imported_books',
 57: 'portateis_house_furnace_and_cafe',
 58: 'fashion_sport',
 59: 'Christmas articles',
 60: 'fashion_clothing_child_juvenile',
 61: 'dvds_blu_ray',
 62: 'arts_and_crafts',
 63: 'pc_gamer',
 64: 'furniture_bedroom',
 65: 'cinema_photo',
 66: 'diapers_hygiene',
 67: 'flores',
 68: 'kitchen_and_food_preparadores_portables',
 69: 'insurance_and_services',
 70: 'furniture_colchao_and_upholstery',
 71: 'cds_dvds_musicais'}
</code></pre><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>2.4 |</span></b> Similarity Matrix & Heatmap</b></p></div><ul><li>A dataframe is created with similarity values for every product category</li><li>Also made is a heatmap featuring all product categories, on a cool-warm scale from blue (loswest similarity) to red (highest similarity)</li><li>Finally, the function <code>get_similarity</code> is created to obtain the similarity scores for any entered product category</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>similarities_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>similarities</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>similarities_df</span> <span class=o>=</span> <span class=n>similarities_df</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>embedding_dict</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=n>embedding_dict</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>similarities_df</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-ae18751e-5fb7-4415-8122-540361c544ee><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>perfumery</th><th>artes</th><th>sport_leisure</th><th>babies</th><th>domestic_utilities</th><th>musical instruments</th><th>cool_stuff</th><th>furniture_decoration</th><th>home appliances</th><th>toys</th><th>...</th><th>arts_and_crafts</th><th>pc_gamer</th><th>furniture_bedroom</th><th>cinema_photo</th><th>diapers_hygiene</th><th>flores</th><th>kitchen_and_food_preparadores_portables</th><th>insurance_and_services</th><th>furniture_colchao_and_upholstery</th><th>cds_dvds_musicais</th></tr></thead><tbody><tr><th>perfumery</th><td>1.000000</td><td>1.000000</td><td>0.407878</td><td>-0.118951</td><td>0.257968</td><td>-0.177004</td><td>-0.087149</td><td>1.000000</td><td>0.033297</td><td>-0.198021</td><td>...</td><td>-0.314922</td><td>1.000000</td><td>0.358496</td><td>-0.242668</td><td>0.526981</td><td>1.000000</td><td>0.100799</td><td>-0.543074</td><td>0.864288</td><td>1.000000</td></tr><tr><th>artes</th><td>1.000000</td><td>1.000000</td><td>0.407878</td><td>-0.118951</td><td>0.257968</td><td>-0.177004</td><td>-0.087149</td><td>1.000000</td><td>0.033297</td><td>-0.198021</td><td>...</td><td>-0.314922</td><td>1.000000</td><td>0.358496</td><td>-0.242668</td><td>0.526981</td><td>1.000000</td><td>0.100799</td><td>-0.543074</td><td>0.864288</td><td>1.000000</td></tr><tr><th>sport_leisure</th><td>0.407878</td><td>0.407878</td><td>1.000000</td><td>0.122967</td><td>0.551266</td><td>0.179462</td><td>0.375641</td><td>0.407878</td><td>0.403078</td><td>0.212963</td><td>...</td><td>0.295148</td><td>0.407878</td><td>0.196918</td><td>0.275566</td><td>0.428169</td><td>0.407878</td><td>0.419741</td><td>0.122980</td><td>0.587471</td><td>0.407878</td></tr><tr><th>babies</th><td>-0.118951</td><td>-0.118951</td><td>0.122967</td><td>1.000000</td><td>0.277467</td><td>0.229472</td><td>0.357714</td><td>-0.118951</td><td>0.371962</td><td>0.569182</td><td>...</td><td>0.221768</td><td>-0.118951</td><td>0.330407</td><td>0.146192</td><td>0.436191</td><td>-0.118951</td><td>0.489054</td><td>0.362452</td><td>0.094993</td><td>-0.118951</td></tr><tr><th>domestic_utilities</th><td>0.257968</td><td>0.257968</td><td>0.551266</td><td>0.277467</td><td>1.000000</td><td>0.268597</td><td>0.335793</td><td>0.257968</td><td>0.376892</td><td>0.332161</td><td>...</td><td>0.308662</td><td>0.257968</td><td>0.104937</td><td>0.207909</td><td>0.324601</td><td>0.257968</td><td>0.579326</td><td>0.447626</td><td>0.506631</td><td>0.257968</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>flores</th><td>1.000000</td><td>1.000000</td><td>0.407878</td><td>-0.118951</td><td>0.257968</td><td>-0.177004</td><td>-0.087149</td><td>1.000000</td><td>0.033297</td><td>-0.198021</td><td>...</td><td>-0.314922</td><td>1.000000</td><td>0.358496</td><td>-0.242668</td><td>0.526981</td><td>1.000000</td><td>0.100799</td><td>-0.543074</td><td>0.864288</td><td>1.000000</td></tr><tr><th>kitchen_and_food_preparadores_portables</th><td>0.100799</td><td>0.100799</td><td>0.419741</td><td>0.489054</td><td>0.579326</td><td>0.462568</td><td>0.719475</td><td>0.100799</td><td>0.669633</td><td>0.576797</td><td>...</td><td>0.624020</td><td>0.100799</td><td>0.500249</td><td>0.424094</td><td>0.423335</td><td>0.100799</td><td>1.000000</td><td>0.519644</td><td>0.476721</td><td>0.100799</td></tr><tr><th>insurance_and_services</th><td>-0.543074</td><td>-0.543074</td><td>0.122980</td><td>0.362452</td><td>0.447626</td><td>0.491411</td><td>0.366427</td><td>-0.543074</td><td>0.429522</td><td>0.405047</td><td>...</td><td>0.663339</td><td>-0.543074</td><td>-0.004517</td><td>0.402155</td><td>-0.113448</td><td>-0.543074</td><td>0.519644</td><td>1.000000</td><td>-0.170836</td><td>-0.543074</td></tr><tr><th>furniture_colchao_and_upholstery</th><td>0.864288</td><td>0.864288</td><td>0.587471</td><td>0.094993</td><td>0.506631</td><td>0.181650</td><td>0.236841</td><td>0.864288</td><td>0.326945</td><td>0.020209</td><td>...</td><td>0.094675</td><td>0.864288</td><td>0.446304</td><td>-0.008462</td><td>0.552552</td><td>0.864288</td><td>0.476721</td><td>-0.170836</td><td>1.000000</td><td>0.864288</td></tr><tr><th>cds_dvds_musicais</th><td>1.000000</td><td>1.000000</td><td>0.407878</td><td>-0.118951</td><td>0.257968</td><td>-0.177004</td><td>-0.087149</td><td>1.000000</td><td>0.033297</td><td>-0.198021</td><td>...</td><td>-0.314922</td><td>1.000000</td><td>0.358496</td><td>-0.242668</td><td>0.526981</td><td>1.000000</td><td>0.100799</td><td>-0.543074</td><td>0.864288</td><td>1.000000</td></tr></tbody></table><p>72 rows × 72 columns</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span><span class=n>similarities_df</span><span class=o>.</span><span class=n>corr</span><span class=p>(</span><span class=s2>&#34;pearson&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>cmap</span> <span class=o>=</span> <span class=s1>&#39;coolwarm&#39;</span><span class=p>,</span> <span class=n>annot</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f1d5161bb10&gt;
</code></pre><p><img loading=lazy src=images/peak-ai-x-nyu-dsc-datathon-team-7-submission_21_1.png alt=png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>get_similarity</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>similarities_df</span><span class=p>[</span><span class=n>x</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=b3-span-stylecolorf1a424span-entity-relationship-diagrams--previewb><b>3 <span style=color:#f1a424>|</span> Entity Relationship Diagrams & Preview</b><a hidden class=anchor aria-hidden=true href=#b3-span-stylecolorf1a424span-entity-relationship-diagrams--previewb>#</a></h2><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>3.1 |</span></b> Previewing Datasets</b></p></div><ul><li>According to the below Entity Relationship Diagram, we preview tables utilized for this analysis</li></ul><p align=center><img src=https://i.imgur.com/HRhd2Y0.png alt="Olist dataset ERD" height=600px></p><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#d3455b>3.2 |</span></b> olist_orders_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_orders_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orders</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-9d9ba90a-e447-4478-9c72-db2f012231c3><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>order_id</th><th>customer_id</th><th>order_status</th><th>order_purchase_timestamp</th><th>order_approved_at</th><th>order_delivered_carrier_date</th><th>order_delivered_customer_date</th><th>order_estimated_delivery_date</th></tr></thead><tbody><tr><th>0</th><td>e481f51cbdc54678b7cc49136f2d6af7</td><td>9ef432eb6251297304e76186b10a928d</td><td>delivered</td><td>2017-10-02 10:56:33</td><td>2017-10-02 11:07:15</td><td>2017-10-04 19:55:00</td><td>2017-10-10 21:25:13</td><td>2017-10-18 00:00:00</td></tr><tr><th>1</th><td>53cdb2fc8bc7dce0b6741e2150273451</td><td>b0830fb4747a6c6d20dea0b8c802d7ef</td><td>delivered</td><td>2018-07-24 20:41:37</td><td>2018-07-26 03:24:27</td><td>2018-07-26 14:31:00</td><td>2018-08-07 15:27:45</td><td>2018-08-13 00:00:00</td></tr><tr><th>2</th><td>47770eb9100c2d0c44946d9cf07ec65d</td><td>41ce2a54c0b03bf3443c3d931a367089</td><td>delivered</td><td>2018-08-08 08:38:49</td><td>2018-08-08 08:55:23</td><td>2018-08-08 13:50:00</td><td>2018-08-17 18:06:29</td><td>2018-09-04 00:00:00</td></tr><tr><th>3</th><td>949d5b44dbf5de918fe9c16f97b45f8a</td><td>f88197465ea7920adcdbec7375364d82</td><td>delivered</td><td>2017-11-18 19:28:06</td><td>2017-11-18 19:45:59</td><td>2017-11-22 13:39:59</td><td>2017-12-02 00:28:42</td><td>2017-12-15 00:00:00</td></tr><tr><th>4</th><td>ad21c59c0840e6cb83a9ceb5573f8159</td><td>8ab97904e6daea8866dbdbc4fb7aad2c</td><td>delivered</td><td>2018-02-13 21:18:39</td><td>2018-02-13 22:20:29</td><td>2018-02-14 19:46:34</td><td>2018-02-16 18:17:02</td><td>2018-02-26 00:00:00</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>99436</th><td>9c5dedf39a927c1b2549525ed64a053c</td><td>39bd1228ee8140590ac3aca26f2dfe00</td><td>delivered</td><td>2017-03-09 09:54:05</td><td>2017-03-09 09:54:05</td><td>2017-03-10 11:18:03</td><td>2017-03-17 15:08:01</td><td>2017-03-28 00:00:00</td></tr><tr><th>99437</th><td>63943bddc261676b46f01ca7ac2f7bd8</td><td>1fca14ff2861355f6e5f14306ff977a7</td><td>delivered</td><td>2018-02-06 12:58:58</td><td>2018-02-06 13:10:37</td><td>2018-02-07 23:22:42</td><td>2018-02-28 17:37:56</td><td>2018-03-02 00:00:00</td></tr><tr><th>99438</th><td>83c1379a015df1e13d02aae0204711ab</td><td>1aa71eb042121263aafbe80c1b562c9c</td><td>delivered</td><td>2017-08-27 14:46:43</td><td>2017-08-27 15:04:16</td><td>2017-08-28 20:52:26</td><td>2017-09-21 11:24:17</td><td>2017-09-27 00:00:00</td></tr><tr><th>99439</th><td>11c177c8e97725db2631073c19f07b62</td><td>b331b74b18dc79bcdf6532d51e1637c1</td><td>delivered</td><td>2018-01-08 21:28:27</td><td>2018-01-08 21:36:21</td><td>2018-01-12 15:35:03</td><td>2018-01-25 23:32:54</td><td>2018-02-15 00:00:00</td></tr><tr><th>99440</th><td>66dea50a8b16d9b4dee7af250b4be1a5</td><td>edb027a75a1449115f6b43211ae02a24</td><td>delivered</td><td>2018-03-08 20:57:30</td><td>2018-03-09 11:20:28</td><td>2018-03-09 22:11:59</td><td>2018-03-16 13:08:30</td><td>2018-04-03 00:00:00</td></tr></tbody></table><p>99441 rows × 8 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#1aae9f>3.3 |</span></b> olist_order_customer_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orderCustomers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_customers_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orderCustomers</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-ee3ebff8-3c2d-4207-93f6-4fe57e75a3d0><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>customer_id</th><th>customer_unique_id</th><th>customer_zip_code_prefix</th><th>customer_city</th><th>customer_state</th></tr></thead><tbody><tr><th>0</th><td>06b8999e2fba1a1fbc88172c00ba8bc7</td><td>861eff4711a542e4b93843c6dd7febb0</td><td>14409</td><td>franca</td><td>SP</td></tr><tr><th>1</th><td>18955e83d337fd6b2def6b18a428ac77</td><td>290c77bc529b7ac935b93aa66c333dc3</td><td>9790</td><td>sao bernardo do campo</td><td>SP</td></tr><tr><th>2</th><td>4e7b3e00288586ebd08712fdd0374a03</td><td>060e732b5b29e8181a18229c7b0b2b5e</td><td>1151</td><td>sao paulo</td><td>SP</td></tr><tr><th>3</th><td>b2b6027bc5c5109e529d4dc6358b12c3</td><td>259dac757896d24d7702b9acbbff3f3c</td><td>8775</td><td>mogi das cruzes</td><td>SP</td></tr><tr><th>4</th><td>4f2d8ab171c80ec8364f7c12e35b23ad</td><td>345ecd01c38d18a9036ed96c73b8d066</td><td>13056</td><td>campinas</td><td>SP</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>99436</th><td>17ddf5dd5d51696bb3d7c6291687be6f</td><td>1a29b476fee25c95fbafc67c5ac95cf8</td><td>3937</td><td>sao paulo</td><td>SP</td></tr><tr><th>99437</th><td>e7b71a9017aa05c9a7fd292d714858e8</td><td>d52a67c98be1cf6a5c84435bd38d095d</td><td>6764</td><td>taboao da serra</td><td>SP</td></tr><tr><th>99438</th><td>5e28dfe12db7fb50a4b2f691faecea5e</td><td>e9f50caf99f032f0bf3c55141f019d99</td><td>60115</td><td>fortaleza</td><td>CE</td></tr><tr><th>99439</th><td>56b18e2166679b8a959d72dd06da27f9</td><td>73c2643a0a458b49f58cea58833b192e</td><td>92120</td><td>canoas</td><td>RS</td></tr><tr><th>99440</th><td>274fa6071e5e17fe303b9748641082c8</td><td>84732c5050c01db9b23e19ba39899398</td><td>6703</td><td>cotia</td><td>SP</td></tr></tbody></table><p>99441 rows × 5 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#bd34d1>3.4 |</span></b> olist_order_reviews_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orderReviews</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_order_reviews_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orderReviews</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-4411535a-b17a-4ef6-8c0f-561211bed4e7><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>review_id</th><th>order_id</th><th>review_score</th><th>review_comment_title</th><th>review_comment_message</th><th>review_creation_date</th><th>review_answer_timestamp</th></tr></thead><tbody><tr><th>0</th><td>7bc2406110b926393aa56f80a40eba40</td><td>73fc7af87114b39712e6da79b0a377eb</td><td>4</td><td>NaN</td><td>NaN</td><td>2018-01-18 00:00:00</td><td>2018-01-18 21:46:59</td></tr><tr><th>1</th><td>80e641a11e56f04c1ad469d5645fdfde</td><td>a548910a1c6147796b98fdf73dbeba33</td><td>5</td><td>NaN</td><td>NaN</td><td>2018-03-10 00:00:00</td><td>2018-03-11 03:05:13</td></tr><tr><th>2</th><td>228ce5500dc1d8e020d8d1322874b6f0</td><td>f9e4b658b201a9f2ecdecbb34bed034b</td><td>5</td><td>NaN</td><td>NaN</td><td>2018-02-17 00:00:00</td><td>2018-02-18 14:36:24</td></tr><tr><th>3</th><td>e64fb393e7b32834bb789ff8bb30750e</td><td>658677c97b385a9be170737859d3511b</td><td>5</td><td>NaN</td><td>Recebi bem antes do prazo estipulado.</td><td>2017-04-21 00:00:00</td><td>2017-04-21 22:02:06</td></tr><tr><th>4</th><td>f7c4243c7fe1938f181bec41a392bdeb</td><td>8e6bfb81e283fa7e4f11123a3fb894f1</td><td>5</td><td>NaN</td><td>Parabéns lojas lannister adorei comprar pela I...</td><td>2018-03-01 00:00:00</td><td>2018-03-02 10:26:53</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>99219</th><td>574ed12dd733e5fa530cfd4bbf39d7c9</td><td>2a8c23fee101d4d5662fa670396eb8da</td><td>5</td><td>NaN</td><td>NaN</td><td>2018-07-07 00:00:00</td><td>2018-07-14 17:18:30</td></tr><tr><th>99220</th><td>f3897127253a9592a73be9bdfdf4ed7a</td><td>22ec9f0669f784db00fa86d035cf8602</td><td>5</td><td>NaN</td><td>NaN</td><td>2017-12-09 00:00:00</td><td>2017-12-11 20:06:42</td></tr><tr><th>99221</th><td>b3de70c89b1510c4cd3d0649fd302472</td><td>55d4004744368f5571d1f590031933e4</td><td>5</td><td>NaN</td><td>Excelente mochila, entrega super rápida. Super...</td><td>2018-03-22 00:00:00</td><td>2018-03-23 09:10:43</td></tr><tr><th>99222</th><td>1adeb9d84d72fe4e337617733eb85149</td><td>7725825d039fc1f0ceb7635e3f7d9206</td><td>4</td><td>NaN</td><td>NaN</td><td>2018-07-01 00:00:00</td><td>2018-07-02 12:59:13</td></tr><tr><th>99223</th><td>efe49f1d6f951dd88b51e6ccd4cc548f</td><td>90531360ecb1eec2a1fbb265a0db0508</td><td>1</td><td>NaN</td><td>meu produto chegou e ja tenho que devolver, po...</td><td>2017-07-03 00:00:00</td><td>2017-07-03 21:01:49</td></tr></tbody></table><p>99224 rows × 7 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#788896>3.5 |</span></b> olist_order_payments_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orderPayments</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_order_payments_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orderPayments</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-f58adb67-b5d3-49ac-8c93-bda6af15e966><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>order_id</th><th>payment_sequential</th><th>payment_type</th><th>payment_installments</th><th>payment_value</th></tr></thead><tbody><tr><th>0</th><td>b81ef226f3fe1789b1e8b2acac839d17</td><td>1</td><td>credit_card</td><td>8</td><td>99.33</td></tr><tr><th>1</th><td>a9810da82917af2d9aefd1278f1dcfa0</td><td>1</td><td>credit_card</td><td>1</td><td>24.39</td></tr><tr><th>2</th><td>25e8ea4e93396b6fa0d3dd708e76c1bd</td><td>1</td><td>credit_card</td><td>1</td><td>65.71</td></tr><tr><th>3</th><td>ba78997921bbcdc1373bb41e913ab953</td><td>1</td><td>credit_card</td><td>8</td><td>107.78</td></tr><tr><th>4</th><td>42fdf880ba16b47b59251dd489d4441a</td><td>1</td><td>credit_card</td><td>2</td><td>128.45</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>103881</th><td>0406037ad97740d563a178ecc7a2075c</td><td>1</td><td>boleto</td><td>1</td><td>363.31</td></tr><tr><th>103882</th><td>7b905861d7c825891d6347454ea7863f</td><td>1</td><td>credit_card</td><td>2</td><td>96.80</td></tr><tr><th>103883</th><td>32609bbb3dd69b3c066a6860554a77bf</td><td>1</td><td>credit_card</td><td>1</td><td>47.77</td></tr><tr><th>103884</th><td>b8b61059626efa996a60be9bb9320e10</td><td>1</td><td>credit_card</td><td>5</td><td>369.54</td></tr><tr><th>103885</th><td>28bbae6599b09d39ca406b747b6632b1</td><td>1</td><td>boleto</td><td>1</td><td>191.58</td></tr></tbody></table><p>103886 rows × 5 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#e8973a>3.6 |</span></b> olist_order_items_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orderItems</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_order_items_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orderItems</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-5898a9aa-2d74-40c1-b1aa-c6466a166ff6><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>order_id</th><th>order_item_id</th><th>product_id</th><th>seller_id</th><th>shipping_limit_date</th><th>price</th><th>freight_value</th></tr></thead><tbody><tr><th>0</th><td>00010242fe8c5a6d1ba2dd792cb16214</td><td>1</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-09-19 09:45:35</td><td>58.90</td><td>13.29</td></tr><tr><th>1</th><td>00018f77f2f0320c557190d7a144bdd3</td><td>1</td><td>e5f2d52b802189ee658865ca93d83a8f</td><td>dd7ddc04e1b6c2c614352b383efe2d36</td><td>2017-05-03 11:05:13</td><td>239.90</td><td>19.93</td></tr><tr><th>2</th><td>000229ec398224ef6ca0657da4fc703e</td><td>1</td><td>c777355d18b72b67abbeef9df44fd0fd</td><td>5b51032eddd242adc84c38acab88f23d</td><td>2018-01-18 14:48:30</td><td>199.00</td><td>17.87</td></tr><tr><th>3</th><td>00024acbcdf0a6daa1e931b038114c75</td><td>1</td><td>7634da152a4610f1595efa32f14722fc</td><td>9d7a1d34a5052409006425275ba1c2b4</td><td>2018-08-15 10:10:18</td><td>12.99</td><td>12.79</td></tr><tr><th>4</th><td>00042b26cf59d7ce69dfabb4e55b4fd9</td><td>1</td><td>ac6c3623068f30de03045865e4e10089</td><td>df560393f3a51e74553ab94004ba5c87</td><td>2017-02-13 13:57:51</td><td>199.90</td><td>18.14</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>112645</th><td>fffc94f6ce00a00581880bf54a75a037</td><td>1</td><td>4aa6014eceb682077f9dc4bffebc05b0</td><td>b8bc237ba3788b23da09c0f1f3a3288c</td><td>2018-05-02 04:11:01</td><td>299.99</td><td>43.41</td></tr><tr><th>112646</th><td>fffcd46ef2263f404302a634eb57f7eb</td><td>1</td><td>32e07fd915822b0765e448c4dd74c828</td><td>f3c38ab652836d21de61fb8314b69182</td><td>2018-07-20 04:31:48</td><td>350.00</td><td>36.53</td></tr><tr><th>112647</th><td>fffce4705a9662cd70adb13d4a31832d</td><td>1</td><td>72a30483855e2eafc67aee5dc2560482</td><td>c3cfdc648177fdbbbb35635a37472c53</td><td>2017-10-30 17:14:25</td><td>99.90</td><td>16.95</td></tr><tr><th>112648</th><td>fffe18544ffabc95dfada21779c9644f</td><td>1</td><td>9c422a519119dcad7575db5af1ba540e</td><td>2b3e4a2a3ea8e01938cabda2a3e5cc79</td><td>2017-08-21 00:04:32</td><td>55.99</td><td>8.72</td></tr><tr><th>112649</th><td>fffe41c64501cc87c801fd61db3f6244</td><td>1</td><td>350688d9dc1e75ff97be326363655e01</td><td>f7ccf836d21b2fb1de37564105216cc1</td><td>2018-06-12 17:10:13</td><td>43.00</td><td>12.79</td></tr></tbody></table><p>112650 rows × 7 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f7c325>3.7 |</span></b> olist_products_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>products</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_products_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>products</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-3ec0842b-9b83-4542-abc1-3f275d0f5eb1><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>product_id</th><th>product_category_name</th><th>product_name_lenght</th><th>product_description_lenght</th><th>product_photos_qty</th><th>product_weight_g</th><th>product_length_cm</th><th>product_height_cm</th><th>product_width_cm</th></tr></thead><tbody><tr><th>0</th><td>1e9e8ef04dbcff4541ed26657ea517e5</td><td>perfumaria</td><td>40.0</td><td>287.0</td><td>1.0</td><td>225.0</td><td>16.0</td><td>10.0</td><td>14.0</td></tr><tr><th>1</th><td>3aa071139cb16b67ca9e5dea641aaa2f</td><td>artes</td><td>44.0</td><td>276.0</td><td>1.0</td><td>1000.0</td><td>30.0</td><td>18.0</td><td>20.0</td></tr><tr><th>2</th><td>96bd76ec8810374ed1b65e291975717f</td><td>esporte_lazer</td><td>46.0</td><td>250.0</td><td>1.0</td><td>154.0</td><td>18.0</td><td>9.0</td><td>15.0</td></tr><tr><th>3</th><td>cef67bcfe19066a932b7673e239eb23d</td><td>bebes</td><td>27.0</td><td>261.0</td><td>1.0</td><td>371.0</td><td>26.0</td><td>4.0</td><td>26.0</td></tr><tr><th>4</th><td>9dc1a7de274444849c219cff195d0b71</td><td>utilidades_domesticas</td><td>37.0</td><td>402.0</td><td>4.0</td><td>625.0</td><td>20.0</td><td>17.0</td><td>13.0</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>32946</th><td>a0b7d5a992ccda646f2d34e418fff5a0</td><td>moveis_decoracao</td><td>45.0</td><td>67.0</td><td>2.0</td><td>12300.0</td><td>40.0</td><td>40.0</td><td>40.0</td></tr><tr><th>32947</th><td>bf4538d88321d0fd4412a93c974510e6</td><td>construcao_ferramentas_iluminacao</td><td>41.0</td><td>971.0</td><td>1.0</td><td>1700.0</td><td>16.0</td><td>19.0</td><td>16.0</td></tr><tr><th>32948</th><td>9a7c6041fa9592d9d9ef6cfe62a71f8c</td><td>cama_mesa_banho</td><td>50.0</td><td>799.0</td><td>1.0</td><td>1400.0</td><td>27.0</td><td>7.0</td><td>27.0</td></tr><tr><th>32949</th><td>83808703fc0706a22e264b9d75f04a2e</td><td>informatica_acessorios</td><td>60.0</td><td>156.0</td><td>2.0</td><td>700.0</td><td>31.0</td><td>13.0</td><td>20.0</td></tr><tr><th>32950</th><td>106392145fca363410d287a815be6de4</td><td>cama_mesa_banho</td><td>58.0</td><td>309.0</td><td>1.0</td><td>2083.0</td><td>12.0</td><td>2.0</td><td>7.0</td></tr></tbody></table><p>32951 rows × 9 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#1aae9f>3.8 |</span></b> olist_sellers_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#TEAL_NUMBER_2</span>
</span></span><span class=line><span class=cl><span class=n>sellers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_sellers_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sellers</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-25db81bb-0455-4465-a45a-ff4de4870468><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>seller_id</th><th>seller_zip_code_prefix</th><th>seller_city</th><th>seller_state</th></tr></thead><tbody><tr><th>0</th><td>3442f8959a84dea7ee197c632cb2df15</td><td>13023</td><td>campinas</td><td>SP</td></tr><tr><th>1</th><td>d1b65fc7debc3361ea86b5f14c68d2e2</td><td>13844</td><td>mogi guacu</td><td>SP</td></tr><tr><th>2</th><td>ce3ad9de960102d0677a81f5d0bb7b2d</td><td>20031</td><td>rio de janeiro</td><td>RJ</td></tr><tr><th>3</th><td>c0f3eea2e14555b6faeea3dd58c1b1c3</td><td>4195</td><td>sao paulo</td><td>SP</td></tr><tr><th>4</th><td>51a04a8a6bdcb23deccc82b0b80742cf</td><td>12914</td><td>braganca paulista</td><td>SP</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>3090</th><td>98dddbc4601dd4443ca174359b237166</td><td>87111</td><td>sarandi</td><td>PR</td></tr><tr><th>3091</th><td>f8201cab383e484733266d1906e2fdfa</td><td>88137</td><td>palhoca</td><td>SC</td></tr><tr><th>3092</th><td>74871d19219c7d518d0090283e03c137</td><td>4650</td><td>sao paulo</td><td>SP</td></tr><tr><th>3093</th><td>e603cf3fec55f8697c9059638d6c8eb5</td><td>96080</td><td>pelotas</td><td>RS</td></tr><tr><th>3094</th><td>9e25199f6ef7e7c347120ff175652c3b</td><td>12051</td><td>taubate</td><td>SP</td></tr></tbody></table><p>3095 rows × 4 columns</p></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#2c88d9>3.9 |</span></b> olist_geolocation_dataset</b></p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>geolocation</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;datasets/olist_geolocation_dataset.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>geolocation</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-a902b7e6-1d52-4d9a-9d4d-72c0a2a5773b><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>geolocation_zip_code_prefix</th><th>geolocation_lat</th><th>geolocation_lng</th><th>geolocation_city</th><th>geolocation_state</th></tr></thead><tbody><tr><th>0</th><td>1037</td><td>-23.545621</td><td>-46.639292</td><td>sao paulo</td><td>SP</td></tr><tr><th>1</th><td>1046</td><td>-23.546081</td><td>-46.644820</td><td>sao paulo</td><td>SP</td></tr><tr><th>2</th><td>1046</td><td>-23.546129</td><td>-46.642951</td><td>sao paulo</td><td>SP</td></tr><tr><th>3</th><td>1041</td><td>-23.544392</td><td>-46.639499</td><td>sao paulo</td><td>SP</td></tr><tr><th>4</th><td>1035</td><td>-23.541578</td><td>-46.641607</td><td>sao paulo</td><td>SP</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>1000158</th><td>99950</td><td>-28.068639</td><td>-52.010705</td><td>tapejara</td><td>RS</td></tr><tr><th>1000159</th><td>99900</td><td>-27.877125</td><td>-52.224882</td><td>getulio vargas</td><td>RS</td></tr><tr><th>1000160</th><td>99950</td><td>-28.071855</td><td>-52.014716</td><td>tapejara</td><td>RS</td></tr><tr><th>1000161</th><td>99980</td><td>-28.388932</td><td>-51.846871</td><td>david canabarro</td><td>RS</td></tr><tr><th>1000162</th><td>99950</td><td>-28.070104</td><td>-52.018658</td><td>tapejara</td><td>RS</td></tr></tbody></table><p>1000163 rows × 5 columns</p></div><h2 id=b4-span-stylecolorf1a424span-merging-datasetsb><b>4 <span style=color:#f1a424>|</span> Merging Datasets</b><a hidden class=anchor aria-hidden=true href=#b4-span-stylecolorf1a424span-merging-datasetsb>#</a></h2><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>4.1 |</span></b> Merging Individual Tables</b></p></div><ul><li>First, the <span style=color:#bd34d1>olist_order_reviews_dataset</span> and <span style=color:#d3455b>olist_orders_dataset</span> are merged using an outer merge on the shared key of <code>order_id</code> for both tables</li><li>Next <span style=color:#788896>olist_order_payments_dataset</span> is merged on the previously merged tables using an outer merge on the <code>order_id</code> shared key</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>purpleRedMerge</span> <span class=o>=</span> <span class=n>orders</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>orderReviews</span><span class=p>,</span> <span class=n>how</span> <span class=o>=</span> <span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s1>&#39;order_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>purpleRedMerge</span><span class=p>[</span><span class=s1>&#39;review_score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mf>3.5</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>purpleRedMerge</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-c6d2472d-8a3f-42f3-aa22-f32a3f1e6d9d><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>order_id</th><th>customer_id</th><th>order_status</th><th>order_purchase_timestamp</th><th>order_approved_at</th><th>order_delivered_carrier_date</th><th>order_delivered_customer_date</th><th>order_estimated_delivery_date</th><th>review_id</th><th>review_score</th><th>review_comment_title</th><th>review_comment_message</th><th>review_creation_date</th><th>review_answer_timestamp</th></tr></thead><tbody><tr><th>0</th><td>e481f51cbdc54678b7cc49136f2d6af7</td><td>9ef432eb6251297304e76186b10a928d</td><td>delivered</td><td>2017-10-02 10:56:33</td><td>2017-10-02 11:07:15</td><td>2017-10-04 19:55:00</td><td>2017-10-10 21:25:13</td><td>2017-10-18 00:00:00</td><td>a54f0611adc9ed256b57ede6b6eb5114</td><td>4.0</td><td>NaN</td><td>Não testei o produto ainda, mas ele veio corre...</td><td>2017-10-11 00:00:00</td><td>2017-10-12 03:43:48</td></tr><tr><th>1</th><td>53cdb2fc8bc7dce0b6741e2150273451</td><td>b0830fb4747a6c6d20dea0b8c802d7ef</td><td>delivered</td><td>2018-07-24 20:41:37</td><td>2018-07-26 03:24:27</td><td>2018-07-26 14:31:00</td><td>2018-08-07 15:27:45</td><td>2018-08-13 00:00:00</td><td>8d5266042046a06655c8db133d120ba5</td><td>4.0</td><td>Muito boa a loja</td><td>Muito bom o produto.</td><td>2018-08-08 00:00:00</td><td>2018-08-08 18:37:50</td></tr><tr><th>2</th><td>47770eb9100c2d0c44946d9cf07ec65d</td><td>41ce2a54c0b03bf3443c3d931a367089</td><td>delivered</td><td>2018-08-08 08:38:49</td><td>2018-08-08 08:55:23</td><td>2018-08-08 13:50:00</td><td>2018-08-17 18:06:29</td><td>2018-09-04 00:00:00</td><td>e73b67b67587f7644d5bd1a52deb1b01</td><td>5.0</td><td>NaN</td><td>NaN</td><td>2018-08-18 00:00:00</td><td>2018-08-22 19:07:58</td></tr><tr><th>3</th><td>949d5b44dbf5de918fe9c16f97b45f8a</td><td>f88197465ea7920adcdbec7375364d82</td><td>delivered</td><td>2017-11-18 19:28:06</td><td>2017-11-18 19:45:59</td><td>2017-11-22 13:39:59</td><td>2017-12-02 00:28:42</td><td>2017-12-15 00:00:00</td><td>359d03e676b3c069f62cadba8dd3f6e8</td><td>5.0</td><td>NaN</td><td>O produto foi exatamente o que eu esperava e e...</td><td>2017-12-03 00:00:00</td><td>2017-12-05 19:21:58</td></tr><tr><th>4</th><td>ad21c59c0840e6cb83a9ceb5573f8159</td><td>8ab97904e6daea8866dbdbc4fb7aad2c</td><td>delivered</td><td>2018-02-13 21:18:39</td><td>2018-02-13 22:20:29</td><td>2018-02-14 19:46:34</td><td>2018-02-16 18:17:02</td><td>2018-02-26 00:00:00</td><td>e50934924e227544ba8246aeb3770dd4</td><td>5.0</td><td>NaN</td><td>NaN</td><td>2018-02-17 00:00:00</td><td>2018-02-18 13:02:51</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>99987</th><td>9c5dedf39a927c1b2549525ed64a053c</td><td>39bd1228ee8140590ac3aca26f2dfe00</td><td>delivered</td><td>2017-03-09 09:54:05</td><td>2017-03-09 09:54:05</td><td>2017-03-10 11:18:03</td><td>2017-03-17 15:08:01</td><td>2017-03-28 00:00:00</td><td>e262b3f92d1ce917aa412a9406cf61a6</td><td>5.0</td><td>NaN</td><td>NaN</td><td>2017-03-22 00:00:00</td><td>2017-03-23 11:02:08</td></tr><tr><th>99988</th><td>63943bddc261676b46f01ca7ac2f7bd8</td><td>1fca14ff2861355f6e5f14306ff977a7</td><td>delivered</td><td>2018-02-06 12:58:58</td><td>2018-02-06 13:10:37</td><td>2018-02-07 23:22:42</td><td>2018-02-28 17:37:56</td><td>2018-03-02 00:00:00</td><td>29bb71b2760d0f876dfa178a76bc4734</td><td>4.0</td><td>NaN</td><td>So uma peça que veio rachado mas tudo bem rs</td><td>2018-03-01 00:00:00</td><td>2018-03-02 17:50:01</td></tr><tr><th>99989</th><td>83c1379a015df1e13d02aae0204711ab</td><td>1aa71eb042121263aafbe80c1b562c9c</td><td>delivered</td><td>2017-08-27 14:46:43</td><td>2017-08-27 15:04:16</td><td>2017-08-28 20:52:26</td><td>2017-09-21 11:24:17</td><td>2017-09-27 00:00:00</td><td>371579771219f6db2d830d50805977bb</td><td>5.0</td><td>NaN</td><td>Foi entregue antes do prazo.</td><td>2017-09-22 00:00:00</td><td>2017-09-22 23:10:57</td></tr><tr><th>99990</th><td>11c177c8e97725db2631073c19f07b62</td><td>b331b74b18dc79bcdf6532d51e1637c1</td><td>delivered</td><td>2018-01-08 21:28:27</td><td>2018-01-08 21:36:21</td><td>2018-01-12 15:35:03</td><td>2018-01-25 23:32:54</td><td>2018-02-15 00:00:00</td><td>8ab6855b9fe9b812cd03a480a25058a1</td><td>2.0</td><td>NaN</td><td>Foi entregue somente 1. Quero saber do outro p...</td><td>2018-01-26 00:00:00</td><td>2018-01-27 09:16:56</td></tr><tr><th>99991</th><td>66dea50a8b16d9b4dee7af250b4be1a5</td><td>edb027a75a1449115f6b43211ae02a24</td><td>delivered</td><td>2018-03-08 20:57:30</td><td>2018-03-09 11:20:28</td><td>2018-03-09 22:11:59</td><td>2018-03-16 13:08:30</td><td>2018-04-03 00:00:00</td><td>dc9c59b4688062c25758c2be4cafc523</td><td>5.0</td><td>NaN</td><td>NaN</td><td>2018-03-17 00:00:00</td><td>2018-03-17 16:33:31</td></tr></tbody></table><p>99992 rows × 14 columns</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>purpleRedGreyMerge</span> <span class=o>=</span> <span class=n>purpleRedMerge</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>orderPayments</span><span class=p>,</span> <span class=n>how</span> <span class=o>=</span> <span class=s2>&#34;outer&#34;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s2>&#34;order_id&#34;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s2>&#34;order_id&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>4.2 |</span></b> Further Merges & Drops</b></p></div><ul><li><span style=color:#1aae9f>olist_order_customer_dataset</span> is merged on the previously combined tables through an outer merge on <code>customer_id</code> as the shared key with duplicates and null values then dropped</li><li>The <b>temporary</b> table <code>teal2BlueMerge</code> is created by merging together <span style=color:#1aae9f>olist_sellers_dataset</span> and <span style=color:#2c88d9>olist_geolocation_dataset</span> through an outer merge, left on <code>seller_zip_code_prefix</code> and right on <code>geolocation_zip_code_prefix</code> with dulicates and null values then dropped</li><li>As before, another <b>temporary</b> dataframe is created, merging <span style=color:#e8973a>olist_order_items_dataset</span> and <span style=color:#f7c325>olist_products_dataset</span> using an outer merge on the shared key <code>order_id</code></li><li>The two previously created <b>temporary</b> tables are merged together on an outer merge on the shared key <code>seller_id</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>teal1PurpleRedGreyMerge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>orderCustomers</span><span class=p>,</span> <span class=n>purpleRedGreyMerge</span><span class=p>,</span> <span class=n>how</span> <span class=o>=</span> <span class=s2>&#34;outer&#34;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s1>&#39;customer_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>teal1PurpleRedGreyMerge</span> <span class=o>=</span> <span class=n>teal1PurpleRedGreyMerge</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>teal1PurpleRedGreyMerge</span> <span class=o>=</span> <span class=n>teal1PurpleRedGreyMerge</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>teal1PurpleRedGreyMerge</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>teal2BlueMerge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>sellers</span><span class=p>,</span> <span class=n>geolocation</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s1>&#39;seller_zip_code_prefix&#39;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s1>&#39;geolocation_zip_code_prefix&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>teal2BlueMerge</span> <span class=o>=</span> <span class=n>teal2BlueMerge</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;seller_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>teal2BlueMerge</span> <span class=o>=</span> <span class=n>teal2BlueMerge</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;seller_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>teal2BlueMerge</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-80c9f2dd-0c0d-4f3b-a8f1-673c4c1149c9><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>seller_id</th><th>seller_zip_code_prefix</th><th>seller_city</th><th>seller_state</th><th>geolocation_zip_code_prefix</th><th>geolocation_lat</th><th>geolocation_lng</th><th>geolocation_city</th><th>geolocation_state</th></tr></thead><tbody><tr><th>0</th><td>3442f8959a84dea7ee197c632cb2df15</td><td>13023.0</td><td>campinas</td><td>SP</td><td>13023.0</td><td>-22.898536</td><td>-47.063125</td><td>campinas</td><td>SP</td></tr><tr><th>80</th><td>e0eabded302882513ced4ea3eb0c7059</td><td>13023.0</td><td>campinas</td><td>SP</td><td>13023.0</td><td>-22.898536</td><td>-47.063125</td><td>campinas</td><td>SP</td></tr><tr><th>160</th><td>d1b65fc7debc3361ea86b5f14c68d2e2</td><td>13844.0</td><td>mogi guacu</td><td>SP</td><td>13844.0</td><td>-22.382941</td><td>-46.946641</td><td>mogi-guacu</td><td>SP</td></tr><tr><th>263</th><td>ce3ad9de960102d0677a81f5d0bb7b2d</td><td>20031.0</td><td>rio de janeiro</td><td>RJ</td><td>20031.0</td><td>-22.910641</td><td>-43.176510</td><td>rio de janeiro</td><td>RJ</td></tr><tr><th>650</th><td>1d2732ef8321502ee8488e8bed1ab8cd</td><td>20031.0</td><td>rio de janeiro</td><td>RJ</td><td>20031.0</td><td>-22.910641</td><td>-43.176510</td><td>rio de janeiro</td><td>RJ</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>434730</th><td>f1fdf2d13186575751aa25876536d85c</td><td>5314.0</td><td>sao paulo</td><td>SP</td><td>5314.0</td><td>-23.534949</td><td>-46.733916</td><td>sao paulo</td><td>SP</td></tr><tr><th>434792</th><td>98dddbc4601dd4443ca174359b237166</td><td>87111.0</td><td>sarandi</td><td>PR</td><td>87111.0</td><td>-23.456431</td><td>-51.866369</td><td>sarandi</td><td>PR</td></tr><tr><th>434860</th><td>74871d19219c7d518d0090283e03c137</td><td>4650.0</td><td>sao paulo</td><td>SP</td><td>4650.0</td><td>-23.659845</td><td>-46.677882</td><td>sao paulo</td><td>SP</td></tr><tr><th>434928</th><td>e603cf3fec55f8697c9059638d6c8eb5</td><td>96080.0</td><td>pelotas</td><td>RS</td><td>96080.0</td><td>-31.744231</td><td>-52.328761</td><td>pelotas</td><td>RS</td></tr><tr><th>435024</th><td>9e25199f6ef7e7c347120ff175652c3b</td><td>12051.0</td><td>taubate</td><td>SP</td><td>12051.0</td><td>-23.016003</td><td>-45.582021</td><td>taubate</td><td>SP</td></tr></tbody></table><p>3095 rows × 9 columns</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orangeYellowMerge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>orderItems</span><span class=p>,</span> <span class=n>products</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s1>&#39;product_id&#39;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s1>&#39;product_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orangeYellowMerge</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orangeYellowMerge</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>orangeYellowMerge</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-38656dc2-5d9b-463a-8f2c-9d9c4ec9c2b4><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>order_id</th><th>order_item_id</th><th>product_id</th><th>seller_id</th><th>shipping_limit_date</th><th>price</th><th>freight_value</th><th>product_category_name</th><th>product_name_lenght</th><th>product_description_lenght</th><th>product_photos_qty</th><th>product_weight_g</th><th>product_length_cm</th><th>product_height_cm</th><th>product_width_cm</th></tr></thead><tbody><tr><th>0</th><td>00010242fe8c5a6d1ba2dd792cb16214</td><td>1</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-09-19 09:45:35</td><td>58.9</td><td>13.29</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td></tr><tr><th>1</th><td>130898c0987d1801452a8ed92a670612</td><td>1</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-07-05 02:44:11</td><td>55.9</td><td>17.96</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td></tr><tr><th>2</th><td>532ed5e14e24ae1f0d735b91524b98b9</td><td>1</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2018-05-23 10:56:25</td><td>64.9</td><td>18.33</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td></tr><tr><th>3</th><td>6f8c31653edb8c83e1a739408b5ff750</td><td>1</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-08-07 18:55:08</td><td>58.9</td><td>16.17</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td></tr><tr><th>4</th><td>7d19f4ef4d04461989632411b7e588b9</td><td>1</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-08-16 22:05:11</td><td>58.9</td><td>13.29</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>112645</th><td>ffebd80e3291e811c308365936897efd</td><td>1</td><td>4cc4d02efc8f249c13355147fb44e34d</td><td>d1c7fa84e48cfa21a0e595167c1c500e</td><td>2018-07-18 20:23:55</td><td>129.9</td><td>51.20</td><td>ferramentas_jardim</td><td>37.0</td><td>653.0</td><td>1.0</td><td>6700.0</td><td>35.0</td><td>12.0</td><td>22.0</td></tr><tr><th>112646</th><td>ffee31fb4b5e35c9123608015637c495</td><td>1</td><td>b10ecf8e33aaaea419a9fa860ea80fb5</td><td>0241d4d5d36f10f80c644447315af0bd</td><td>2018-08-21 10:10:11</td><td>99.0</td><td>13.52</td><td>moveis_decoracao</td><td>30.0</td><td>308.0</td><td>1.0</td><td>2300.0</td><td>37.0</td><td>30.0</td><td>20.0</td></tr><tr><th>112647</th><td>fff7c4452f050315db1b3f24d9df5fcd</td><td>1</td><td>dd469c03ad67e201bc2179ef077dcd48</td><td>7e93a43ef30c4f03f38b393420bc753a</td><td>2017-06-07 17:05:23</td><td>736.0</td><td>20.91</td><td>relogios_presentes</td><td>33.0</td><td>658.0</td><td>3.0</td><td>400.0</td><td>19.0</td><td>9.0</td><td>15.0</td></tr><tr><th>112648</th><td>fffa82886406ccf10c7b4e35c4ff2788</td><td>1</td><td>bbe7651fef80287a816ead73f065fc4b</td><td>8f2ce03f928b567e3d56181ae20ae952</td><td>2017-12-22 17:31:42</td><td>229.9</td><td>44.02</td><td>esporte_lazer</td><td>32.0</td><td>280.0</td><td>2.0</td><td>2700.0</td><td>60.0</td><td>15.0</td><td>15.0</td></tr><tr><th>112649</th><td>fffe41c64501cc87c801fd61db3f6244</td><td>1</td><td>350688d9dc1e75ff97be326363655e01</td><td>f7ccf836d21b2fb1de37564105216cc1</td><td>2018-06-12 17:10:13</td><td>43.0</td><td>12.79</td><td>cama_mesa_banho</td><td>47.0</td><td>511.0</td><td>1.0</td><td>600.0</td><td>30.0</td><td>3.0</td><td>19.0</td></tr></tbody></table><p>112650 rows × 15 columns</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>teal2BlueOrangeYellowMerge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>orangeYellowMerge</span><span class=p>,</span> <span class=n>teal2BlueMerge</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s1>&#39;seller_id&#39;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s1>&#39;seller_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>teal2BlueOrangeYellowMerge</span> <span class=o>=</span> <span class=n>teal2BlueOrangeYellowMerge</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;seller_state&#34;</span><span class=p>,</span> <span class=s2>&#34;geolocation_state&#34;</span><span class=p>,</span> <span class=s2>&#34;geolocation_zip_code_prefix&#34;</span><span class=p>,</span> <span class=s2>&#34;geolocation_city&#34;</span><span class=p>],</span> <span class=n>axis</span> <span class=o>=</span> <span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>4.3 |</span></b> Final Merges & Drops</b></p></div><ul><li>Finally, the two created <b>temporary</b> tables are merged through an outer merge on the shared key <code>order_id</code></li><li>For this analysis, many columns of ths final table are not needed and thus dropped</li><li>This final table is then exported as a <code>.csv</code> file</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>finalMerge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>teal2BlueOrangeYellowMerge</span><span class=p>,</span> <span class=n>teal1PurpleRedGreyMerge</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>left_on</span> <span class=o>=</span> <span class=s2>&#34;order_id&#34;</span><span class=p>,</span> <span class=n>right_on</span> <span class=o>=</span> <span class=s2>&#34;order_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>finalMerge</span><span class=o>.</span><span class=n>info</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>finalMerge</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 113425 entries, 0 to 113424
Data columns (total 40 columns):
 #   Column                         Non-Null Count   Dtype  
---  ------                         --------------   -----  
 0   order_id                       113425 non-null  object 
 1   order_item_id                  112650 non-null  float64
 2   product_id                     112650 non-null  object 
 3   seller_id                      112650 non-null  object 
 4   shipping_limit_date            112650 non-null  object 
 5   price                          112650 non-null  float64
 6   freight_value                  112650 non-null  float64
 7   product_category_name          112650 non-null  object 
 8   product_name_lenght            112650 non-null  float64
 9   product_description_lenght     112650 non-null  float64
 10  product_photos_qty             112650 non-null  float64
 11  product_weight_g               112650 non-null  float64
 12  product_length_cm              112650 non-null  float64
 13  product_height_cm              112650 non-null  float64
 14  product_width_cm               112650 non-null  float64
 15  seller_zip_code_prefix         112650 non-null  float64
 16  seller_city                    112650 non-null  object 
 17  geolocation_lat                112397 non-null  float64
 18  geolocation_lng                112397 non-null  float64
 19  customer_id                    113425 non-null  object 
 20  customer_unique_id             113425 non-null  object 
 21  customer_zip_code_prefix       113425 non-null  int64  
 22  customer_city                  113425 non-null  object 
 23  customer_state                 113425 non-null  object 
 24  order_status                   113425 non-null  object 
 25  order_purchase_timestamp       113425 non-null  object 
 26  order_approved_at              113264 non-null  object 
 27  order_delivered_carrier_date   111457 non-null  object 
 28  order_delivered_customer_date  110196 non-null  object 
 29  order_estimated_delivery_date  113425 non-null  object 
 30  review_id                      112464 non-null  object 
 31  review_score                   113425 non-null  float64
 32  review_comment_title           13505 non-null   object 
 33  review_comment_message         47928 non-null   object 
 34  review_creation_date           112464 non-null  object 
 35  review_answer_timestamp        112464 non-null  object 
 36  payment_sequential             113422 non-null  float64
 37  payment_type                   113422 non-null  object 
 38  payment_installments           113422 non-null  float64
 39  payment_value                  113422 non-null  float64
dtypes: float64(17), int64(1), object(22)
memory usage: 35.5+ MB
</code></pre><div id=df-8ca1b7e1-7c2f-4e16-9055-689b4010a591><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>order_id</th><th>order_item_id</th><th>product_id</th><th>seller_id</th><th>shipping_limit_date</th><th>price</th><th>freight_value</th><th>product_category_name</th><th>product_name_lenght</th><th>product_description_lenght</th><th>...</th><th>review_id</th><th>review_score</th><th>review_comment_title</th><th>review_comment_message</th><th>review_creation_date</th><th>review_answer_timestamp</th><th>payment_sequential</th><th>payment_type</th><th>payment_installments</th><th>payment_value</th></tr></thead><tbody><tr><th>0</th><td>00010242fe8c5a6d1ba2dd792cb16214</td><td>1.0</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-09-19 09:45:35</td><td>58.9</td><td>13.29</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>...</td><td>97ca439bc427b48bc1cd7177abe71365</td><td>5.0</td><td>NaN</td><td>Perfeito, produto entregue antes do combinado.</td><td>2017-09-21 00:00:00</td><td>2017-09-22 10:57:03</td><td>1.0</td><td>credit_card</td><td>2.0</td><td>72.19</td></tr><tr><th>1</th><td>130898c0987d1801452a8ed92a670612</td><td>1.0</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-07-05 02:44:11</td><td>55.9</td><td>17.96</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>...</td><td>b11cba360bbe71410c291b764753d37f</td><td>5.0</td><td>NaN</td><td>lannister como sempre, entregou certinho e den...</td><td>2017-07-14 00:00:00</td><td>2017-07-17 12:50:07</td><td>1.0</td><td>boleto</td><td>1.0</td><td>73.86</td></tr><tr><th>2</th><td>532ed5e14e24ae1f0d735b91524b98b9</td><td>1.0</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2018-05-23 10:56:25</td><td>64.9</td><td>18.33</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>...</td><td>af01c4017c5ab46df6cc810e069e654a</td><td>4.0</td><td>super recomendo</td><td>carrinho muito bonito</td><td>2018-06-05 00:00:00</td><td>2018-06-06 21:41:12</td><td>1.0</td><td>credit_card</td><td>2.0</td><td>83.23</td></tr><tr><th>3</th><td>6f8c31653edb8c83e1a739408b5ff750</td><td>1.0</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-08-07 18:55:08</td><td>58.9</td><td>16.17</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>...</td><td>8304ff37d8b16b57086fa283fe0c44f8</td><td>5.0</td><td>NaN</td><td>NaN</td><td>2017-08-10 00:00:00</td><td>2017-08-13 03:35:17</td><td>1.0</td><td>credit_card</td><td>3.0</td><td>75.07</td></tr><tr><th>4</th><td>7d19f4ef4d04461989632411b7e588b9</td><td>1.0</td><td>4244733e06e7ecb4970a6e2683c13e61</td><td>48436dade18ac8b2bce089ec2a041202</td><td>2017-08-16 22:05:11</td><td>58.9</td><td>13.29</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>...</td><td>426f43a82185969503fb3c86241a9535</td><td>5.0</td><td>NaN</td><td>NaN</td><td>2017-08-25 00:00:00</td><td>2017-08-28 00:51:18</td><td>1.0</td><td>credit_card</td><td>4.0</td><td>72.19</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>113420</th><td>2f634e2cebf8c0283e7ef0989f77d217</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>...</td><td>44c6d194170df31929a4ab4b7ae8512a</td><td>1.0</td><td>NaN</td><td>Comprei um perfume Bleu de Chanel , paguei e n...</td><td>2017-10-29 00:00:00</td><td>2017-10-29 16:40:21</td><td>1.0</td><td>credit_card</td><td>12.0</td><td>615.53</td></tr><tr><th>113421</th><td>2b0edc4c59d83dcef85466718c36a317</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>...</td><td>62729f1cf3b504674bb4043189c4416f</td><td>2.0</td><td>NaN</td><td>NaN</td><td>2017-10-19 00:00:00</td><td>2017-10-19 02:37:06</td><td>1.0</td><td>credit_card</td><td>1.0</td><td>112.91</td></tr><tr><th>113422</th><td>81b7c7bbc8ec003eeb67d87441a6a148</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>...</td><td>abbfacb2964f74f6487c9c10ac46daa6</td><td>3.0</td><td>NaN</td><td>NaN</td><td>2018-08-15 00:00:00</td><td>2018-08-19 22:35:54</td><td>1.0</td><td>voucher</td><td>1.0</td><td>92.76</td></tr><tr><th>113423</th><td>8b08f0e729f58529ed03e763270f78d5</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>...</td><td>d7cbf05434eb13d1fd5a0dd207c165ec</td><td>1.0</td><td>NaN</td><td>O produto estava anunciado no site, mas não ti...</td><td>2017-09-29 00:00:00</td><td>2017-09-29 13:03:23</td><td>1.0</td><td>credit_card</td><td>1.0</td><td>136.50</td></tr><tr><th>113424</th><td>9b932dca249f9971b86dde2f2d7ad412</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>...</td><td>93514264c4caad00a9a2de8211661bd7</td><td>1.0</td><td>NaN</td><td>NaN</td><td>2017-12-09 00:00:00</td><td>2017-12-09 11:28:09</td><td>1.0</td><td>credit_card</td><td>1.0</td><td>66.42</td></tr></tbody></table><p>113425 rows × 40 columns</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>finalMergedata</span> <span class=o>=</span> <span class=n>finalMerge</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=s1>&#39;order_item_id&#39;</span><span class=p>,</span> <span class=s1>&#39;seller_id&#39;</span><span class=p>,</span> <span class=s1>&#39;shipping_limit_date&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;seller_zip_code_prefix&#39;</span><span class=p>,</span> <span class=s1>&#39;seller_city&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_zip_code_prefix&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_city&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;customer_state&#39;</span><span class=p>,</span> <span class=s1>&#39;order_status&#39;</span><span class=p>,</span> <span class=s1>&#39;order_purchase_timestamp&#39;</span><span class=p>,</span><span class=s1>&#39;review_id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;order_purchase_timestamp&#39;</span><span class=p>,</span> <span class=s1>&#39;review_comment_title&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;review_comment_message&#39;</span><span class=p>,</span> <span class=s1>&#39;order_approved_at&#39;</span><span class=p>,</span> <span class=s1>&#39;review_creation_date&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;payment_type&#39;</span><span class=p>,</span> <span class=s1>&#39;payment_installments&#39;</span><span class=p>,</span> <span class=s1>&#39;order_delivered_carrier_date&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;order_delivered_customer_date&#39;</span><span class=p>,</span> <span class=s1>&#39;order_estimated_delivery_date&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=s1>&#39;review_answer_timestamp&#39;</span><span class=p>,</span> <span class=s1>&#39;payment_sequential&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>finalMergedata</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=b5-span-stylecolorf1a424span-imputing-missing-values--train-test-splitb><b>5 <span style=color:#f1a424>|</span> Imputing Missing Values & Train Test Split</b><a hidden class=anchor aria-hidden=true href=#b5-span-stylecolorf1a424span-imputing-missing-values--train-test-splitb>#</a></h2><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>5.1 |</span></b> KNN Imputation</b></p></div><ul><li>Below the <code>sklearn.KNNImputer</code> package is used to imput missing numerical values from the final dataframe using <code>n=5</code> nearest neighbors</li><li>All remaining null or missing values are dropped</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>to_impute</span> <span class=o>=</span> <span class=n>finalMergedata</span><span class=p>[[</span><span class=s1>&#39;product_name_lenght&#39;</span><span class=p>,</span> <span class=s1>&#39;product_description_length&#39;</span><span class=p>,</span> <span class=s1>&#39;product_photos_qty&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=s1>&#39;geolocation_lat&#39;</span><span class=p>,</span> <span class=s1>&#39;geolocation_lng&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>imputer</span> <span class=o>=</span> <span class=n>KNNImputer</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>impute_fit</span> <span class=o>=</span> <span class=n>imputer</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>to_impute</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^\s*$&#39;</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=n>regex</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>value</span><span class=o>=</span><span class=s2>&#34;other&#34;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>finalMergedata</span><span class=p>[[</span><span class=s1>&#39;product_name_lenght&#39;</span><span class=p>,</span> <span class=s1>&#39;product_description_lenght&#39;</span><span class=p>,</span> <span class=s1>&#39;product_photos_qty&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=s1>&#39;geolocation_lat&#39;</span><span class=p>,</span> <span class=s1>&#39;geolocation_lng&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>impute_fit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>finalMergedata</span> <span class=o>=</span> <span class=n>finalMergedata</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>finalMergedata</span>
</span></span></code></pre></td></tr></table></div></div><div id=df-6bb9e26a-5245-40d9-99d4-6d78164763be><div class=colab-df-container><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>product_id</th><th>price</th><th>freight_value</th><th>product_category_name</th><th>product_name_lenght</th><th>product_description_lenght</th><th>product_photos_qty</th><th>product_weight_g</th><th>product_length_cm</th><th>product_height_cm</th><th>product_width_cm</th><th>geolocation_lat</th><th>geolocation_lng</th><th>customer_unique_id</th><th>review_score</th><th>payment_value</th></tr></thead><tbody><tr><th>0</th><td>4244733e06e7ecb4970a6e2683c13e61</td><td>58.9</td><td>13.29</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td><td>-22.498183</td><td>-44.123614</td><td>871766c5855e863f6eccc05f988b23cb</td><td>5.0</td><td>72.19</td></tr><tr><th>1</th><td>4244733e06e7ecb4970a6e2683c13e61</td><td>55.9</td><td>17.96</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td><td>-22.498183</td><td>-44.123614</td><td>0fb8e3eab2d3e79d92bb3fffbb97f188</td><td>5.0</td><td>73.86</td></tr><tr><th>2</th><td>4244733e06e7ecb4970a6e2683c13e61</td><td>64.9</td><td>18.33</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td><td>-22.498183</td><td>-44.123614</td><td>3419052c8c6b45daf79c1e426f9e9bcb</td><td>4.0</td><td>83.23</td></tr><tr><th>3</th><td>4244733e06e7ecb4970a6e2683c13e61</td><td>58.9</td><td>16.17</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td><td>-22.498183</td><td>-44.123614</td><td>e7c828d22c0682c1565252deefbe334d</td><td>5.0</td><td>75.07</td></tr><tr><th>4</th><td>4244733e06e7ecb4970a6e2683c13e61</td><td>58.9</td><td>13.29</td><td>cool_stuff</td><td>58.0</td><td>598.0</td><td>4.0</td><td>650.0</td><td>28.0</td><td>9.0</td><td>14.0</td><td>-22.498183</td><td>-44.123614</td><td>0bb98ba72dcc08e95f9d8cc434e9a2cc</td><td>5.0</td><td>72.19</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>112645</th><td>f739e9151702508b18f796c53005e5e9</td><td>119.9</td><td>16.14</td><td>moveis_decoracao</td><td>44.0</td><td>533.0</td><td>2.0</td><td>1000.0</td><td>69.0</td><td>11.0</td><td>11.0</td><td>-25.450057</td><td>-49.260674</td><td>3d50a44231c2a153219cef76ee3e445d</td><td>4.0</td><td>136.04</td></tr><tr><th>112646</th><td>f4135cbdece8245560f7be179533797a</td><td>209.0</td><td>16.21</td><td>eletronicos</td><td>32.0</td><td>1306.0</td><td>3.0</td><td>500.0</td><td>17.0</td><td>9.0</td><td>25.0</td><td>-25.379062</td><td>-49.227004</td><td>52a953541861bbb4b79b39df24e00243</td><td>4.0</td><td>225.21</td></tr><tr><th>112647</th><td>69c590f7ffc7bf8db97190b6cb6ed62e</td><td>6729.0</td><td>193.21</td><td>pcs</td><td>50.0</td><td>1935.0</td><td>4.0</td><td>5660.0</td><td>54.0</td><td>18.0</td><td>47.0</td><td>-23.306545</td><td>-51.153471</td><td>459bef486812aa25204be022145caa62</td><td>3.5</td><td>6922.21</td></tr><tr><th>112648</th><td>5ff4076c0f01eeba4f728c9e3fa2653c</td><td>27.9</td><td>14.44</td><td>bebidas</td><td>28.0</td><td>242.0</td><td>1.0</td><td>2000.0</td><td>19.0</td><td>38.0</td><td>19.0</td><td>-23.567864</td><td>-46.592424</td><td>ddb2249e0316d365ceae561c0f011bce</td><td>5.0</td><td>84.68</td></tr><tr><th>112649</th><td>5ff4076c0f01eeba4f728c9e3fa2653c</td><td>27.9</td><td>14.44</td><td>bebidas</td><td>28.0</td><td>242.0</td><td>1.0</td><td>2000.0</td><td>19.0</td><td>38.0</td><td>19.0</td><td>-23.567864</td><td>-46.592424</td><td>ddb2249e0316d365ceae561c0f011bce</td><td>5.0</td><td>84.68</td></tr></tbody></table><p>112647 rows × 16 columns</p></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>finalMergedata</span><span class=p>[</span><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>og_name_to_idx</span><span class=o>.</span><span class=n>keys</span><span class=p>())]</span>
</span></span></code></pre></td></tr></table></div></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>5.2 |</span></b> Label Encoding Non-Numeric Values</b></p></div><ul><li>the <code>LabelEncoder</code> class from the <code>sklearn.preprocessing</code> module is used to encode non-numeric values</li><li>Predictors (in the form of customer IDs) and classes (in the form of a matrix of product information) is created to be used in the model</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>training_data</span> <span class=o>=</span> <span class=n>finalMergedata</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s1>&#39;customer_unique_id&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>training_data</span> <span class=o>=</span> <span class=n>training_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;product_id&#39;</span><span class=p>,</span> <span class=s1>&#39;product_category_name&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>training_data</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>product_id_le</span> <span class=o>=</span> <span class=n>preprocessing</span><span class=o>.</span><span class=n>LabelEncoder</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>product_id_le</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_id_le</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cat_le</span> <span class=o>=</span> <span class=n>preprocessing</span><span class=o>.</span><span class=n>LabelEncoder</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cat_le</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cat_le</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>training_data</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>len</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>training_data</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]))</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>training_data</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>X</span> <span class=o>=</span> <span class=n>training_data</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>X</span><span class=p>,</span> <span class=n>y</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=b6-span-stylecolorf1a424span-knn-classifier-model--recommender-systemb><b>6 <span style=color:#f1a424>|</span> KNN Classifier Model & Recommender System</b><a hidden class=anchor aria-hidden=true href=#b6-span-stylecolorf1a424span-knn-classifier-model--recommender-systemb>#</a></h2><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>6.1 |</span></b> k-Nearest Neighbor Model</b></p></div><ul><li>The basic outline for a KNN classifier is presented, with a <code>metric</code> parameter modifying the distances of each product (and associated product category), increasing the distance for an object with less cosine similarity, and decreasing the distance for two products with categories of higher cosine similarity</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>weights</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>20000000</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>metric</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>cat_name_u</span> <span class=o>=</span> <span class=n>cat_le</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>u</span><span class=p>[</span><span class=mi>0</span><span class=p>])])</span>
</span></span><span class=line><span class=cl>  <span class=n>cat_name_v</span> <span class=o>=</span> <span class=n>cat_le</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>])])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>u_v</span> <span class=o>=</span> <span class=n>u</span> <span class=o>-</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>  <span class=n>u_v</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>multiply</span><span class=p>(</span><span class=n>u_v</span><span class=p>,</span> <span class=n>weights</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>u_v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>20000000</span> <span class=o>-</span> <span class=n>similarities_df</span><span class=p>[</span><span class=n>og_name_to_idx</span><span class=p>[</span><span class=n>cat_name_u</span><span class=p>[</span><span class=mi>0</span><span class=p>]]][</span><span class=n>og_name_to_idx</span><span class=p>[</span><span class=n>cat_name_v</span><span class=p>[</span><span class=mi>0</span><span class=p>]]]</span>      
</span></span><span class=line><span class=cl>  <span class=n>u_v</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span> <span class=o>-</span> <span class=n>u_v</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span> <span class=o>*</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>  <span class=n>dist</span> <span class=o>=</span> <span class=n>norm</span><span class=p>(</span><span class=n>u_v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>dist</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>neigh</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>metric</span><span class=o>=</span><span class=n>metric</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>neigh</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>probs</span> <span class=o>=</span> <span class=n>neigh</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>([[</span><span class=mi>63</span><span class=p>,</span><span class=mf>101.65</span><span class=p>,</span><span class=mf>18.590</span><span class=p>,</span><span class=mf>53.0</span><span class=p>,</span><span class=mf>596.0</span><span class=p>,</span><span class=mf>6.0</span><span class=p>,</span><span class=mf>300.0</span><span class=p>,</span><span class=mf>20.0</span><span class=p>,</span><span class=mf>16.0</span><span class=p>,</span><span class=mf>16.0</span><span class=p>,</span><span class=o>-</span><span class=mf>23.537922</span><span class=p>,</span><span class=o>-</span><span class=mf>46.477696</span><span class=p>,</span><span class=mf>5.0</span><span class=p>,</span><span class=mf>120.240</span><span class=p>]])</span>
</span></span><span class=line><span class=cl><span class=n>probs</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>probs</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=o>-</span><span class=mi>4</span><span class=p>)[</span><span class=o>-</span><span class=mi>4</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>ind</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>training_data</span><span class=p>[(</span><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>9281</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>18733</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>29589</span><span class=p>)</span> <span class=o>|</span> 
</span></span><span class=line><span class=cl>                       <span class=p>(</span><span class=n>finalMergedata</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)])</span>
</span></span></code></pre></td></tr></table></div></div><div style=color:#fff;display:fill;border-radius:8px;background-color:#03112a;font-size:150%;letter-spacing:1px;background-image:url(https://miro.medium.com/v2/resize:fit:1024/format:webp/1*WO2tpR1ElY2QcVLQrhwbpQ.jpeg)><p style=padding:8px;color:#fff><b><b><span style=color:#f1a424>6.2 |</span></b> Recommender System</b></p></div><ul><li>Finally, everything is put together to obtain a recommendation based on the specific parameters of an individual customer which is implemented in the <code>get_recommendation</code> function</li><li>As per the request of this datathon, only the top 3 recommendations are returned</li><li>Another function is defined, <code>get_recommendation_for_group</code> allowing the input of a group of customer IDs for tailored recommendations to each customer</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>customer_order_info</span> <span class=o>=</span> <span class=n>finalMergedata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>customer_order_info</span> <span class=o>=</span> <span class=n>customer_order_info</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>customer_order_info</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># input 1 customer id, get a list of recommendation, return none is customer has no previous order</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_recommendation</span><span class=p>(</span><span class=n>customer_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span> <span class=o>=</span> <span class=n>customer_order_info</span><span class=p>[</span><span class=n>customer_order_info</span><span class=p>[</span><span class=s1>&#39;customer_unique_id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>customer_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># use product with review &gt;= 3</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span> <span class=o>=</span> <span class=n>specific_customer_order_info</span><span class=p>[</span><span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;review_score&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># sort by review score, break ties with most recent purcahse</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span> <span class=o>=</span> <span class=n>specific_customer_order_info</span><span class=o>.</span><span class=n>sort_values</span><span class=p>([</span><span class=s1>&#39;review_score&#39;</span><span class=p>,</span> <span class=s1>&#39;order_purchase_timestamp&#39;</span><span class=p>],</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># drop extra info we don&#39;t need and encode</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span> <span class=o>=</span> <span class=n>specific_customer_order_info</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;customer_unique_id&#39;</span><span class=p>,</span> <span class=s1>&#39;order_purchase_timestamp&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>product_id_le</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cat_le</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_category_name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>specific_customer_order_info</span> <span class=o>=</span> <span class=n>specific_customer_order_info</span><span class=o>.</span><span class=n>reindex</span><span class=p>(</span><span class=n>finalMergedata</span><span class=o>.</span><span class=n>columns</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>purchased_product</span> <span class=o>=</span> <span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># use top 3</span>
</span></span><span class=line><span class=cl>    <span class=n>index</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=n>probs</span> <span class=o>=</span> <span class=n>neigh</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>specific_customer_order_info</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>probs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>probs</span><span class=p>[</span><span class=n>purchased_product</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=o>-</span><span class=mi>5</span><span class=p>)[</span><span class=o>-</span><span class=mi>5</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>probs</span><span class=p>[</span><span class=n>ind</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>5</span> <span class=ow>and</span> <span class=n>index</span> <span class=o>&lt;</span> <span class=n>specific_customer_order_info</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>probs</span> <span class=o>=</span> <span class=n>neigh</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>specific_customer_order_info</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:</span><span class=n>index</span><span class=p>,</span> <span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>probs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>probs</span><span class=p>[</span><span class=n>purchased_product</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>ind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argpartition</span><span class=p>(</span><span class=n>probs</span><span class=p>,</span> <span class=o>-</span><span class=mi>5</span><span class=p>)[</span><span class=o>-</span><span class=mi>5</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>index</span> <span class=o>+=</span> <span class=mi>1</span> 
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>product_id_le</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>ind</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>recommend</span> <span class=o>=</span> <span class=n>get_recommendation</span><span class=p>(</span><span class=s1>&#39;290c77bc529b7ac935b93aa66c333dc3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>customer_order_info</span><span class=p>[</span><span class=n>customer_order_info</span><span class=p>[</span><span class=s1>&#39;customer_unique_id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;290c77bc529b7ac935b93aa66c333dc3&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>customer_order_info</span><span class=p>[</span><span class=n>customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>recommend</span><span class=p>)]</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_recommendation_for_group</span><span class=p>(</span><span class=n>customer_ids</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>specific_customer_order_info</span> <span class=o>=</span> <span class=n>customer_order_info</span><span class=p>[</span><span class=n>customer_order_info</span><span class=p>[</span><span class=s1>&#39;customer_unique_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>customer_ids</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=n>bought</span> <span class=o>=</span> <span class=n>specific_customer_order_info</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>recommendation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=nb>id</span> <span class=ow>in</span> <span class=n>customer_ids</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>rec</span> <span class=o>=</span> <span class=n>get_recommendation</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>id</span><span class=p>,</span> <span class=n>rec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>recommendation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>recommendation</span><span class=p>,</span> <span class=n>get_recommendation</span><span class=p>(</span><span class=nb>id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>recommendation</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>recommendation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1># filter out bought items</span>
</span></span><span class=line><span class=cl>  <span class=n>recommendation</span> <span class=o>=</span> <span class=n>recommendation</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>logical_not</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>recommendation</span><span class=p>,</span> <span class=n>bought</span><span class=o>.</span><span class=n>to_numpy</span><span class=p>()))]</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>recommendation</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>customer_ids</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;290c77bc529b7ac935b93aa66c333dc3&#39;</span><span class=p>,</span> <span class=s1>&#39;0fb8e3eab2d3e79d92bb3fffbb97f188&#39;</span><span class=p>,</span> <span class=s1>&#39;3419052c8c6b45daf79c1e426f9e9bcb&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>recommendation</span> <span class=o>=</span> <span class=n>get_recommendation_for_group</span><span class=p>(</span><span class=n>customer_ids</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>recommendation</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>display</span><span class=p>(</span><span class=n>customer_order_info</span><span class=p>[</span><span class=n>customer_order_info</span><span class=p>[</span><span class=s1>&#39;customer_unique_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>customer_ids</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=n>products</span><span class=p>[</span><span class=n>products</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>recommendation</span><span class=p>)]</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://sunnyson.dev/tags/cosine-similarity/>cosine-similarity</a></li><li><a href=https://sunnyson.dev/tags/shopping-recommender/>shopping-recommender</a></li><li><a href=https://sunnyson.dev/tags/recommender-system/>recommender-system</a></li><li><a href=https://sunnyson.dev/tags/joining-tables/>joining-tables</a></li></ul><nav class=paginav><a class=next href=https://sunnyson.dev/projects/xg-boost-clf/><span class=title>Next »</span><br><span>XGBoost Classifier for Music Recommendation</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share NYU x DSC Datathon Olist Recommender System on twitter" href="https://twitter.com/intent/tweet/?text=NYU%20x%20DSC%20Datathon%20Olist%20Recommender%20System&url=https%3a%2f%2fsunnyson.dev%2fprojects%2fnyu-x-dsc-recommender%2f&hashtags=cosine-similarity%2cshopping-recommender%2crecommender-system%2cjoining-tables"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share NYU x DSC Datathon Olist Recommender System on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fsunnyson.dev%2fprojects%2fnyu-x-dsc-recommender%2f&title=NYU%20x%20DSC%20Datathon%20Olist%20Recommender%20System&summary=NYU%20x%20DSC%20Datathon%20Olist%20Recommender%20System&source=https%3a%2f%2fsunnyson.dev%2fprojects%2fnyu-x-dsc-recommender%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share NYU x DSC Datathon Olist Recommender System on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsunnyson.dev%2fprojects%2fnyu-x-dsc-recommender%2f&title=NYU%20x%20DSC%20Datathon%20Olist%20Recommender%20System"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share NYU x DSC Datathon Olist Recommender System on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsunnyson.dev%2fprojects%2fnyu-x-dsc-recommender%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></div></footer></article></main><footer class=footer style=padding-top:18px;padding-bottom:18px><div class=social-icons style=padding-bottom:0><a style=border-bottom:none href=https://twitter.com/__sunnyson__ rel=me title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a style=border-bottom:none href=https://github.com/sunnydigital rel=me title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a style=border-bottom:none href=https://www.linkedin.com/in/sunny-son/ rel=me title=Linkedin data-proofer-ignore><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a style=border-bottom:none href="https://scholar.google.com/citations?user=tGaMcikAAAAJ&hl=en" rel=me title=Googlescholar><svg role="img" viewBox="0 0 24 25" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5.242 13.769.5 9.5 12 1l11.5 9-5.242 3.769C17.548 11.249 14.978 9.5 12 9.5c-2.977.0-5.548 1.748-6.758 4.269zM12 10a7 7 0 100 14 7 7 0 000-14z"/></svg></a><a style=border-bottom:none href=https://huggingface.co/sunnydigital rel=me title=Huggingface><svg xmlns="http://www.w3.org/2000/svg" width="32" height="29" viewBox="0 0 32 29" fill="currentcolor"><path d="M30.6531 23.6767C30.8096 23.4417 30.9146 23.1762 30.9612 22.8978 31.0076 22.6192 30.9946 22.334 30.9231 22.0609 30.8193 21.6667 30.6049 21.3389 30.3142 21.1034 30.4543 20.8731 30.5462 20.6169 30.5843 20.35 30.6682 19.7697 30.4756 19.1903 30.0421 18.7178 29.7049 18.3501 29.2277 18.1478 28.6996 18.1478 28.6382 18.1478 28.5757 18.1511 28.512 18.1573 28.9123 16.878 29.1152 15.5451 29.1138 14.2047 29.1138 6.91219 23.202 1 15.9093 1 8.6165 1 2.70399 6.91156 2.70399 14.2047 2.70267 15.5417 2.90456 16.8712 3.30275 18.1476H3.28867C2.76055 18.1476 2.28353 18.3498 1.94619 18.7175 1.51291 19.1895 1.32008 19.7695 1.40399 20.3497 1.44222 20.6165 1.53417 20.873 1.6743 21.1033 1.38336 21.3386 1.169 21.6664 1.06525 22.0606.99372 22.3339.98083 22.619 1.02742 22.8976c.0466.278500000000001.1516.5441.30813.7791C1.30774 23.7201 1.28211 23.765 1.25789 23.8111.996954 24.3065.980095 24.8664 1.21056 25.3878 1.55994 26.178 2.42774 26.8005 4.1132 27.4687 5.16117 27.8844 6.12103 28.1501 6.12947 28.1525 7.51572 28.512 8.76947 28.6947 9.85478 28.6947 11.637 28.6947 12.9667 28.2072 13.8159 27.244 15.2527 27.472 16.7171 27.4636 18.1513 27.2194 18.9995 28.1987 20.3368 28.6947 22.134 28.6947 23.2193 28.6947 24.4731 28.512 25.8592 28.1525 25.8677 28.1501 26.8271 27.8844 27.8756 27.4687 29.561 26.8005 30.429 26.178 30.7782 25.3878 31.0085 24.8664 30.9918 24.3065 30.7307 23.8111 30.707 23.7647 30.6807 23.7197 30.6531 23.6767zM13.2082 25.7362C13.1351 25.864 13.0568 25.9889 12.9735 26.1103 12.754 26.4317 12.4652 26.6773 12.1301 26.8598 11.4895 27.2092 10.6785 27.3312 9.85478 27.3312 8.55338 27.3312 7.21931 27.0267 6.47166 26.8328 6.43478 26.8233 1.88822 25.539 2.46385 24.4459 2.56072 24.262 2.72008 24.1886 2.92086 24.1886c.81047.0 2.28625 1.2069 2.92047 1.2069.14172.0.24172-.0603999999999978.2825-.2075.27031-.9694-4.10828-1.3769-3.73953-2.7807.065-.2484.24158-.3493.4897-.3493C3.94556 22.0578 6.35056 23.9423 6.85353 23.9423 6.89213 23.9423 6.91977 23.9309 6.93477 23.9072 6.93695 23.9036 6.93916 23.9001 6.94119 23.8964 7.17728 23.5065 7.0418 23.2231 5.42445 22.2325l-.15531-.0945c-1.77984-1.0772-3.02906-1.7255-2.31859-2.499C3.03227 19.5498 3.1482 19.5103 3.28899 19.5103c.16687.0.3689.0557999999999979.5914.1495.94.3964 2.24283 1.4775 2.78705 1.9489C6.75305 21.6831 6.83811 21.7583 6.92258 21.8339c0 0 .68908.7166 1.10564.7166C8.12416 22.5505 8.20555 22.5126 8.2607 22.4192 8.55619 21.9211 5.51649 19.6176 5.34508 18.6672 5.22883 18.0233 5.42664 17.697 5.79227 17.697 5.96617 17.697 6.17836 17.7711 6.41258 17.9197 7.13914 18.3808 8.54195 20.7914 9.05555 21.7292 9.22773 22.0434 9.52164 22.1762 9.78648 22.1762 10.312 22.1762 10.7227 21.6539 9.83461 20.9901 8.49977 19.9914 8.96822 18.3589 9.60525 18.2584 9.63244 18.254 9.65992 18.2519 9.68727 18.2519 10.2666 18.2519 10.5221 19.2501 10.5221 19.2501s.7491 1.881 2.0358 3.1668c1.1675 1.167 1.3306 2.1246.6503 3.3193zM17.369 25.9565 17.3023 25.9645 17.1885 25.9775C17.1287 25.9837 17.0687 25.9897 17.0085 25.9951L16.9499 26.0005 16.8963 26.005 16.8204 26.0111 16.7365 26.0172 16.6528 26.0226 16.6342 26.0239C16.6123 26.0251 16.5904 26.0265 16.5682 26.0276L16.5403 26.0292C16.5143 26.0306 16.4884 26.0319 16.4621 26.033L16.3713 26.0369 16.289 26.0397 16.234 26.0412H16.206C16.1888 26.0412 16.1718 26.0422 16.1546 26.0423H16.1274C16.1103 26.0423 16.0932 26.0423 16.076 26.0431L16.006 26.044H15.9084C15.8317 26.044 15.7551 26.0433 15.6788 26.0417L15.617 26.0403C15.5993 26.0403 15.5817 26.0395 15.5643 26.0389L15.4987 26.037 15.4173 26.0339 15.3438 26.0306 15.3249 26.0298 15.2551 26.0262C15.2356 26.0251 15.2163 26.0242 15.197 26.0228L15.1518 26.0201C15.0951 26.0165 15.0384 26.0126 14.9817 26.0083L14.9223 26.0034C14.8973 26.0015 14.8723 25.9992 14.8474 25.997 14.8182 25.9945 14.789 25.9917 14.7598 25.9889 14.7109 25.9844 14.662 25.9794 14.6131 25.974H14.6107c.7141-1.5929.353-3.0807-1.09-4.5225C12.5743 20.5064 11.9448 19.1108 11.8142 18.8044c-.2644-.9071-.9641-1.9154-2.12614-1.9154C9.58978 16.889 9.49166 16.8969 9.39463 16.9122 8.88556 16.9923 8.44056 17.2853 8.12306 17.7262 7.77994 17.2995 7.4465 16.9603 7.14494 16.7687c-.45469-.2882-.90845-.4345-1.35049-.4345C5.24274 16.3342 4.74961 16.5608 4.40586 16.9717L4.39711 16.9822C4.39055 16.9551 4.3843 16.9281 4.37789 16.9009L4.37711 16.8973C4.31169 16.6176 4.25677 16.3356 4.21242 16.0517 4.21242 16.0498 4.21242 16.048 4.21149 16.0461 4.20805 16.0247 4.20492 16.0031 4.20164 15.9817 4.19203 15.9183 4.18302 15.8547 4.17461 15.7911 4.17086 15.7622 4.1668 15.7333 4.1632 15.7044L4.15258 15.6176C4.14914 15.5887 4.14633 15.5625 4.1432 15.535L4.14228 15.5281C4.1298 15.4156 4.11886 15.3031 4.10945 15.1903L4.10602 15.147 4.10055 15.0733C4.09899 15.0531 4.09742 15.0328 4.09633 15.0125 4.09633 15.0076 4.09555 15.003 4.09539 14.9984 4.09142 14.9419 4.08803 14.8851 4.08524 14.8284 4.08367 14.7989 4.08211 14.7695 4.08086 14.7398L4.07774 14.6623 4.07695 14.6389 4.07445 14.5675 4.07289 14.5067C4.07289 14.4825 4.07164 14.4583 4.07133 14.434 4.07086 14.4098 4.07024 14.3833 4.07008 14.3576 4.06977 14.332 4.07008 14.3067 4.0693 14.2812 4.06867 14.2556 4.0693 14.2301 4.0693 14.2047c0-6.53954 5.30171-11.84126 11.8419-11.84126 6.54.0 11.8415 5.30156 11.8415 11.84126V14.3576C27.7527 14.3831 27.752 14.4087 27.7515 14.434 27.7515 14.4551 27.7506 14.4759 27.7499 14.4973 27.7499 14.5161 27.7492 14.535 27.7485 14.5531 27.7485 14.577 27.7471 14.6009 27.7463 14.6248V14.6267L27.7431 14.7097C27.742 14.7339 27.741 14.7583 27.7398 14.7825L27.739 14.7997 27.7348 14.8772C27.7256 15.0433 27.7129 15.209 27.6971 15.3747V15.3767C27.6945 15.4039 27.6918 15.4311 27.6888 15.4583L27.6818 15.5225 27.6679 15.6481 27.6599 15.7117 27.6501 15.7865C27.6465 15.8137 27.6429 15.8411 27.6388 15.8681 27.6348 15.8986 27.6302 15.9289 27.6257 15.9592L27.6149 16.0309 27.6021 16.1122C27.5977 16.1392 27.5931 16.1661 27.5881 16.193 27.5829 16.22 27.5788 16.2469 27.5742 16.2737 27.5648 16.3275 27.5549 16.3812 27.5446 16.4348 27.5288 16.515 27.5127 16.595 27.4962 16.675L27.479 16.7542C27.4734 16.7806 27.4673 16.8072 27.4613 16.8336 27.1281 16.5097 26.6867 16.3333 26.1999 16.3333 25.7582 16.3333 25.304 16.4794 24.8495 16.7676 24.5479 16.9592 24.2146 17.2986 23.8713 17.7251 23.5534 17.2842 23.1084 16.9912 22.5996 16.9111 22.5026 16.8958 22.4045 16.888 22.3062 16.888c-1.1624.0-1.8616 1.0082-2.1261 1.9153-.1313.3064-.7609 1.702-1.7081 2.6486-1.4421 1.4371-1.8058 2.9182-1.103 4.5046zm12.2252-3.1889L29.5895 22.7815C29.5776 22.813 29.5638 22.8436 29.5484 22.8733 29.5367 22.8951 29.524 22.9164 29.5102 22.937 29.4842 22.9759 29.4556 23.0131 29.4245 23.0481 29.4173 23.0562 29.4104 23.0644 29.4023 23.0723 29.391 23.0844 29.3796 23.0962 29.3679 23.1078 29.1576 23.3162 28.837 23.499 28.4745 23.6667 28.4334 23.6853 28.3917 23.7039 28.3496 23.7226L28.3077 23.7412C28.2798 23.7536 28.2518 23.7658 28.2224 23.7778 28.1945 23.79 28.1654 23.8022 28.1363 23.814L28.0492 23.85C27.8452 23.9339 27.6363 24.0139 27.4326 24.0928L27.3454 24.1267 27.2593 24.1605C27.202 24.1828 27.1454 24.2051 27.0898 24.2275L27.0068 24.2609 26.9252 24.2942 26.8852 24.3111C26.8585 24.3222 26.8324 24.3333 26.8063 24.3444 26.2068 24.6017 25.7754 24.8634 25.866 25.1881 25.8685 25.1973 25.8713 25.2061 25.8745 25.2147 25.8826 25.2387 25.8937 25.2614 25.9076 25.2828 25.9157 25.2955 25.9251 25.3075 25.9356 25.3184 26.0421 25.4292 26.236 25.4117 26.4806 25.3237 26.5149 25.3111 26.5492 25.298 26.5831 25.2842L26.6043 25.2755C26.6602 25.2517 26.7195 25.2251 26.7799 25.1964 26.7951 25.1892 26.8104 25.1823 26.8257 25.1744 27.1248 25.0281 27.4637 24.8312 27.7999 24.652 27.9345 24.5794 28.0709 24.5105 28.209 24.445 28.5274 24.2951 28.8268 24.1889 29.0674 24.1889 29.1804 24.1889 29.2801 24.212 29.3632 24.2651L29.3771 24.2744C29.4293 24.3111 29.4731 24.3583 29.5057 24.413 29.5121 24.4234 29.5184 24.4345 29.5245 24.4459 29.6434 24.6717 29.5438 24.9055 29.3109 25.1347 29.0873 25.3548 28.7395 25.5706 28.3442 25.7703 28.3148 25.7851 28.2854 25.8 28.2556 25.8145c-1.1766.5778-2.7174 1.013-2.7388 1.0185C25.1062 26.9394 24.519 27.079 23.8574 27.1836L23.7596 27.1989 23.7435 27.2012C23.6695 27.2125 23.5952 27.223 23.5209 27.2326 23.4454 27.2428 23.3692 27.252 23.2924 27.2606L23.2784 27.2622C23.0002 27.2942 22.721 27.3155 22.4412 27.3256H22.4371C22.3359 27.3292 22.2348 27.3311 22.1335 27.3311H22.0168C21.8624 27.329 21.7084 27.322 21.5545 27.3101 21.5509 27.3101 21.547 27.3101 21.5434 27.3092 21.4882 27.305 21.4332 27.2998 21.3782 27.2937 21.3212 27.2876 21.2643 27.2808 21.2076 27.2731 21.1702 27.2681 21.1331 27.2625 21.0959 27.2564 21.0581 27.2503 21.0202 27.244 20.9826 27.2375L20.9312 27.2278 20.9273 27.227C20.8731 27.2167 20.8192 27.2053 20.7654 27.1928 20.7342 27.1858 20.7031 27.1789 20.6723 27.1705L20.6537 27.1658C20.6384 27.162 20.6235 27.158 20.6084 27.1539L20.6001 27.1517 20.552 27.1376C20.5345 27.1328 20.517 27.1275 20.4995 27.1223L20.4934 27.1206 20.4479 27.1067C20.4307 27.1014 20.4135 27.0958 20.3965 27.0901L20.3546 27.0762 20.3238 27.0655C20.2942 27.055 20.2646 27.0442 20.2354 27.033L20.2076 27.022 20.1846 27.013C20.1402 26.9951 20.0962 26.9765 20.0526 26.957L20.0237 26.943 20.0188 26.9408C20.0085 26.9359 19.9984 26.9311 19.9881 26.9269 19.9679 26.9172 19.9479 26.9072 19.9281 26.897L19.922 26.894 19.8932 26.8789C19.8421 26.8522 19.7921 26.8237 19.7431 26.7936L19.7162 26.777C19.7027 26.7687 19.6893 26.7601 19.6762 26.7514L19.6412 26.7283 19.6035 26.7023 19.581 26.6862C19.5573 26.6694 19.534 26.6519 19.5112 26.6339L19.4748 26.6059C19.4602 26.5942 19.4459 26.5823 19.4317 26.5703 19.4196 26.5605 19.4079 26.5501 19.3962 26.5398L19.3952 26.539C19.3826 26.528 19.3702 26.5169 19.3579 26.5055 19.3457 26.4944 19.3335 26.4831 19.3217 26.4717L19.3202 26.4703C19.3077 26.4584 19.2956 26.4464 19.2835 26.434 19.2715 26.4219 19.2592 26.4097 19.2474 26.3972 19.2357 26.3848 19.2237 26.3722 19.2121 26.3592 19.2006 26.3464 19.1899 26.3347 19.179 26.322L19.1754 26.3178C19.1648 26.3056 19.1543 26.2933 19.144 26.2806 19.1217 26.2539 19.0999 26.2265 19.079 26.1986 19.0579 26.1705 19.0373 26.1417 19.0171 26.1125L18.9979 26.0837C18.9723 26.0462 18.9473 26.0084 18.9231 25.97 18.9049 25.9423 18.8873 25.9145 18.8701 25.8862 18.859 25.8686 18.8484 25.8508 18.8377 25.8333L18.8334 25.8261C18.8232 25.8089 18.8132 25.792 18.8035 25.775 18.7979 25.7658 18.7926 25.7565 18.7876 25.747 18.7824 25.7373 18.7765 25.7275 18.771 25.7176L18.7621 25.7022 18.7567 25.6922C18.7462 25.6734 18.7359 25.6545 18.7259 25.6355 18.7212 25.627 18.7167 25.6186 18.7118 25.6105L18.6979 25.5834 18.6838 25.5567C18.6487 25.4864 18.6154 25.4151 18.5842 25.343L18.5731 25.3165C18.5659 25.2989 18.5592 25.2814 18.552 25.264 18.5485 25.2556 18.5451 25.2473 18.5421 25.2389 18.5254 25.1956 18.5098 25.1519 18.4954 25.1078 18.4903 25.092 18.4852 25.0765 18.4806 25.0609 18.4693 25.0255 18.4592 24.9897 18.4501 24.9536 18.439 24.9115 18.4292 24.8692 18.4209 24.8265 18.4192 24.818 18.4174 24.8094 18.416 24.8011 18.4079 24.7594 18.4013 24.7173 18.3962 24.6751 18.3949 24.6669 18.394 24.6586 18.3931 24.6503L18.3904 24.625C18.387 24.5919 18.3843 24.5586 18.3827 24.5253 18.3827 24.5169 18.382 24.5084 18.3817 24.5003 18.3809 24.4837 18.3806 24.4672 18.3804 24.4506 18.3717 23.783 18.7095 23.1411 19.4318 22.419c1.2867-1.2854 2.0358-3.1665 2.0358-3.1665S21.4877 19.1736 21.5296 19.06C21.5354 19.0442 21.5415 19.028 21.5484 19.0109 21.5728 18.9473 21.6002 18.8848 21.6307 18.8239L21.6368 18.8122C21.6627 18.7603 21.6912 18.7097 21.7218 18.6605 21.729 18.649 21.7359 18.6378 21.7438 18.6264 21.7668 18.5925 21.791 18.5594 21.8165 18.5273 21.8304 18.51 21.8456 18.4928 21.8607 18.4761 21.8668 18.4695 21.8727 18.463 21.8792 18.4567 21.9537 18.3797 22.0388 18.3169 22.1352 18.2834L22.1474 18.2794C22.1556 18.2767 22.1637 18.2742 22.172 18.2719 22.1815 18.2694 22.191 18.2672 22.2009 18.2651L22.2054 18.2642C22.2257 18.2601 22.2463 18.2575 22.2671 18.2561H22.2688C22.2796 18.2561 22.2906 18.255 22.3017 18.255 22.3156 18.255 22.3285 18.255 22.3421 18.2564 22.3562 18.2576 22.3701 18.2592 22.3842 18.2614 22.5001 18.2798 22.6104 18.3489 22.7054 18.4555 22.7415 18.4961 22.774 18.5398 22.8024 18.5861 22.8212 18.6161 22.8388 18.6478 22.8556 18.6812 22.8623 18.6951 22.8687 18.708 22.8749 18.7217 22.8912 18.757 22.9059 18.793 22.9187 18.8297 22.9492 18.9156 22.9721 19.004 22.9873 19.094 23.0004 19.173 23.0082 19.2526 23.0107 19.3325 23.012 19.3751 23.012 19.4184 23.0107 19.462 23.0023 19.6648 22.9607 19.865 22.8877 20.0545 22.8812 20.0719 22.8738 20.0894 22.8668 20.1069 22.8524 20.1422 22.8367 20.1769 22.8196 20.2108 22.807 20.2365 22.7937 20.2625 22.7793 20.2883 22.7699 20.3055 22.7601 20.3226 22.7502 20.3398 22.7251 20.3826 22.6979 20.4251 22.6687 20.4675L22.651 20.4928C22.582 20.589 22.5051 20.6794 22.421 20.7628 22.3382 20.8458 22.2495 20.9225 22.1556 20.9925 22.0615 21.0622 21.9732 21.1394 21.8917 21.2233 21.6568 21.4697 21.6021 21.6872 21.6549 21.852 21.6634 21.878 21.6745 21.9031 21.6879 21.9269 21.7037 21.954 21.7224 21.979 21.7437 22.0019L21.752 22.0105 21.7604 22.0189C21.7688 22.027 21.7777 22.035 21.7873 22.0428L21.7967 22.0503C21.8193 22.0678 21.8434 22.0834 21.8685 22.0972 21.8759 22.1011 21.8824 22.105 21.8907 22.1087 21.9179 22.122 21.9459 22.1334 21.9746 22.1426 21.9826 22.1453 21.9906 22.1476 21.9987 22.1501L22.0088 22.1528 22.0229 22.1565 22.0349 22.1595 22.0481 22.1623 22.061 22.165 22.0734 22.167C22.0824 22.1686 22.0918 22.1701 22.1012 22.1712L22.1101 22.1726 22.1263 22.1742 22.1363 22.1753 22.1527 22.1764H22.1624L22.1796 22.1773H22.2337L22.2492 22.1764 22.267 22.1753 22.2887 22.1733 22.309 22.1709C22.3137 22.1709 22.3184 22.1697 22.3231 22.1687 22.3856 22.1597 22.4468 22.1431 22.5054 22.1194L22.5302 22.1089C22.5442 22.1028 22.5582 22.0964 22.571 22.0895 22.5985 22.0758 22.6252 22.0601 22.6509 22.0431 22.6867 22.0197 22.7204 21.9934 22.752 21.9645 22.7595 21.9578 22.7668 21.9506 22.774 21.9437 22.7776 21.9403 22.781 21.937 22.7845 21.9333 22.7913 21.9262 22.7984 21.9194 22.8052 21.9117 22.8552 21.8567 22.8985 21.7961 22.9342 21.7309 23.2399 21.1748 23.5604 20.627 23.8952 20.0881L23.9412 20.0145 23.9876 19.9409C24.0107 19.9036 24.0342 19.8669 24.0574 19.8303L24.0809 19.7937C24.1587 19.6719 24.2377 19.5508 24.3182 19.4306L24.3659 19.3594C24.4615 19.2176 24.5568 19.0798 24.6513 18.9489L24.6984 18.884C24.8012 18.7423 24.9082 18.6036 25.0193 18.4683L25.0634 18.4155C25.0707 18.4067 25.0774 18.398 25.0854 18.3895 25.0999 18.3723 25.1145 18.3556 25.1287 18.3394 25.1359 18.3311 25.1426 18.323 25.1502 18.3148L25.1921 18.2676 25.2131 18.2447C25.2342 18.222 25.2548 18.2003 25.2751 18.1795 25.2892 18.1655 25.3021 18.1515 25.3156 18.1384 25.3948 18.0575 25.4821 17.9848 25.5763 17.9219L25.5982 17.9078C25.6192 17.8937 25.6409 17.8806 25.6631 17.8687 26.0324 17.659 26.3382 17.6436 26.5143 17.8197 26.6209 17.9262 26.6799 18.103 26.6767 18.3489 26.6767 18.3597 26.6767 18.3706 26.6759 18.3819V18.3939C26.6759 18.4051 26.6749 18.4164 26.674 18.4278 26.674 18.4419 26.6724 18.4558 26.671 18.4698 26.6696 18.4837 26.6688 18.4944 26.6674 18.5069 26.6674 18.5103 26.6668 18.5139 26.6662 18.5176 26.6652 18.5284 26.6638 18.5395 26.6623 18.5506 26.6623 18.5539 26.6623 18.5573 26.661 18.5608 26.6593 18.5756 26.6571 18.5903 26.6546 18.605 26.6529 18.619 26.6506 18.6322 26.6481 18.6459L26.644 18.6692C26.6399 18.6914 26.6348 18.7133 26.6284 18.7348 26.6162 18.7753 26.6015 18.8148 26.5842 18.8533 26.5599 18.9061 26.5332 18.9575 26.5038 19.0075 26.4876 19.0353 26.4709 19.0626 26.4535 19.0897 26.4357 19.1176 26.417 19.1459 26.3976 19.1745 26.3482 19.2451 26.297 19.3144 26.2437 19.382L26.2193 19.4128C26.1324 19.5211 26.0427 19.6272 25.9502 19.7308L25.921 19.7636C25.8817 19.8075 25.8417 19.8517 25.8007 19.8961L25.7699 19.9295C25.7495 19.9519 25.7281 19.9742 25.7074 19.9967 25.687 20.019 25.6656 20.0417 25.644 20.0644L25.5798 20.132 25.5146 20.2001 25.449 20.2683C25.4049 20.3139 25.3607 20.3595 25.3162 20.4051 24.6826 21.055 24.0151 21.7026 23.7892 22.1064 23.774 22.1326 23.7604 22.1598 23.7482 22.1875 23.716 22.2609 23.7026 22.3237 23.7118 22.3745 23.7148 22.3912 23.7206 22.4072 23.7292 22.4219 23.7418 22.4439 23.7573 22.4642 23.7752 22.4823 23.7835 22.4905 23.7923 22.498 23.8015 22.5048 23.8481 22.538 23.9042 22.555 23.9613 22.5534H23.9792L23.9974 22.552 24.0157 22.55 24.0309 22.5478C24.0329 22.5475 24.0351 22.5472 24.0371 22.5465L24.051 22.5439 24.0546 22.5431 24.0701 22.5398 24.0756 22.5384C24.081 22.537 24.0863 22.5356 24.0918 22.534 24.0973 22.5325 24.1048 22.5305 24.1113 22.5283 24.1388 22.52 24.1657 22.5101 24.1921 22.4989 24.206 22.4933 24.2196 22.4872 24.2331 22.4806 24.2401 22.4775 24.2471 22.4742 24.2537 22.4708L24.2746 22.4605C24.3246 22.4345 24.3734 22.4062 24.4209 22.3759L24.4417 22.3619C24.4487 22.3575 24.4557 22.353 24.4624 22.348L24.4832 22.334 24.4943 22.3264 24.5243 22.3053C24.5523 22.2861 24.5784 22.2662 24.6048 22.2461L24.6071 22.2442 24.6492 22.2117C24.7065 22.1664 24.7609 22.1208 24.8102 22.0778L24.8431 22.049 24.846 22.0462 24.8632 22.0311C24.9035 21.9948 24.9395 21.9611 24.9693 21.9333L24.9817 21.9212C24.9924 21.9111 25.0023 21.9015 25.0112 21.8934L25.0287 21.8761 25.0349 21.87 25.0367 21.8683 25.0549 21.85 25.0665 21.838 25.0679 21.8369 25.0734 21.8319 25.0802 21.8256 25.0824 21.8236 25.0882 21.8183 25.1201 21.7903 25.1379 21.7744C25.1474 21.7661 25.1567 21.7576 25.1659 21.749L25.1871 21.7301C25.191 21.727 25.1948 21.7236 25.1987 21.7201L25.221 21.7006 25.2538 21.6717 25.2713 21.6565C25.3393 21.5975 25.422 21.5261 25.517 21.4456L25.5559 21.4126 25.6201 21.3587 25.6859 21.3039C25.7718 21.2325 25.8643 21.1567 25.9621 21.0781L26.0263 21.0265C26.081 20.983 26.1371 20.9386 26.194 20.8939 26.217 20.8759 26.2402 20.858 26.264 20.8401 26.3221 20.795 26.3806 20.7501 26.4395 20.7059 26.5735 20.6047 26.7118 20.5033 26.8518 20.4045L26.9118 20.3626C26.9538 20.3337 26.9957 20.3047 27.0376 20.2764L27.0756 20.2508C27.1504 20.2 27.2263 20.1505 27.3029 20.1022L27.3409 20.0783 27.3785 20.0548C27.4163 20.0314 27.4538 20.0084 27.4912 19.9861L27.5285 19.9637 27.6032 19.9203 27.6765 19.8783 27.6913 19.8701 27.7493 19.8383C27.7735 19.8251 27.7976 19.8125 27.8217 19.8001L27.8574 19.7817 27.8923 19.7642C27.9045 19.7584 27.9165 19.7523 27.9284 19.7465 28.0068 19.7078 28.0868 19.6722 28.1681 19.6397 28.1901 19.6303 28.212 19.6219 28.2337 19.6145L28.2977 19.592C28.317 19.5856 28.3357 19.5795 28.3537 19.574L28.3599 19.5722C28.3696 19.569 28.3793 19.5662 28.3888 19.5637L28.3917 19.563C28.4117 19.5572 28.4315 19.5522 28.451 19.5475H28.4524C28.5077 19.5342 28.564 19.5247 28.6207 19.5189 28.6468 19.5162 28.6729 19.5148 28.6992 19.515H28.7123C28.7298 19.515 28.7467 19.5161 28.7634 19.5178 28.771 19.5178 28.7787 19.5194 28.7862 19.5203H28.7893C28.7968 19.5212 28.8043 19.5223 28.8118 19.524 28.8192 19.5255 28.8267 19.5267 28.8338 19.5284H28.8362C28.8435 19.53 28.8501 19.5319 28.8577 19.534 28.8974 19.5451 28.9352 19.5623 28.9699 19.5848 28.987 19.5959 29.0029 19.6084 29.0176 19.6223L29.0218 19.6264C29.0246 19.6289 29.0273 19.6315 29.0298 19.6342L29.0374 19.6425C29.1002 19.7083 29.1521 19.7837 29.1912 19.8659L29.1971 19.88C29.2104 19.9112 29.2209 19.9436 29.2284 19.9765 29.2506 20.0775 29.242 20.1828 29.2037 20.2789 29.1892 20.3176 29.1715 20.355 29.1507 20.3906 29.1021 20.4725 29.0445 20.5486 28.979 20.6175L28.9651 20.6323C28.9443 20.6542 28.9227 20.6761 28.9001 20.698 28.8901 20.7078 28.8796 20.7175 28.8692 20.7273L28.8371 20.7569 28.8204 20.7717C28.7801 20.8076 28.7387 20.8425 28.6967 20.8762 28.6712 20.8969 28.6456 20.917 28.6196 20.9369 28.5281 21.0069 28.4348 21.0744 28.3398 21.1395 28.2824 21.1789 28.2246 21.2175 28.1663 21.2556 28.0227 21.3498 27.8776 21.4417 27.731 21.5311 27.4235 21.7201 27.0827 21.9223 26.7195 22.1422L26.6254 22.1992C26.5224 22.262 26.4252 22.322 26.3337 22.3792L26.2876 22.4081 26.2004 22.464C26.1426 22.5011 26.0849 22.5384 26.0273 22.5758L25.9809 22.6064C25.9582 22.6211 25.9357 22.6361 25.9132 22.6511L25.8912 22.6651 25.8237 22.7106 25.7879 22.7351 25.746 22.7642 25.7071 22.7912C25.642 22.8373 25.5813 22.8812 25.5256 22.923L25.5046 22.9389C25.4718 22.9637 25.4393 22.989 25.4073 23.0148 25.359 23.0537 25.3149 23.0909 25.2754 23.1267L25.256 23.1444C25.2449 23.1545 25.234 23.1647 25.2235 23.1747 25.2163 23.1817 25.2096 23.1887 25.2021 23.1955L25.1921 23.2055C25.1698 23.228 25.1479 23.2509 25.1268 23.2745L25.1165 23.2864C25.0935 23.313 25.0735 23.3384 25.056 23.3633L25.0482 23.3744C25.0345 23.3944 25.0218 23.415 25.0104 23.4362 25.0074 23.4415 25.0048 23.4469 25.0021 23.4522L24.9945 23.4681 24.9893 23.4797 24.986 23.4875 24.9834 23.4945 24.9798 23.504C24.9701 23.5305 24.9634 23.558 24.9595 23.5858L24.9582 23.5955 24.9573 23.6045V23.6537C24.9573 23.6578 24.9573 23.6619 24.9584 23.6662L24.9592 23.6737C24.9592 23.6778 24.9601 23.6817 24.9607 23.6861 24.9613 23.6901 24.9624 23.6975 24.9637 23.7033V23.704C24.9648 23.7095 24.9659 23.7148 24.9673 23.7203 24.9687 23.7258 24.9701 23.732 24.9718 23.7376 24.9748 23.7487 24.9785 23.7597 24.9824 23.7706 24.9849 23.7772 24.9873 23.7836 24.9899 23.79 24.9899 23.7912 24.9909 23.7926 24.9915 23.7939L24.9971 23.8065 25.0049 23.8239C25.0134 23.8419 25.0226 23.8594 25.0326 23.8764L25.0429 23.8942 25.0535 23.912C25.0554 23.915 25.0576 23.9178 25.0599 23.9205L25.0634 23.924 25.0673 23.9276 25.0713 23.9308C25.0773 23.935 25.0837 23.9383 25.0904 23.9406 25.094 23.9419 25.0977 23.9428 25.1015 23.9437 25.1917 23.964 25.377 23.8895 25.6232 23.7595 25.6371 23.752 25.6524 23.7442 25.6673 23.7361L25.7423 23.6951 25.7788 23.6748C25.8049 23.6609 25.8315 23.6451 25.8587 23.6297L25.9082 23.6017C26.2337 23.4144 26.6224 23.1737 27.0243 22.9387 27.062 22.9167 27.0998 22.8947 27.1376 22.873L27.2135 22.8244C27.3017 22.7739 27.3902 22.724 27.4792 22.6748 27.5912 22.6133 27.704 22.5533 27.8179 22.4951L27.8923 22.4575C27.9417 22.4331 27.9906 22.4094 28.0388 22.3862 28.1323 22.3419 28.2268 22.2997 28.3224 22.2598L28.3748 22.2386 28.381 22.2361C28.6584 22.1262 28.9098 22.0584 29.1132 22.0584 29.1571 22.058 29.2012 22.0617 29.2445 22.0692H29.2459C29.2598 22.0717 29.2724 22.0745 29.2854 22.0776H29.2877C29.321 22.0861 29.3534 22.0981 29.384 22.1136 29.427 22.1358 29.4656 22.1653 29.4982 22.2009 29.5132 22.2175 29.5265 22.2355 29.5382 22.2545 29.5601 22.2881 29.5773 22.3245 29.5896 22.3626 29.5946 22.3775 29.599 22.392 29.6035 22.4075 29.6365 22.5258 29.6332 22.6512 29.5942 22.7676z" fill="currentcolor" stroke="currentcolor" stroke-width=".6"/><path fill-rule="evenodd" clip-rule="evenodd" d="M19.7567 10.9815C19.9413 11.0469 20.0787 11.2456 20.2093 11.4348 20.3859 11.6905 20.5503 11.9284 20.8024 11.7944 21.0999 11.6361 21.3438 11.3933 21.5032 11.0964 21.6628 10.7995 21.7307 10.4621 21.6985 10.1267 21.6745 9.87589 21.5951 9.63355 21.466 9.41714 21.337 9.20072 21.1615 9.01561 20.9524 8.87517 20.7432 8.73473 20.5054 8.64245 20.2563 8.60497 20.0071 8.56749 19.7527 8.58575 19.5115 8.65842 19.2702 8.73106 19.0482 8.85628 18.8612 9.02506S18.5268 9.40198 18.4299 9.63452C18.3331 9.86705 18.2888 10.1182 18.3006 10.3698 18.3124 10.6215 18.3798 10.8673 18.4981 11.0898 18.6149 11.3097 18.8743 11.2059 19.1481 11.0964 19.3626 11.0106 19.5862 10.9212 19.7567 10.9815zm-8.0274.0C11.5446 11.0469 11.4073 11.2458 11.2767 11.4348 11.1001 11.6906 10.9356 11.9284 10.6835 11.7944 10.3094 11.5962 10.0225 11.2658 9.87866 10.8676 9.73486 10.4694 9.7445 10.032 9.90569 9.64047 10.0669 9.24898 10.3681 8.93156 10.7506 8.75006S11.5694 8.53602 11.9746 8.65873C12.2973 8.75589 12.5838 8.9465 12.7982 9.20647 13.0126 9.46645 13.1449 9.78413 13.1788 10.1194 13.2126 10.4546 13.1462 10.7923 12.9881 11.0898 12.871 11.3097 12.6117 11.2059 12.3379 11.0965 12.1232 11.0106 11.8999 10.9212 11.7293 10.9815zm6.7855 7.3049c1.2723-1.0024 1.7397-2.6389 1.7397-3.647C20.2545 13.8425 19.7184 14.0933 18.8601 14.5183L18.8117 14.5422C18.0238 14.9323 16.9751 15.4519 15.8238 15.4519 14.6724 15.4519 13.6237 14.9323 12.836 14.542 11.9499 14.1031 11.3942 13.8278 11.3942 14.6395c0 1.04.4971 2.7477 1.8618 3.7397C13.4362 18.0137 13.6898 17.6894 14.001 17.4262 14.3121 17.1631 14.6743 16.967 15.0646 16.8501 15.2009 16.8095 15.3412 17.044 15.4848 17.2842 15.6234 17.5158 15.7651 17.7526 15.9092 17.7526 16.0627 17.7526 16.2135 17.5192 16.3609 17.2914 16.5148 17.0531 16.6649 16.8211 16.8101 16.8675 17.5406 17.102 18.1517 17.6106 18.5148 18.2864z" fill="currentcolor" stroke="currentcolor" stroke-width=".6"/></svg></a><a style=border-bottom:none href=https://www.kaggle.com/sunnyson rel=me title=Kaggle><svg xmlns="http://www.w3.org/2000/svg" fill="currentcolor" stroke="none" viewBox="0 0 32 32"><path transform="matrix(.527027 0 0 .527027 -30.632288 -22.45559)" clip-path="url(#A)" d="M105.75 102.968c-.06.238-.298.357-.713.357H97.1c-.477.0-.89-.208-1.248-.625L82.746 86.028l-3.655 3.477v12.93c0 .595-.298.892-.892.892h-6.152c-.595.0-.892-.297-.892-.892V43.5c0-.593.297-.89.892-.89H78.2c.594.0.892.298.892.89v36.288l15.692-15.87c.416-.415.832-.624 1.248-.624h8.204c.356.0.593.15.713.445.12.357.09.624-.09.803L88.274 80.588l17.297 21.488c.237.238.297.535.18.892"/></svg></a><a style=border-bottom:none href=https://wandb.ai/sunnyson rel=me title=Wandb><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.48057 3.1008c-.85625.0-1.550387-.69413-1.550387-1.55039S1.62432.0 2.48057.0c.85628.0 1.55041.69415 1.55041 1.55041S3.33685 3.1008 2.48057 3.1008zM2.48059 10.2326C1.1106 10.2326.0 9.122.0 7.752.0 6.38201 1.1106 5.27139 2.48059 5.27139S4.96118 6.38201 4.96118 7.752c0 1.37-1.1106 2.4806-2.48059 2.4806zm0 12.403C1.1106 22.6356.0 21.525.0 20.155c0-1.3699 1.1106-2.4807 2.48059-2.4807s2.48059 1.1108 2.48059 2.4807c0 1.37-1.1106 2.4806-2.48059 2.4806zM.930183 13.9537C.930183 14.8099 1.62432 15.504 2.48057 15.504 3.33685 15.504 4.03098 14.8099 4.03098 13.9537 4.03098 13.0974 3.33685 12.4032 2.48057 12.4032c-.85625.0-1.550387.6942-1.550387 1.5505zM9.51933 16.248c0 1.3699 1.11057 2.4805 2.48057 2.4805 1.37.0 2.4806-1.1106 2.4806-2.4805.0-1.37-1.1106-2.4806-2.4806-2.4806-1.37.0-2.48057 1.1106-2.48057 2.4806zM11.9999 24C11.1437 24 10.4495 23.3059 10.4495 22.4497c0-.856300000000001.6942-1.5506 1.5504-1.5506C12.8562 20.8991 13.5503 21.5934 13.5503 22.4497 13.5503 23.3059 12.8562 24 11.9999 24zM10.4495 10.0466c0 .856199999999999.6942 1.5504 1.5504 1.5504.856299999999999.0 1.5504-.6942 1.5504-1.5504C13.5503 9.19032 12.8562 8.49619 11.9999 8.49619 11.1437 8.49619 10.4495 9.19032 10.4495 10.0466zm1.5504-4.65122C11.1437 5.39538 10.4495 4.70124 10.4495 3.84499c0-.85626.6942-1.55039 1.5504-1.55039.856299999999999.0 1.5504.69413 1.5504 1.55039C13.5503 4.70124 12.8562 5.39538 11.9999 5.39538zM19.0387 7.752c0 1.37 1.1106 2.4806 2.4807 2.4806C22.8894 10.2326 24 9.122 24 7.752c0-1.36999-1.1106-2.48061-2.4806-2.48061-1.3701.0-2.4807 1.11062-2.4807 2.48061zm2.4807-4.6512C20.6632 3.1008 19.9689 2.40667 19.9689 1.55041S20.6632.0 21.5194.0C22.3757.0 23.0698.69415 23.0698 1.55041S22.3757 3.1008 21.5194 3.1008zM19.9689 13.9537C19.9689 14.8099 20.6632 15.504 21.5194 15.504 22.3757 15.504 23.0698 14.8099 23.0698 13.9537 23.0698 13.0974 22.3757 12.4032 21.5194 12.4032c-.856200000000001.0-1.5505.6942-1.5505 1.5505zm1.5505 7.7517C20.6632 21.7054 19.9689 21.0113 19.9689 20.155 19.9689 19.2988 20.6632 18.6045 21.5194 18.6045 22.3757 18.6045 23.0698 19.2988 23.0698 20.155 23.0698 21.0113 22.3757 21.7054 21.5194 21.7054z" fill="currentcolor"/></svg></a><a style=border-bottom:none href=feed.xml rel=me title=Rss><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div><span>&copy; 2024 <a href=https://sunnyson.dev/>Sunny Son</a></span>
<span>•
<a href=/privacy>Privacy Policy</a></span>
<span>•
Powered by
<a href=https://gohugo.io/>Hugo</a>,
<a href=https://github.com/adityatelange/hugo-PaperMod/>PaperMod</a>, &
        <a href=https://en.wikipedia.org/wiki/Love>💓</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let b=document.querySelector("#menu-trigger"),m=document.querySelector(".menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(e){b.contains(e.target)||m.classList.add("hidden")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>